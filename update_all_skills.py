#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import re
import os
import time

def update_all_skill_descriptions():
    """모든 "기본 스킬" 설명을 실제 효과 설명으로 업데이트"""
    file_path = "game/new_skill_system.py"
    
    # 백업 생성
    backup_path = f"{file_path}.backup_final_{int(time.time())}"
    os.system(f'copy "{file_path}" "{backup_path}"')
    print(f"백업 파일 생성: {backup_path}")
    
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()
    
    # 모든 스킬별 상세 설명 정의
    skill_descriptions = {
        # 검투사
        "투기장의기술": "[BRV] 투기장에서 단련한 격투 기술로 적을 공격하여 BRV를 획득합니다.",
        "군중의함성": "[BUFF] 관중들의 환호성에 힘입어 아군 전체의 사기를 올립니다.",
        "네트던지기": "[DEBUFF] 그물을 던져 적의 움직임을 제한하고 속도를 감소시킵니다.",
        "트라이던트찌르기": "[HP] 삼지창으로 적을 찔러 직접적인 HP 피해를 가합니다.",
        "결투자의명예": "[SPECIAL] 결투자의 명예를 걸고 특별한 효과를 발동시킵니다.",
        "콜로세움의왕": "[궁극] 콜로세움의 왕이 되어 압도적인 힘을 발휘하는 궁극기입니다.",
        
        # 광전사
        "광기의씨앗": "[SPECIAL] 내면의 광기를 일깨워 특별한 전투 상태로 진입합니다.",
        "무모한돌격": "[HP] 무모하게 돌진하여 적에게 강력한 HP 피해를 가합니다.",
        "피의갈증": "[SPECIAL] 피에 대한 갈증으로 특수한 전투 효과를 얻습니다.",
        "광란의연타": "[SPECIAL] 광란 상태에서 연속으로 공격하는 특수 기술입니다.",
        "분노폭발": "[BRV][HP] 분노를 폭발시켜 BRV 획득과 HP 피해를 동시에 가합니다.",
        "버서커의최후": "[궁극] 광전사의 최후 발악으로 모든 것을 걸고 공격하는 궁극기입니다.",
        
        # 기사
        "방패방어": "[BUFF] 방패로 방어 자세를 취하여 방어력을 크게 증가시킵니다.",
        "창돌격": "[BRV] 창을 들고 돌격하여 적을 공격하고 BRV를 획득합니다.",
        "아군보호": "[BUFF] 아군을 보호하는 기사의 의무로 아군 전체의 방어력을 향상시킵니다.",
        "기사도정신": "[BUFF] 기사도 정신으로 자신의 모든 능력치를 향상시킵니다.",
        "수호기사의맹세": "[궁극] 수호기사의 맹세로 아군을 완벽하게 보호하는 궁극기입니다.",
        
        # 성기사
        "신앙의힘": "[BUFF] 신에 대한 믿음으로 성스러운 힘을 얻어 능력치를 향상시킵니다.",
        "성스러운타격": "[BRV] 성스러운 힘을 담은 공격으로 적을 타격하여 BRV를 획득합니다.",
        "축복": "[BUFF] 신의 축복으로 아군의 능력치를 향상시키고 보호막을 씌웁니다.",
        "치유의빛": "[HEAL] 성스러운 빛으로 아군의 상처를 치유하고 HP를 회복시킵니다.",
        "부활": "[SPECIAL] 신의 기적으로 쓰러진 아군을 되살려냅니다.",
        "천사의강림": "[궁극] 천사를 강림시켜 압도적인 성스러운 힘을 발휘하는 궁극기입니다.",
        
        # 암흑기사
        "어둠의계약": "[SPECIAL] 어둠의 힘과 계약하여 특별한 능력을 얻습니다.",
        "저주의검": "[DEBUFF] 저주받은 검으로 적을 공격하여 저주 상태를 부여합니다.",
        "어둠의보호": "[BUFF] 어둠의 힘으로 자신을 보호하여 방어력을 증가시킵니다.",
        "어둠의지배자": "[궁극] 어둠의 지배자가 되어 모든 적을 압도하는 궁극기입니다.",
        
        # 용기사
        "용의비늘": "[BUFF] 용의 비늘처럼 단단한 보호막으로 자신을 감쌉니다.",
        "드래곤클로": "[BRV] 용의 발톱으로 적을 할퀴어 BRV를 획득합니다.",
        "화염숨결": "[BRV] 용의 화염 숨결로 적을 공격하여 BRV를 획득합니다.",
        "용의위엄": "[DEBUFF] 용의 위엄으로 적을 위압하여 공격력과 방어력을 감소시킵니다.",
        "드래곤로드": "[궁극] 용의 군주가 되어 압도적인 용의 힘을 발휘하는 궁극기입니다.",
        
        # 아크메이지
        "원소융합": "[BRV] 여러 원소를 융합하여 강력한 마법 공격으로 BRV를 획득합니다.",
        "마나실드": "[BUFF] 마나로 방어막을 형성하여 마법 피해를 흡수합니다.",
        "시공술": "[DEBUFF] 시공간을 조작하여 적의 행동을 제한하고 혼란시킵니다.",
        "아르카나": "[궁극] 최고 수준의 비밀 마법으로 엄청난 위력을 발휘하는 궁극기입니다.",
        
        # 정령술사
        "정령교감": "[BUFF] 정령과 교감하여 원소 마법의 위력을 크게 증가시킵니다.",
        "화염정령": "[BRV] 화염 정령을 소환하여 적을 공격하고 BRV를 획득합니다.",
        "물정령치유": "[HEAL] 물 정령의 힘으로 아군의 상처를 치유하고 HP를 회복시킵니다.",
        "바람정령축복": "[BUFF] 바람 정령의 축복으로 아군의 속도와 회피율을 증가시킵니다.",
        "사대정령소환": "[궁극] 4대 정령을 모두 소환하여 압도적인 원소 공격을 펼치는 궁극기입니다.",
        
        # 시간술사
        "시간가속": "[BUFF] 시간을 가속시켜 자신의 행동 속도를 크게 증가시킵니다.",
        "시간왜곡": "[SPECIAL] 시간을 왜곡시켜 특별한 효과를 발동시킵니다.",
        "시간되돌리기": "[SPECIAL] 시간을 되돌려 이전 상태로 복원하는 기적을 일으킵니다.",
        "미래예지": "[BUFF] 미래를 예지하여 회피율과 명중률을 크게 증가시킵니다.",
        "시간정지": "[FIELD] 시간을 정지시켜 모든 적의 행동을 일시 중단시킵니다.",
        "시공간붕괴": "[궁극] 시공간을 붕괴시켜 모든 것을 파괴하는 궁극의 시간 마법입니다.",
        
        # 차원술사
        "차원장막": "[BUFF] 차원의 장막으로 자신을 감싸 물리 공격을 회피합니다.",
        "잔상분신": "[BUFF] 잔상 분신을 만들어 회피율을 크게 증가시킵니다.",
        "공간도약": "[BRV] 공간을 도약하여 적의 뒤로 순간이동해 기습 공격을 가합니다.",
        "차원미로": "[DEBUFF] 차원 미로에 적을 가둬 혼란과 이동 불가 상태를 부여합니다.",
        "회피반격": "[COUNTER] 공격을 회피하면서 동시에 반격하는 특수 기술입니다.",
        "무적의경지": "[궁극] 모든 차원을 초월하여 무적 상태가 되는 궁극의 차원 술법입니다.",
        
        # 철학자
        "진리탐구": "[BUFF] 진리를 탐구하여 지혜와 마법력을 크게 증가시킵니다.",
        "진실간파": "[SPECIAL] 진실을 간파하여 적의 약점과 상태를 파악합니다.",
        "지혜의빛": "[BUFF] 지혜의 빛으로 아군 전체의 지능과 마법력을 향상시킵니다.",
        "철학적사고": "[SPECIAL] 철학적 사고로 특별한 통찰력을 얻어 유리한 효과를 발동시킵니다.",
        "절대진리": "[궁극] 절대 진리를 깨달아 모든 것을 꿰뚫는 궁극의 지혜를 발휘합니다.",
        
        # 궁수
        "바람보조": "[BUFF] 바람의 도움을 받아 명중률과 크리티컬 확률을 증가시킵니다.",
        "헌터모드": "[궁극] 완벽한 사냥꾼 모드로 진입하여 모든 사격 능력을 극대화하는 궁극기입니다.",
        
        # 도적
        "그림자숨기": "[BUFF] 그림자에 숨어 은신 상태가 되어 적의 공격을 회피합니다.",
        "독바르기": "[SPECIAL] 무기에 독을 발라 다음 공격에 독 효과를 추가합니다.",
        "연막탄": "[FIELD] 연막탄을 터뜨려 전장을 연기로 가려 시야를 차단합니다.",
        "그림자분신": "[궁극] 그림자 분신술로 여러 개의 분신을 만들어 동시 공격하는 궁극기입니다.",
        
        # 암살자
        "독무": "[FIELD] 독성 안개를 퍼뜨려 전장에 있는 모든 적을 중독시킵니다.",
        "독날투척": "[BRV] 독이 발린 수리검을 던져 적을 공격하고 중독시킵니다.",
        "독왕의비의": "[궁극] 독의 왕이 되어 치명적인 독으로 모든 적을 죽음으로 이끄는 궁극기입니다.",
        
        # 해적
        "이도류": "[BUFF] 양손에 검을 들고 이도류 전투 자세로 공격력을 증가시킵니다.",
        "바다의저주": "[DEBUFF] 바다의 저주로 적을 속박하여 행동력을 크게 감소시킵니다.",
        "해적의함성": "[BUFF] 해적다운 함성으로 아군의 공격력과 사기를 올립니다.",
        "해상치료술": "[FIELD] 바다에서 배운 치료술로 아군 전체의 상처를 치유합니다.",
        
        # 사무라이
        "명상": "[HEAL] 명상을 통해 마음을 가다듬고 HP와 MP를 회복합니다.",
        "진검승부": "[COUNTER] 진검승부 자세로 적의 공격을 받아 더 강한 반격을 가합니다.",
        "사무라이치유법": "[FIELD] 사무라이의 전통 치유법으로 아군들의 상처를 치료합니다.",
        
        # 무당
        "정령소환": "[BUFF] 수호 정령을 소환하여 자신의 능력치를 크게 향상시킵니다.",
        "저주의인형": "[DEBUFF] 저주받은 인형으로 적에게 다양한 저주 상태를 부여합니다.",
        "치유의춤": "[HEAL] 신성한 치유의 춤으로 아군 전체의 HP를 회복시킵니다.",
        "영혼파악": "[SPECIAL] 적의 영혼을 파악하여 약점과 상태를 정확히 분석합니다.",
        "정령치유술": "[FIELD] 정령의 힘을 빌려 강력한 치유 효과를 전장에 펼칩니다.",
        "대자연의심판": "[궁극] 대자연의 정령들이 내리는 심판으로 적을 처벌하는 궁극기입니다.",
        
        # 드루이드
        "자연교감": "[BUFF] 자연과 교감하여 모든 자연 마법의 위력을 증가시킵니다.",
        "가시덩굴": "[DEBUFF] 가시덩굴을 소환하여 적의 이동을 제한하고 지속 피해를 가합니다.",
        "자연치유": "[HEAL] 자연의 치유력으로 아군의 상처를 치유하고 상태이상을 해제합니다.",
        "동물변신": "[BUFF] 야생동물로 변신하여 특별한 능력과 스탯 보정을 얻습니다.",
        "가이아의분노": "[궁극] 대지의 여신 가이아의 분노로 자연 재해를 일으키는 궁극기입니다.",
        
        # 신관
        "신의가호": "[BUFF] 신의 가호로 아군 전체를 보호하고 모든 능력치를 향상시킵니다.",
        "성스러운빛": "[BRV] 성스러운 빛으로 적을 정화하면서 BRV를 획득합니다.",
        "대치유술": "[HEAL] 강력한 신성 마법으로 아군 전체를 크게 치유합니다.",
        "부활술": "[SPECIAL] 신의 기적으로 쓰러진 동료를 완전한 상태로 되살립니다.",
        "천국의문": "[궁극] 천국의 문을 열어 신의 직접적인 개입을 받는 궁극의 신성 마법입니다.",
        
        # 수도승
        "평화의기도": "[BUFF] 평화로운 기도로 아군 전체의 마음을 안정시키고 정신력을 향상시킵니다.",
        "정화의빛": "[SPECIAL] 정화의 빛으로 모든 저주와 상태이상을 해제합니다.",
        "신성한치유": "[HEAL] 신성한 힘으로 아군을 치유하고 축복 상태를 부여합니다.",
        "침묵의서약": "[DEBUFF] 침묵의 서약으로 적의 마법 사용을 봉인합니다.",
        "순교자의길": "[SPECIAL] 순교자의 길을 걸어 자신을 희생하여 아군에게 강력한 버프를 부여합니다.",
        "신의심판": "[궁극] 신의 직접적인 심판으로 악한 적들을 처벌하는 궁극의 신성 마법입니다.",
        
        # 몽크
        "명상": "[HEAL] 깊은 명상으로 내면의 평화를 찾아 HP와 MP를 회복합니다.",
        
        # 연금술사
        "물질변환": "[SPECIAL] 연금술로 물질을 변환하여 유용한 효과를 창조합니다.",
        "회복포션": "[HEAL] 직접 제조한 회복 포션으로 아군의 HP를 빠르게 회복시킵니다.",
        
        # 기계공학자
        "메카돔": "[BUFF] 기계 돔을 전개하여 아군 전체를 보호하고 방어력을 증가시킵니다.",
        "수리드론": "[HEAL] 수리 드론을 전개하여 아군들의 상처를 자동으로 치료합니다.",
        
        # 네크로맨서
        "공포주입": "[DEBUFF] 죽음의 공포를 주입하여 적을 공포 상태로 만들고 능력치를 감소시킵니다.",
        "뼈감옥": "[DEBUFF] 뼈로 만든 감옥에 적을 가둬 행동 불가 상태로 만듭니다."
    }
    
    changes_made = 0
    
    # 패턴을 이용해 각 스킬 설명 교체
    for skill_name, new_description in skill_descriptions.items():
        # 정확한 패턴 매칭을 위해 이스케이프
        escaped_skill = re.escape(skill_name)
        
        # 패턴: "description": "[타입] 스킬명 - 기본 스킬",
        pattern = rf'"description": "\[[^\]]+\] {escaped_skill} - 기본 스킬",'
        replacement = f'"description": "{new_description}",'
        
        if re.search(pattern, content):
            content = re.sub(pattern, replacement, content)
            changes_made += 1
            print(f"   업데이트 {changes_made}: {skill_name}")
    
    # 파일 저장
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)
    
    # 남은 "기본 스킬" 개수 확인
    remaining = content.count('기본 스킬')
    print(f"\n🎉 총 {changes_made}개 스킬 설명 업데이트 완료!")
    print(f"📊 남은 '기본 스킬': {remaining}개")
    
    return True

if __name__ == "__main__":
    print("=== 전체 스킬 설명 업데이트 ===")
    update_all_skill_descriptions()
