#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import re
import os
import time

def improve_skill_descriptions():
    """스킬 설명을 개선하여 실제 효과를 명확하게 표시"""
    file_path = "game/new_skill_system.py"
    
    # 백업 생성
    backup_path = f"{file_path}.backup_descriptions_{int(time.time())}"
    os.system(f'copy "{file_path}" "{backup_path}"')
    print(f"백업 파일 생성: {backup_path}")
    
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()
    
    # 일반적인 스킬 설명 패턴들을 찾아서 개선
    improvements = {
        # BRV 공격 스킬들
        r'"description": "\[BRV\] ([^"]*) - 기본 스킬"': {
            "방패강타": "[BRV] 방패로 적을 강타하여 BRV를 획득하고 적을 기절시킬 확률이 있습니다.",
            "연속베기": "[BRV] 연속으로 2번 공격하여 BRV를 획득합니다. 전투 본능을 향상시킵니다.",
            "일섬": "[BRV] 순간적인 발도술로 적을 베어 BRV를 획득합니다. 높은 명중률과 크리티컬 확률을 가집니다.",
            "검압베기": "[BRV] 검압을 방출하여 강력한 BRV 공격을 가합니다. 높은 위력을 자랑합니다.",
            "거합베기": "[BRV] 검을 뽑는 순간의 집중력으로 강력한 BRV 공격을 가합니다.",
            "연속주먹": "[BRV] 연속으로 주먹질을 가해 BRV를 획득합니다. 기수련의 성과입니다.",
            "마법검격": "[BRV] 마법이 깃든 검으로 적을 공격하여 BRV를 획득합니다.",
            "독성폭탄": "[BRV] 독성 폭탄을 투척하여 BRV를 획득하고 적을 중독시킵니다.",
            "레이저사격": "[BRV] 정밀한 레이저로 적을 공격하여 BRV를 획득합니다.",
            "생명력흡수": "[BRV] 적의 생명력을 흡수하여 자신의 BRV로 전환합니다.",
            "연사": "[BRV] 연속으로 화살을 발사하여 BRV를 획득합니다.",
            "독화살": "[BRV] 독이 발린 화살로 적을 공격하여 BRV를 획득하고 중독시킵니다.",
            "기습": "[BRV] 그림자에서 나타나 기습 공격으로 BRV를 획득합니다.",
            "독침": "[BRV] 독침을 던져 적을 공격하고 독 상태를 부여합니다.",
            "칼부림": "[BRV] 이도류로 연속 공격하여 BRV를 획득합니다."
        },
        
        # HP 공격 스킬들
        r'"description": "\[HP\] ([^"]*) - 기본 스킬"': {
            "파괴의일격": "[HP] 강력한 일격으로 적의 HP에 직접 피해를 가합니다. 방어력을 관통합니다.",
            "무쌍베기": "[HP] 무쌍의 검술로 적에게 직접적인 HP 피해를 가합니다. 크리티컬 확률이 높습니다.",
            "관통사격": "[HP] 관통력이 뛰어난 화살로 적의 HP에 직접 피해를 가합니다.",
            "폭발화살": "[HP] 폭발하는 화살로 적에게 강력한 HP 피해를 가합니다.",
            "암살술": "[HP] 은밀한 암살 기술로 적의 HP에 치명적인 피해를 가합니다.",
            "암살": "[HP] 급소를 노린 암살 공격으로 적의 HP에 직접 피해를 가합니다.",
            "성스러운돌격": "[HP] 성스러운 힘을 담은 돌격으로 적의 HP에 피해를 가합니다.",
            "흡혈": "[HP] 적을 공격하여 HP 피해를 가하고 자신의 체력을 회복합니다.",
            "드래곤스피어": "[HP] 용의 힘을 담은 창 공격으로 적의 HP에 강력한 피해를 가합니다.",
            "마법폭발": "[HP] 마법을 폭발시켜 적의 HP에 직접 피해를 가합니다.",
            "대지정령분노": "[HP] 대지정령의 분노로 적의 HP에 강력한 피해를 가합니다.",
            "존재부정": "[HP] 철학적 논리로 적의 존재를 부정하여 HP 피해를 가합니다.",
            "번개폭풍": "[HP] 번개 폭풍을 일으켜 적의 HP에 강력한 피해를 가합니다.",
            "신벌": "[HP] 신의 벌로 적의 HP에 성스러운 피해를 가합니다.",
            "기폭발": "[HP] 내재된 기를 폭발시켜 적의 HP에 피해를 가합니다.",
            "철의주먹": "[HP] 철처럼 단단한 주먹으로 적의 HP에 강력한 피해를 가합니다.",
            "마력폭발": "[HP] 마력을 폭발시켜 적의 HP에 강력한 마법 피해를 가합니다.",
            "산성용해": "[HP] 강력한 산으로 적을 용해시켜 HP 피해를 가합니다.",
            "멀티미사일": "[HP] 다수의 미사일로 적의 HP에 폭발적인 피해를 가합니다.",
            "죽음의손길": "[HP] 죽음의 기운으로 적의 HP에 치명적인 피해를 가합니다."
        },
        
        # BUFF 스킬들
        r'"description": "\[BUFF\] ([^"]*) - 기본 스킬"': {
            "철벽방어": "[BUFF] 자신의 방어력을 크게 증가시켜 적의 공격을 더 잘 막아냅니다.",
            "전투함성": "[BUFF] 아군 전체의 공격력을 증가시키는 격려의 함성을 지릅니다.",
            "검기응축": "[BUFF] 검에 기를 모아 공격력을 크게 증가시킵니다. 검술 대가의 힘을 발휘합니다.",
            "검심일체": "[BUFF] 검과 마음을 하나로 만들어 집중력을 극대화시킵니다. 검술의 경지에 도달합니다.",
            "무사도": "[BUFF] 무사도 정신으로 자신의 전투 능력을 크게 향상시킵니다.",
            "기수련": "[BUFF] 기수련을 통해 자신의 내재된 힘을 끌어올립니다.",
            "마검각성": "[BUFF] 마검의 힘을 각성시켜 마법과 검술 능력을 모두 향상시킵니다.",
            "원소부여": "[BUFF] 무기에 원소의 힘을 부여하여 공격력을 증가시킵니다.",
            "강화주사": "[BUFF] 특수 강화 주사로 일시적으로 모든 능력을 향상시킵니다.",
            "자동포탑설치": "[FIELD] 자동 공격 포탑을 설치하여 지속적으로 적을 공격합니다.",
            "언데드소환": "[SPECIAL] 언데드를 소환하여 전투를 지원하게 합니다."
        },
        
        # 궁극기들
        r'"description": "\[궁극\] ([^"]*) - 기본 스킬"': {
            "전사의격노": "[궁극] 전사의 분노를 폭발시켜 적에게 엄청난 피해를 가하는 궁극기입니다.",
            "검제비의": "[궁극] 검의 황제가 되어 모든 적을 베는 궁극 오의입니다. 적을 침묵시킬 수 있습니다.",
            "오의무상베기": "[궁극] 무상의 경지에서 펼치는 궁극의 검술로 적을 완전히 제압합니다.",
            "깨달음의경지": "[궁극] 무술의 깨달음에 도달하여 초월적인 힘을 발휘합니다.",
            "마검의진리": "[궁극] 마검의 진리를 깨달아 마법과 검술의 완벽한 조화를 이룹니다.",
            "철학자의돌": "[궁극] 연금술의 최고 산물인 철학자의 돌로 기적을 일으킵니다.",
            "기가포탑": "[궁극] 초거대 포탑을 소환하여 적 전체에게 압도적인 화력을 퍼붓습니다."
        }
    }
    
    changes_made = 0
    
    # 각 스킬에 대해 개선된 설명으로 교체
    for pattern, skill_descriptions in improvements.items():
        matches = re.finditer(pattern, content)
        for match in matches:
            skill_name = match.group(1)
            if skill_name in skill_descriptions:
                old_desc = match.group(0)
                new_desc = f'"description": "{skill_descriptions[skill_name]}"'
                content = content.replace(old_desc, new_desc)
                changes_made += 1
                print(f"   개선 {changes_made}: {skill_name} - 설명 업데이트")
    
    # 파일 저장
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)
    
    print(f"\n🎉 총 {changes_made}개 스킬 설명 개선 완료!")
    return True

if __name__ == "__main__":
    print("=== 스킬 설명 개선 스크립트 ===")
    improve_skill_descriptions()
