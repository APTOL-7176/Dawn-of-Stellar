"""
í´ë˜ì‹ íŒŒí‹°ì› ê²Œì„ëª¨ë“œ - ì „ì²´ ì‹œìŠ¤í…œ í†µí•© (ì„±ë³„/ì„±ê²© ëŒ€í™” ì‹œìŠ¤í…œ í¬í•¨)
í”Œë ˆì´ì–´ê°€ ì„ íƒí•œ ìºë¦­í„°ë§Œ ì§ì ‘ ì¡°ì‘í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” AIê°€ ìë™ ì¡°ì‘
ì €ì¥ì‹œìŠ¤í…œ, í•„ë“œìŠ¤í‚¬, ìš”ë¦¬ì‹œìŠ¤í…œ, ì¥ë¹„ì‹œìŠ¤í…œ, ì„±ë³„ ê¸°ë°˜ ëŒ€í™”ì‹œìŠ¤í…œ ëª¨ë‘ ì—°ë™
"""
import random
import time
from typing import List, Dict, Optional, Tuple
from enum import Enum

from game.ai_companion_system import AICompanion, AIPersonality, AIRequest, ai_mercenary_manager
from game.character import Character

def setup_ai_combat_mode(combat_system):
    """ì „íˆ¬ ì‹œìŠ¤í…œì— í´ë˜ì‹ ëª¨ë“œ ì„¤ì •"""
    if hasattr(combat_system, 'set_ai_game_mode'):
        combat_system.set_ai_game_mode(True)
        print("ğŸ¤– í´ë˜ì‹ ê²Œì„ ëª¨ë“œ ì „íˆ¬ ì„¤ì • ì™„ë£Œ")
    return combat_system

# ìºë¦­í„° ì„±ë³„/ì„±ê²© ì‹œìŠ¤í…œ
class CharacterGender(Enum):
    """ìºë¦­í„° ì„±ë³„"""
    MALE = "male"
    FEMALE = "female"

class CharacterPersonality(Enum):
    """ìºë¦­í„° ì„±ê²© íƒ€ì…"""
    CHEERFUL = "cheerful"       # ë°ê³  ì¾Œí™œí•œ
    SERIOUS = "serious"         # ì§„ì§€í•˜ê³  ì—„ê²©í•œ
    GENTLE = "gentle"           # ì˜¨í™”í•˜ê³  ì¹œì ˆí•œ
    COLD = "cold"               # ì°¨ê°‘ê³  ëƒ‰ì •í•œ
    PLAYFUL = "playful"         # ì¥ë‚œê¸° ë§ê³  í™œë°œí•œ
    MYSTERIOUS = "mysterious"   # ì‹ ë¹„ë¡­ê³  ê³¼ë¬µí•œ
    HOT_TEMPERED = "hot_tempered"  # ì„±ê²©ì´ ê¸‰í•˜ê³  í™”ë¥¼ ì˜ ëƒ„
    WISE = "wise"               # í˜„ëª…í•˜ê³  ì¹¨ì°©í•œ
    BALANCED = "balanced"       # ê· í˜•ì¡íŒ (ê¸°ë³¸ê°’)

class CharacterTraits:
    """ìºë¦­í„° íŠ¹ì„± (ì„±ë³„, ì„±ê²©, ëŒ€í™” ìŠ¤íƒ€ì¼)"""
    
    # ë‚¨ì„± ì´ë¦„ í’€ (auto_party_builderì—ì„œ ê°€ì ¸ì˜´)
    MALE_NAMES = [
        "ì•„ë¦¬ìš°ìŠ¤", "ë°œë Œíƒ€ì¸", "ê°€ë¸Œë¦¬ì—˜", "ë¼íŒŒì—˜", "ì¹´ì´ì €", "ë ˆì˜¤ë‚˜ë¥´ë“œ", "ì„¸ë°”ìŠ¤ì°¬", "ì•Œë ‰ì‚°ë”",
        "ë§‰ì‹œë¬´ìŠ¤", "ì•„ë“œë¦¬ì•ˆ", "ë£¨ì¹´ìŠ¤", "ë‹ˆì½œë¼ìŠ¤", "ë„ë¯¸ë‹‰", "ë¹ˆì„¼íŠ¸", "ì—ë°€ë¦¬ì˜¤", "ë§ˆë¥´ì½”",
        "í´ë¼ìš°ë””ìš°ìŠ¤", "ì˜¤ê±°ìŠ¤íŠ¸", "ë°”ì‹¤ë¦¬ìš°ìŠ¤", "ì´ê·¸ë‹ˆìŠ¤", "í ë¦­ìŠ¤", "ë¼ì´ì–¸", "ì—ë¦­",
        "ë§ˆí‹´", "ì—˜ë¦¬ì•„ìŠ¤", "ë‹¤ë¯¸ì•ˆ", "ìœ¨ë¦¬ì•ˆ", "ì¹´ë¥¼ë¡œìŠ¤", "ë””ì—ê³ ", "íŒŒë¸”ë¡œ", "í”„ë€ì‹œìŠ¤",
        "ë¡œë“œë¦¬ê³ ", "ì•ˆí† ë‹ˆì˜¤", "í˜ë“œë¡œ", "ë¯¸êµ¬ì—˜", "í˜¸ì„¸", "ë£¨ì´ìŠ¤", "í˜ë¥´ë‚œë„", "ì• ë“œì›Œë“œ",
        "ë¼ëª¬", "í˜¸ë¥´í—¤", "ë§ˆëˆ„ì—˜", "í”„ë‘í¬", "ì˜¬ë¦¬ë²„", "í•´ë¦¬", "ì­", "ìœŒë¦¬ì—„", "ì œì„ìŠ¤",
        "ì°°ìŠ¤", "ë¡œë²„íŠ¸", "ë§ˆì´í´", "ë°ì´ë¹„ë“œ", "ë¦¬ì²˜ë“œ", "ì¡°ì…‰", "í† ë¨¸ìŠ¤", "í¬ë¦¬ìŠ¤í† í¼",
        "ë§¤íŠ¸", "ì•¤ì†Œë‹ˆ", "ë§ˆí¬", "ë„ë„ë“œ", "ìŠ¤í‹°ë¸", "í´", "ì•¤ë“œë¥˜", "ì¡°ìŠˆì•„", "ì¼€ë„¤ìŠ¤",
        "ì¼€ë¹ˆ", "ë¸Œë¼ì´ì–¸", "ì¡°ì§€", "ì—ë“œì›Œë“œ", "ë¡œë„ë“œ", "í‹°ëª¨ì‹œ", "ì œì´ìŠ¨", "ì œí”„ë¦¬",
        "ë¼ì´ì–¸", "ì œì´ì½¥", "ê²Œë¦¬", "ë‹ˆì½œë¼ìŠ¤", "ì¡°ë‚˜ë‹¨", "ë˜ë¦¬", "ì €ìŠ¤í‹´", "ìŠ¤ì½§",
        "ë¸Œëœë“ ", "ë²¤ìë¯¼", "ì‚¬ë¬´ì—˜", "ê·¸ë ˆê³ ë¦¬", "íŒ¨íŠ¸ë¦­", "ë°ë‹ˆìŠ¤", "ì œë¦¬", "íƒ€ì¼ëŸ¬",
        "ì• ëŸ°", "í—¨ë¦¬", "ë”ê¸€ëŸ¬ìŠ¤", "ë„¤ì´ì„ ", "í”¼í„°", "ì­ìŠ¨", "ë…¸ì•„", "ì´ë‹¨", "ë£¨ì¹´ìŠ¤",
        "ë©”ì´ìŠ¨", "ë¡œê±´", "ìœŒë¦¬ì—„", "ì—˜ë¦¬ì•¼", "ì›¨ì¸", "ì¹¼ë ™", "ë‹ˆì½œë¼ìŠ¤", "ì¡°ë˜","í…Œì˜¤",
        "ê·¸ë ˆì´ìŠ¨", "í—Œí„°", "ì—ì´ë“ ", "ì¹´ë©”ë¡ ", "ì½”ë„ˆ", "ì‚°í‹°ì•„ê³ ", "ì´ì‚¬ì´ì•¼", "ì°°ë¦¬",
        "ì´ë°˜", "ì˜¤ì›¬", "ë£¨í¬", "ë”œëŸ°", "ì­ìŠ¨", "ê°€ë¹ˆ", "ì½œíŠ¼", "ë§¥ìŠ¤", "ë¸Œë ˆì´ë“ ",
        "ì¹´í„°", "ë‹¤ë‹ˆì—˜", "ì•„ë‹´", "ì—˜ë¼ì´", "í•€", "ì½”ë”˜", "íŠ¸ë¦¬ìŠ¤íƒ„", "ë¡œë„Œ", "ë¸”ë ˆì´í¬",
        "ë¸Œë¡œë””", "ë°í´ëŸ°", "ìˆ€", "ë¦¬ì•”", "ë£¨ì¹´", "ì œì„ìŠ¨", "ì¹´ì¼", "ì•Œë ‰ìŠ¤", "ìì´ë“ ",
        "ìë¹„ì—ë¥´", "ë„ë¯¸ë‹‰", "ë°ë¯¸íŠ¸ë¦¬", "ì—ì´ìŠ¤", "ë‹ˆí‚¤íƒ€", "ë¸”ë¼ë””ë¯¸ë¥´", "ì•Œë ‰ì„¸ì´",
        "ì´ë°˜", "ì•ˆí†¤", "ì˜¬ë ‰", "ì„¸ë¥´ê²", "ë¹…í„°", "ë¡œë§Œ", "íŒŒë²¨", "ë…¹í‹°ìŠ¤", "ì•„ë¥´í…œ",
        "ì½˜ìŠ¤íƒ„í‹´", "ë°œë Œí‹´", "ë“œë¯¸íŠ¸ë¦¬", "í‹°ë”", "í´ë¼ìš°ë“œ", "í”„ë¡¬í”„í† ", "ê·¸ë¦¼ë‹ˆë¥´", "ì‹œìŠ¤", "ëœìŠ¬ë¡¯"
    ]
    
    # ì—¬ì„± ì´ë¦„ í’€
    FEMALE_NAMES = [
        "ì•„ë¦¬ì•„", "ì…€ë ˆìŠ¤íŠ¸", "ìœ ë‚˜", "ì´ì‚¬ë²¨ë¼", "ë°œë ˆë¦¬ì•„", "ì„¸ë¼í”¼ë‚˜", "ì•„ë“œë¦¬ì•„ë‚˜", "ë°€ë¦¬ì•„",
        "ë¹„ë¹„ì•ˆ", "í´ë¼ë¼", "ë¹„ë¼", "ìœ ì—˜", "ì—ë°€ë¦¬ì•„", "ë£¨ì‹œì•„", "ì†Œí”¼ì•„", "ì˜¬ë¦¬ë¹„ì•„",
        "ë‚˜íƒˆë¦¬ì•„", "ì¹´ë°€ë¼", "ë ˆì˜¤ë‹ˆ", "ë¯¸ë¦¬ì•”", "ë¡œì‚¬", "ì—ìŠ¤í…”ë¼", "ë°”ì´ì˜¬ë ›", "ìƒ¬ë¡¯",
        "ë² ì•„íŠ¸ë¦¬ì²´", "ì¹´íƒ€ë¦¬ë‚˜", "ë ˆë² ì¹´", "ì—˜ë ˆë‚˜", "ë§ˆë¦¬ì•„", "ì•ˆë‚˜", "ë£¨ë‚˜", "ì‹œì—ë¼",
        "ë‹ˆë‚˜", "ì—ë°”", "ë¦´ë¦¬ì•ˆ", "ë¡œë Œ", "ê·¸ë ˆì´ìŠ¤", "ì—ë°€ë¦¬", "í•œë‚˜", "ì— ë§ˆ", "ë§¤ë””ìŠ¨",
        "ì• ìŠë¦¬", "ì‚¬ë¼", "ë¸Œë¦¬íŠ¸ë‹ˆ", "ì‚¬ë§Œë‹¤", "ì œì‹œì¹´", "ì•„ë§Œë‹¤", "ìŠ¤í…ŒíŒŒë‹ˆ", "ë‹ˆì½œ",
        "ë©œë¦¬ì‚¬", "ë°ë³´ë¼", "ë ˆì´ì²¼", "ìºì„œë¦°", "ì—˜ë¦¬ìë² ìŠ¤", "í•´ë”", "í‹°íŒŒë‹ˆ", "ì—ì´ë¯¸",
        "ì¤„ë¦¬", "ì¡°ì´ìŠ¤", "ë¹…í† ë¦¬ì•„", "ì¼ˆë¦¬", "í¬ë¦¬ìŠ¤í‹°ë‚˜", "ì¡°ì•ˆ", "ì´ë¸”ë¦°", "ë¦°ë‹¤",
        "ë°”ë°”ë¼", "ì—˜ë Œ", "ìºëŸ´", "ì‚°ë“œë¼", "ë„ë‚˜", "ë£¨ìŠ¤", "ìƒ¤ë¡ ", "ë¯¸ì…¸", "ë¡œë¼",
        "ì¹¼ë¼", "ìŠ¤í…ŒíŒŒë‹ˆ", "ìºë¡¤ë¼ì¸", "ì—˜ë¦¬", "ì œë‚˜", "ë¸Œë£©", "ì¼€ì´íŠ¸", "ì‚¬ë°”ë‚˜",
        "í…Œì¼ëŸ¬", "í‚´ë²Œë¦¬", "ë°ì´ì§€", "í•˜ì´ë””", "ê°€ë¸Œë¦¬ì—˜ë¼", "ë‹ˆí‚¤", "ë¡œë¦°", "ì…¸ë¦¬",
        "ë ˆìŠ¬ë¦¬", "ì—ë¦¬ì¹´", "ì¹´ì¼ë¦°", "ì• ë‚˜", "ì½”íŠ¸ë‹ˆ", "ë£¨ë¹„", "ë©”ê°„", "ì•Œë ‰ì‹œìŠ¤",
        "í´ë¡œì—", "ì´ì‚¬ë²¨", "ì—ì´ë°”", "ë°€ë¼", "ì•„ë¦¬ì•„ë‚˜", "ë¼ì¼ë¼", "ë¯¸ì•„", "ë¼ì¼ë¦¬",
        "í´ë ˆì–´", "ì—˜ë¦¬ì•„ë‚˜", "ë‚˜ì˜¤ë¯¸", "ë„¤ì´íƒˆë¦¬", "í—¤ì¼ë¦¬", "ë¸Œë£¨í´ë¦°", "ì•¨ë¦¬ìŠ¨",
        "ììŠ¤ë¯¼", "ë§ˆì•¼", "í˜ë„¬ë¡œí˜", "ì˜¤ë¥¼ë¦¬", "ìŠ¤ì¹´ë¥¼ë¦¿", "ì• ë‚˜ìŠ¤íƒ€ìƒ¤", "ë² ë¡œë‹ˆì¹´",
        "í…Œë ˆì‚¬", "ì•¤ì ¤ë¼", "ì¹´ë¥´ë©˜", "ëª°ë¦¬", "ì›¬ë””", "ë¦¬ì‚¬", "ì•„ë‹ˆíƒ€", "ë¦¬ë¹„",
        "ì•Œë¦¬ì‹œì•„", "ì•Œë ‰ì‚°ë“œë¼", "í‚¤ì•„ë¼", "ì¡°ì•„ë‚˜", "ë§ˆë¦¬ì‚¬", "ì¹´ë Œ", "ìŠ¤í…Œì´ì‹œ",
        "ë‹¤ì´ì• ë‚˜", "ë¡œì¦ˆ", "ì´ì†”ë°", "ê¸°ë„¤ë¹„ì–´", "ëª¨ë¥´ê°€ë‚˜", "ì•„ë¥´í…Œë¯¸ìŠ¤", "ì•„í…Œë‚˜",
        "í—¤ë¼", "ì•„í”„ë¡œë””í…Œ", "í—¤ìŠ¤í‹°ì•„", "ë°ë©”í…Œë¥´", "í ë ˆ", "í”„ë ˆì´ì•¼", "ì´ë‘ë‚˜",
        "ë¸Œë£¬íë°", "ë°œí‚¤ë¦¬", "í‚¤ë¥´ì¼€", "ì¹´ì‚°ë“œë¼", "ì•ˆë“œë¡œë©”ë‹¤", "í—¬ë Œ", "í´ë ˆì˜¤íŒŒíŠ¸ë¼",
        "ì´ì‹œìŠ¤", "ë„¤í˜ë¥´í‹°í‹°", "ì„¸ë¼í•Œ", "ìš°ë¦¬ì—˜", "ê°€ë¸Œë¦¬ì—˜ë¼", "ë¯¸ì¹´ì—˜ë¼", "ë¼íŒŒì—˜ë¼",
        "ì•„ë¦¬ì—˜", "ì ¤ë‹¤", "ì„¸ë ˆë‚˜", "íŒ¬ë„ë¼", "í¬ì—ë² ", "ì…€ë ˆë„¤", "í—¤ì¹´í…Œ", "ë‹˜í”„",
        "ì˜¤ë¡œë¼", "ìŠ¤í…”ë¼", "ë…¸ë°”", "ë² ê°€", "ì¹´ì‹œì˜¤í˜ì•„", "ë¼ì´ë¼", "ì•Œíƒ€ì´ë¥´",
        "ë²¨ë¼íŠ¸ë¦­ìŠ¤", "ë¦¬ê²”", "ì‹œë¦¬ìš°ìŠ¤", "í”„ë¡œí‚¤ì˜¨", "ì•„í¬íˆ¬ë£¨ìŠ¤", "ìŠ¤í”¼ì¹´", "ì•Œë°ë°”ë€",
        "ì¹´í ë¼", "í´ë£©ìŠ¤", "ë ˆêµ´ë£¨ìŠ¤", "ì•ˆíƒ€ë ˆìŠ¤", "ì˜¤ì¦ˆ","ì½”ë¦°"
    ]
    
    # ì„±ê²©ë³„ ëŒ€í™” ìŠ¤íƒ€ì¼ (ëŒ€í­ í™•ì¥)
    PERSONALITY_DIALOGUE = {
        CharacterPersonality.CHEERFUL: {
            "greeting": ["ì•ˆë…•! ì˜¤ëŠ˜ë„ ì‹ ë‚˜ëŠ” í•˜ë£¨ì•¼!", "ì™€! ë­”ê°€ ì¬ë°ŒëŠ” ì¼ì´ ìƒê¸¸ ê²ƒ ê°™ì•„!", "ì¢‹ì€ ì•„ì¹¨ì´ì•¼! ê¸°ë¶„ì´ ìµœê³ !", 
                        "í—¤ì´! ê°™ì´ ëª¨í—˜í•˜ì!", "ì˜¤ëŠ˜ì€ ì •ë§ ì¢‹ì€ ë‚ ì´ ë  ê²ƒ ê°™ì•„!", "ëª¨ë‘ ëª¨ì—¬ì„œ ë‹¤í–‰ì´ì•¼!",
                        "ë„ˆë¬´ ê¸°ëŒ€ë¼! ë­˜ í•  ê±°ì•¼?", "ì™€, ë‚ ì”¨ë„ ì¢‹ê³  ê¸°ë¶„ë„ ì¢‹ì•„!", "í•¨ê»˜ ìˆì–´ì„œ ì •ë§ ì¦ê±°ì›Œ!"],
            "battle_start": ["ì´ë²ˆì—” ë‚´ê°€ í™œì•½í•  ì°¨ë¡€ì•¼!", "ìš°ë¦¬ ê°™ì´ í˜ë‚´ì!", "ëª¨ë‘ íŒŒì´íŒ…!", 
                           "ì‹ ë‚˜ëŠ” ì „íˆ¬ ì‹œì‘!", "ë‹¤ë“¤ ì¤€ë¹„ëì§€? ê°€ì!", "ìš°ë¦¬ê°€ ì´ê¸¸ ê±°ì•¼!",
                           "í˜ë‚´ì! ìš°ë¦¬ëŠ” ìµœê³ ì˜ íŒ€ì´ì•¼!", "ì „íˆ¬ë„ ì¬ë°Œê²Œ í•˜ì!", "ëª¨ë‘ í•¨ê»˜ ì‹¸ìš°ì!"],
            "victory": ["ì•¼í˜¸! ìš°ë¦¬ê°€ ì´ê²¼ì–´!", "ì •ë§ ë©‹ì§„ íŒ€ì›Œí¬ì˜€ì–´!", "ë‹¤ë“¤ ê³ ìƒí–ˆì–´!", 
                       "ì™„ë²½í•œ ìŠ¹ë¦¬ì•¼!", "ìš°ë¦¬ ì •ë§ ëŒ€ë‹¨í•´!", "ì´ëŸ° ê¸°ë¶„ ìµœê³ ì•¼!",
                       "ë‹¤ìŒ ì „íˆ¬ë„ ê¸°ëŒ€ë¼!", "ëª¨ë‘ê°€ ìµœê³ ì˜€ì–´!", "ìŠ¹ë¦¬ì˜ ê¸°ì¨ì„ ë‚˜ëˆ„ì!"],
            "low_hp": ["ì•—, ì¢€ ì•„í”„ê¸´ í•˜ì§€ë§Œ ê´œì°®ì•„!", "ì•„ì§ í•  ìˆ˜ ìˆì–´!", "ê±±ì • ë§ˆ, ê¸ˆë°© íšŒë³µë  ê±°ì•¼!",
                      "ì´ ì •ë„ëŠ” ì•„ë¬´ê²ƒë„ ì•„ë‹ˆì•¼!", "ì•„ì§ í¬ê¸°í•˜ì§€ ì•Šì„ ê±°ì•¼!", "ë‹¤ì‹œ ì¼ì–´ì„¤ ìˆ˜ ìˆì–´!",
                      "ì¡°ê¸ˆë§Œ ì‰¬ë©´ ê´œì°®ì„ ê±°ì•¼!", "ë‚´ ì˜ì§€ëŠ” êº¾ì´ì§€ ì•Šì•„!", "í¬ë§ì„ ìƒì§€ ì•Šì„ê²Œ!"],
            "item_request": ["í˜¹ì‹œ íšŒë³µ ì•„ì´í…œ í•˜ë‚˜ë§Œ ì¤„ ìˆ˜ ìˆì„ê¹Œ?", "ì•„ì´í…œ ì¢€ ë‚˜ëˆ ì¤„ë˜?", "ë„ì›€ì´ í•„ìš”í•´!",
                           "ê°™ì´ ë‚˜ëˆ  ì“°ì!", "ì¹œêµ¬ë¼ë¦¬ ì„œë¡œ ë„ì™€ì•¼ì§€!", "ë¶€íƒí•´ë„ ë ê¹Œ?",
                           "ì•„ì´í…œ ì¢€ ë¹Œë ¤ì¤„ë˜?", "ìš°ë¦¬ëŠ” í•œ íŒ€ì´ì–ì•„!", "ë„ì™€ì£¼ë©´ ì •ë§ ê³ ë§ˆìš¸ ê±°ì•¼!"],
            "praise": ["ì™€, ì •ë§ ëŒ€ë‹¨í•´!", "ë„ˆ ì§„ì§œ ë©‹ìˆë‹¤!", "ìµœê³ ì•¼!", 
                      "ì •ë§ í›Œë¥­í•œ ì‹¤ë ¥ì´ì•¼!", "ì¡´ê²½ìŠ¤ëŸ¬ì›Œ!", "ì–´ë–»ê²Œ ê·¸ë ‡ê²Œ ì˜í•´?",
                      "ë„ˆë¬´ ë©‹ì ¸ì„œ ë§ì´ ì•ˆ ë‚˜ì™€!", "ì§„ì§œ í”„ë¡œêµ¬ë‚˜!", "ë°°ìš°ê³  ì‹¶ì–´!"],
            "thanks": ["ê³ ë§ˆì›Œ! ì •ë§ ë„ì›€ì´ ëì–´!", "ì—­ì‹œ ë¯¿ì„ ë§Œí•´!", "ë„ˆ ë•ë¶„ì´ì•¼!",
                      "ì •ë§ ê³ ë§ˆìš´ ì¹œêµ¬ì•¼!", "ì–¸ì œë“  ë‚˜ë„ ë„ì™€ì¤„ê²Œ!", "ì¹œêµ¬ê°€ ìˆì–´ì„œ ë‹¤í–‰ì´ì•¼!",
                      "ë§ˆìŒì´ ë”°ëœ»í•´ì ¸!", "ì´ëŸ° ì¹œêµ¬ë¥¼ ë‘¬ì„œ í–‰ë³µí•´!", "ì •ë§ ê°ë™ì´ì•¼!"]
        },
        CharacterPersonality.SERIOUS: {
            "greeting": ["ì•ˆë…•í•˜ë‹¤.", "ì˜¤ëŠ˜ë„ ìµœì„ ì„ ë‹¤í•˜ì.", "ì¤€ë¹„ëŠ” ëë‚¬ë‹¤.",
                        "ì„ë¬´ì— ì§‘ì¤‘í•˜ì.", "ì±…ì„ê°ì„ ê°€ì§€ê³  í–‰ë™í•˜ì.", "ì§„ì¤‘í•˜ê²Œ ì ‘ê·¼í•˜ì.",
                        "ëª©í‘œë¥¼ ëª…í™•íˆ í•˜ì.", "ê³„íšì ìœ¼ë¡œ ì›€ì§ì´ì.", "ëƒ‰ì •í•¨ì„ ìœ ì§€í•˜ì."],
            "battle_start": ["ë°©ì‹¬í•˜ì§€ ë§ì.", "ì‹ ì¤‘í•˜ê²Œ ì ‘ê·¼í•˜ì.", "ê³„íšëŒ€ë¡œ ì›€ì§ì´ì.",
                           "ì „ìˆ ì„ ì¤€ìˆ˜í•˜ì.", "ê°ìì˜ ì—­í• ì— ì¶©ì‹¤í•˜ì.", "ì‹¤ìˆ˜ëŠ” í—ˆìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.",
                           "ì¹¨ì°©í•˜ê²Œ ëŒ€ì‘í•˜ì.", "ì™„ë²½í•˜ê²Œ ìˆ˜í–‰í•˜ì.", "í”„ë¡œë‹µê²Œ í–‰ë™í•˜ì."],
            "victory": ["ì¢‹ì€ ê²°ê³¼ë‹¤.", "ëª¨ë‘ ìˆ˜ê³ í–ˆë‹¤.", "ë‹¤ìŒì„ ì¤€ë¹„í•˜ì.",
                       "ê³„íšëŒ€ë¡œ ì§„í–‰ëë‹¤.", "ë§Œì¡±ìŠ¤ëŸ¬ìš´ ì„±ê³¼ë‹¤.", "íš¨ìœ¨ì ì´ì—ˆë‹¤.",
                       "ì „ìˆ ì´ ì„±ê³µí–ˆë‹¤.", "íŒ€ì›Œí¬ê°€ ì¢‹ì•˜ë‹¤.", "ë‹¤ìŒ ëª©í‘œë¡œ ì´ë™í•˜ì."],
            "low_hp": ["ìƒí™©ì´ ì¢‹ì§€ ì•Šë‹¤.", "ì¹˜ë£Œê°€ í•„ìš”í•˜ë‹¤.", "ì ì‹œ í›„í‡´í•˜ê² ë‹¤.",
                      "ì „ëµì  í›„í‡´ê°€ í•„ìš”í•˜ë‹¤.", "ì¬ì •ë¹„ê°€ í•„ìš”í•˜ë‹¤.", "ìƒí™©ì„ íŒŒì•…í•´ì•¼ í•œë‹¤.",
                      "ë¬´ë¦¬í•˜ì§€ ì•Šê² ë‹¤.", "í˜„ì‹¤ì ì¸ íŒë‹¨ì´ í•„ìš”í•˜ë‹¤.", "ëƒ‰ì •í•˜ê²Œ ëŒ€ì²˜í•˜ì."],
            "item_request": ["íšŒë³µ ì•„ì´í…œì´ í•„ìš”í•˜ë‹¤.", "ì§€ì›ì„ ìš”ì²­í•œë‹¤.", "ë„ì›€ì´ í•„ìš”í•˜ë‹¤.",
                           "ì „ìˆ ì  ì§€ì›ì´ í•„ìš”í•˜ë‹¤.", "ìì› ë°°ë¶„ì„ ìš”ì²­í•œë‹¤.", "íš¨ìœ¨ì ì¸ ì§€ì›ì„ ë¶€íƒí•œë‹¤.",
                           "ì „ëµì  íŒë‹¨ì„ êµ¬í•œë‹¤.", "í˜‘ë ¥ì´ í•„ìš”í•˜ë‹¤.", "íŒ€ì›Œí¬ë¥¼ ë°œíœ˜í•˜ì."],
            "praise": ["í›Œë¥­í•œ íŒë‹¨ì´ì—ˆë‹¤.", "ì¢‹ì€ ì „ìˆ ì´ë‹¤.", "ì‹ ë¢°í•  ìˆ˜ ìˆë‹¤.",
                      "ì „ë¬¸ê°€ë‹¤ìš´ ì‹¤ë ¥ì´ë‹¤.", "íš¨ê³¼ì ì¸ í–‰ë™ì´ì—ˆë‹¤.", "ê¸°ëŒ€ ì´ìƒì˜ ì„±ê³¼ë‹¤.",
                      "ì™„ë²½í•œ ìˆ˜í–‰ì´ì—ˆë‹¤.", "í”„ë¡œì˜ ìì§ˆì´ ë³´ì¸ë‹¤.", "ì¡´ê²½ìŠ¤ëŸ½ë‹¤."],
            "thanks": ["ê³ ë§™ë‹¤.", "ë„ì›€ì„ ìŠì§€ ì•Šê² ë‹¤.", "ë¹šì„ ì¡Œë‹¤.",
                      "ê°ì‚¬ì˜ ë§ì„ ì „í•œë‹¤.", "í˜‘ë ¥ì— ê°ì‚¬í•œë‹¤.", "ë„ì›€ì´ ì»¸ë‹¤.",
                      "ì‹ ë¢°ì— ë³´ë‹µí•˜ê² ë‹¤.", "ì€í˜œë¥¼ ê¸°ì–µí•˜ê² ë‹¤.", "ì¢‹ì€ ë™ë£Œë‹¤."]
        },
        CharacterPersonality.GENTLE: {
            "greeting": ["ì•ˆë…•í•˜ì„¸ìš”~ ì¢‹ì€ í•˜ë£¨ì˜ˆìš”.", "ì˜¤ëŠ˜ë„ í•¨ê»˜í•´ì„œ ê¸°ë»ìš”.", "í‰ì•ˆí•œ ì•„ì¹¨ì´ë„¤ìš”.",
                        "ëª¨ë‘ ê±´ê°•í•˜ì‹ ê°€ìš”?", "ì˜¤ëŠ˜ë„ ë¬´ì‚¬íˆ ë§Œë‚˜ì„œ ë‹¤í–‰ì´ì—ìš”.", "í•¨ê»˜ ìˆì–´ì„œ ë§ˆìŒì´ í¸í•´ìš”.",
                        "ì¢‹ì€ ì‹œê°„ì´ ë˜ê¸¸ ë°”ë¼ìš”.", "í‰í™”ë¡œìš´ í•˜ë£¨ê°€ ë˜ë©´ ì¢‹ê² ì–´ìš”.", "ëª¨ë‘ ì›ƒëŠ” ì–¼êµ´ì´ë„¤ìš”."],
            "battle_start": ["ì¡°ì‹¬í•´ì„œ ê°€ìš”.", "ì„œë¡œ ì§€ì¼œì£¼ë©´ì„œ í•´ìš”.", "ë¬´ë¦¬í•˜ì§€ ë§ì•„ìš”.",
                           "ì•ˆì „ì„ ìš°ì„ ìœ¼ë¡œ í•´ìš”.", "ì„œë¡œ ê±±ì •í•´ì£¼ë©° í•´ìš”.", "ë‹¤ì¹˜ì§€ ì•Šê²Œ ì¡°ì‹¬í•´ìš”.",
                           "ì²œì²œíˆ ì‹ ì¤‘í•˜ê²Œ ê°€ìš”.", "ëª¨ë‘ ë¬´ì‚¬íˆ ëŒì•„ê°€ìš”.", "í‰í™”ë¡­ê²Œ í•´ê²°ë˜ë©´ ì¢‹ê² ì–´ìš”."],
            "victory": ["ë‹¤í–‰ì´ì—ìš”. ëª¨ë‘ ë¬´ì‚¬í•´ì„œ ì¢‹ì•„ìš”.", "ìˆ˜ê³ í•˜ì…¨ì–´ìš”.", "ì˜ í–ˆì–´ìš”.",
                       "ëª¨ë‘ ê±´ê°•í•´ì„œ ë‹¤í–‰ì´ì—ìš”.", "í‰í™”ë¡­ê²Œ ëë‚˜ì„œ ì¢‹ì•„ìš”.", "ê±±ì •í–ˆëŠ”ë° ì˜ ëë„¤ìš”.",
                       "ì„œë¡œ ë„ì™€ì„œ ì´ê²¼ì–´ìš”.", "ì•„ë¬´ë„ ë‹¤ì¹˜ì§€ ì•Šì•„ì„œ ì •ë§ ë‹¤í–‰ì´ì—ìš”.", "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ì˜ í–ˆì–´ìš”."],
            "low_hp": ["ì£„ì†¡í•´ìš”, ì œê°€ ë¶€ì£¼ì˜í–ˆë‚˜ ë´ìš”.", "ê´œì°®ì•„ìš”, ê±±ì • ë§ˆì„¸ìš”.", "ì¡°ê¸ˆë§Œ ì‰¬ë©´ ê´œì°®ì„ ê±°ì˜ˆìš”.",
                      "ì œê°€ ì‹¤ìˆ˜í–ˆë‚˜ ë´ìš”.", "ê±±ì • ë¼ì³ë“œë ¤ì„œ ì£„ì†¡í•´ìš”.", "ê³§ ë‚˜ì•„ì§ˆ ê±°ì˜ˆìš”.",
                      "ë‹¤ë“¤ ì‹ ê²½ ì“°ì§€ ë§ˆì„¸ìš”.", "ì €ëŠ” ê´œì°®ìœ¼ë‹ˆê¹Œìš”.", "ì¡°ê¸ˆ ì•„í”„ì§€ë§Œ ê²¬ë”œ ìˆ˜ ìˆì–´ìš”."],
            "item_request": ["ì‹¤ë¡€ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´... ì•„ì´í…œì„ ì¢€ ë‚˜ëˆ ì£¼ì‹¤ ìˆ˜ ìˆì„ê¹Œìš”?", "ì£„ì†¡í•˜ì§€ë§Œ ë„ì›€ì´ í•„ìš”í•´ìš”.", "ë¶€íƒë“œë ¤ë„ ë ê¹Œìš”?",
                           "íê°€ ë˜ì§€ ì•Šì„ê¹Œìš”?", "ê´œì°®ìœ¼ì‹œë‹¤ë©´ ë„ì™€ì£¼ì„¸ìš”.", "ë¯¸ì•ˆí•˜ì§€ë§Œ ë¶€íƒì´ ìˆì–´ìš”.",
                           "ì£„ì†¡í•œ ë¶€íƒì´ì§€ë§Œ...", "ë„ì›€ì„ ì²­í•´ë„ ë ê¹Œìš”?", "ì–‘í•´ ë¶€íƒë“œë ¤ìš”."],
            "praise": ["ì •ë§ ëŒ€ë‹¨í•˜ì„¸ìš”!", "ì¡´ê²½ìŠ¤ëŸ¬ì›Œìš”.", "í›Œë¥­í•´ìš”!",
                      "ì–´ë–»ê²Œ ê·¸ë ‡ê²Œ ì˜í•˜ì„¸ìš”?", "ì •ë§ ë©‹ìˆì–´ìš”.", "ë°°ìš°ê³  ì‹¶ì–´ìš”.",
                      "ë„ˆë¬´ í›Œë¥­í•´ì„œ ê°ë™ì´ì—ìš”.", "ì •ë§ ëŒ€ë‹¨í•œ ë¶„ì´ì—ìš”.", "ì¡´ê²½ì˜ ë§ˆìŒì´ ë“¤ì–´ìš”."],
            "thanks": ["ì •ë§ ê°ì‚¬í•´ìš”.", "ì¹œì ˆí•˜ê²Œ í•´ì£¼ì…”ì„œ ê³ ë§ˆì›Œìš”.", "ë§ˆìŒì´ ë”°ëœ»í•´ì ¸ìš”.",
                      "ë„ˆë¬´ ê³ ë§ˆì›Œì„œ ëˆˆë¬¼ì´ ë‚˜ìš”.", "ì´ëŸ° ì¹œì ˆì„ ì–´ë–»ê²Œ ê°šì„ê¹Œìš”.", "ì •ë§ ê°ì‚¬í•œ ë§ˆìŒì´ì—ìš”.",
                      "ì€í˜œë¥¼ í‰ìƒ ìŠì§€ ì•Šì„ê²Œìš”.", "ë§ˆìŒì”¨ê°€ ë„ˆë¬´ ì¢‹ìœ¼ì„¸ìš”.", "ê°ë™ë°›ì•˜ì–´ìš”."]
        },
        CharacterPersonality.COLD: {
            "greeting": ["....", "ì•ˆë…•.", "ì¤€ë¹„ëë‚˜.",
                        "ì‹œì‘í•˜ì.", "...ë³„ë§ ì—†ë‹¤.", "...ê·¸ë ‡êµ°.",
                        "ë­”ê°€.", "...ë“¤ì–´ì˜¨ë‹¤.", "...ì‹œì‘í•  ì‹œê°„ì´ë‹¤."],
            "battle_start": ["ëë‚´ì.", "ë¹¨ë¦¬ ì²˜ë¦¬í•˜ì.", "...",
                           "ê°„ë‹¨íˆ ëë‚´ì.", "ì‹œê°„ ë‚­ë¹„ ë§ì.", "...ë.",
                           "ë¹ ë¥´ê²Œ.", "...ì²˜ë¦¬.", "ì¡°ìš©íˆ ëë‚´ì."],
            "victory": ["ë‹¹ì—°í•œ ê²°ê³¼ë‹¤.", "ë.", "ë‹¤ìŒ.",
                       "...ì˜ˆìƒëŒ€ë¡œë‹¤.", "ë³„ê±° ì•„ë‹ˆì—ˆë‹¤.", "...ê·¸ëŸ´ ì¤„ ì•Œì•˜ë‹¤.",
                       "ì‹œê°„ ë‚­ë¹„ì˜€ë‹¤.", "...ëë‚¬ë‹¤.", "ë‹¹ì—°í•˜ë‹¤."],
            "low_hp": ["...ë¬¸ì œì—†ë‹¤.", "ê´œì°®ë‹¤.", "ì‹ ê²½ ì“°ì§€ ë§ˆë¼.",
                      "...ë³„ê±° ì•„ë‹ˆë‹¤.", "ì´ ì •ë„ëŠ”...", "...ê²¬ë”œ ìˆ˜ ìˆë‹¤.",
                      "ë¬¸ì œì—†ë‹¤.", "...ê´œì°®ë‹¤.", "ì‹ ê²½ ì“¸ í•„ìš” ì—†ë‹¤."],
            "item_request": ["ì•„ì´í…œ.", "íšŒë³µì´ í•„ìš”í•˜ë‹¤.", "...ë„ì™€ì¤˜.",
                           "...í•„ìš”í•˜ë‹¤.", "ì¤„ ìˆ˜ ìˆë‚˜.", "...ë¶€íƒí•œë‹¤.",
                           "...ë„ì›€.", "í•„ìš”.", "...í•˜ë‚˜."],
            "praise": ["...ê·¸ëŸ­ì €ëŸ­.", "ë‚˜ì˜ì§€ ì•Šë‹¤.", "ì¸ì •í•œë‹¤.",
                      "...í•  ë§Œí•˜ë‹¤.", "ê´œì°®ë‹¤.", "...ê·¸ë ‡ë‹¤.",
                      "ì¸ì •.", "...ë‚˜ì˜ì§€ ì•Šë‹¤.", "í•  ë§Œí•˜ë‹¤."],
            "thanks": ["...ê³ ë§™ë‹¤.", "ë¹šì¡Œë‹¤.", "...",
                      "...ê°ì‚¬í•œë‹¤.", "ê¸°ì–µí•´ë‘ê² ë‹¤.", "...ë„ì›€ì´ ëë‹¤.",
                      "ê³ ë§™ë‹¤.", "...ë¹š.", "ë„ì›€."]
        },
        CharacterPersonality.PLAYFUL: {
            "greeting": ["í—¤ì´! ì˜¤ëŠ˜ì€ ë­˜ í• ê¹Œ?", "ì¬ë°ŒëŠ” ì¼ ì—†ë‚˜~?", "ì‹¬ì‹¬í•œë° ë­ ì¢€ í„°íŠ¸ë¦´ê¹Œ?",
                        "ë†€ ì‹œê°„ì´ì•¼!", "ë­”ê°€ ìŠ¤ë¦´ ìˆëŠ” ê±° ì—†ì„ê¹Œ?", "ì˜¤ëŠ˜ì€ ë­”ê°€ íŠ¹ë³„í•  ê²ƒ ê°™ì•„!",
                        "ì¬ë°Œê²Œ ë†€ì•„ë³´ì!", "ì‹¬ì‹¬í•¨ì„ ë‚ ë ¤ë²„ë¦¬ì!", "í¥ë¯¸ì§„ì§„í•œ í•˜ë£¨ê°€ ë  ê²ƒ ê°™ì•„!"],
            "battle_start": ["ê²Œì„ ì‹œì‘! ëˆ„ê°€ ë” ë§ì´ ì“°ëŸ¬ëœ¨ë¦¬ë‚˜ ë‚´ê¸°í• ê¹Œ?", "ì¬ë°Œê² ë‹¤!", "ì‹ ë‚˜ëŠ”ë°?",
                           "ë†€ì´ ì‹œê°„ì´ì•¼!", "ê²Œì„ ê°™ë„¤! ì¬ë°Œì–´!", "ìŠ¤ë¦´ ë„˜ì¹˜ëŠ” ì‹œê°„ì´ì•¼!",
                           "ëˆ„ê°€ ë” ë©‹ìˆê²Œ ì‹¸ìš°ë‚˜ ë³´ì!", "ì´ëŸ° ê²Œ ì§„ì§œ ì¬ë°Œì§€!", "ê²Œì„ ì‹œì‘!"],
            "victory": ["í—¤í—¤, ë„ˆë¬´ ì‰¬ì› ë‚˜?", "ë‹¤ìŒì—” ë” ê°•í•œ ì ì´ ë‚˜ì™”ìœ¼ë©´ ì¢‹ê² ì–´!", "ì¬ë°Œì—ˆì–´!",
                       "ë„ˆë¬´ ì‰¬ì›Œì„œ ì•„ì‰¬ì›Œ!", "ë” ì–´ë ¤ìš´ ë„ì „ ì—†ì„ê¹Œ?", "ê²Œì„ í´ë¦¬ì–´!",
                       "ë‹¤ìŒ ìŠ¤í…Œì´ì§€ëŠ” ì–¸ì œì•¼?", "ì´ ì •ë„ë¡œëŠ” ë§Œì¡± ì•ˆ ë¼!", "ë” ì¬ë°ŒëŠ” ê±° ì—†ë‚˜?"],
            "low_hp": ["ì•—, ê¹œë¹¡í–ˆë„¤! ê´œì°®ì•„, ì´ê²ƒë„ ìŠ¤ë¦´ ìˆì–´!", "ì´ëŸ°, ì¢€ ì•„íŒŒ!", "í˜ë“¤ê¸´ í•˜ì§€ë§Œ... ì¬ë°Œì–´!",
                      "í•˜í•˜, ì´ê²ƒë„ ê²Œì„ì˜ ì¼ë¶€ì§€!", "ìŠ¤ë¦´ ë§Œì ì´ë„¤!", "ì•„ì§ ê²Œì„ ì˜¤ë²„ëŠ” ì•„ë‹ˆì•¼!",
                      "ì´ëŸ° ìƒí™©ë„ ì¬ë°Œì–´!", "ê¸´ì¥ê° ìˆì–´ì„œ ì¢‹ì•„!", "ì—­ì „ì˜ ê¸°íšŒì•¼!"],
            "item_request": ["ì•„ì´í…œ ì¢€ ë˜ì ¸ì¤˜! ë°›ì•„ì„œ ë¨¹ì„ê²Œ!", "ë‚˜ë„ ì¢€ ì¤˜~", "ì•„ì´í…œ ë‚˜ëˆ ë¨¹ê¸° ê²Œì„?",
                           "ë‚˜ë„ íŒŒì›Œì—…í•˜ê³  ì‹¶ì–´!", "ì•„ì´í…œ ë†€ì´ í•˜ì!", "ì•„ì´í…œìœ¼ë¡œ ë†€ì•„ë³¼ê¹Œ?",
                           "ì¬ë°ŒëŠ” ì•„ì´í…œ ì—†ë‚˜?", "ë­”ê°€ ì‹ ê¸°í•œ ê±° ì¤˜ë´!", "ì•„ì´í…œ íŒŒí‹° í•˜ì!"],
            "praise": ["ì˜¤ì˜¤! ë©‹ìˆì–´!", "ë‚˜ë„ ì €ë ‡ê²Œ í•´ë´ì•¼ì§€!", "ì™„ì „ ì©”ì–´!",
                      "ì™€! ëŒ€ë°•ì´ì•¼!", "ë„ˆë¬´ ë©‹ì ¸ì„œ ë†€ëì–´!", "ì§„ì§œ ê²Œì„ ê°™ì•„!",
                      "ì™„ì „ í”„ë¡œê¸‰ì´ë„¤!", "ì–´ë–»ê²Œ ê·¸ë ‡ê²Œ í•´?", "ì‹ ê¸°í•´! ê°€ë¥´ì³ì¤˜!"],
            "thanks": ["ê³ ë§ˆì›Œ! ì–¸ì  ê°€ ê°šì„ê²Œ!", "ì—­ì‹œ ì¢‹ì€ ì¹œêµ¬ì•¼!", "ì´ëŸ° ì¹œêµ¬ê°€ ìˆì–´ì„œ ë‹¤í–‰ì´ì•¼!",
                      "ë„ˆ ì •ë§ ì¢‹ì€ ì‚¬ëŒì´ì•¼!", "ì¹œêµ¬ ë§Œì„¸!", "ì´ëŸ° ì¬ë¯¸ìˆëŠ” ì¹œêµ¬ ì²˜ìŒì´ì•¼!",
                      "ê°™ì´ ë†€ì•„ì¤˜ì„œ ê³ ë§ˆì›Œ!", "ì¬ë°ŒëŠ” ì¹œêµ¬ë„¤!", "ë˜ ê°™ì´ ë†€ì!"]
        },
        CharacterPersonality.MYSTERIOUS: {
            "greeting": ["...ì•ˆë…•.", "ìš´ëª…ì´ ìš°ë¦¬ë¥¼ ë‹¤ì‹œ ë§Œë‚˜ê²Œ í–ˆêµ°.", "...ì‹œì‘í•˜ì.",
                        "ì˜ˆì •ëœ ë§Œë‚¨ì´ì—ˆë‚˜.", "ìš´ëª…ì˜ ì‹¤ì´ ì–½í˜”ë‹¤.", "...í¥ë¯¸ë¡œìš´ ì¡°ìš°ë‹¤.",
                        "ìš´ëª…ì´ ë¶€ë¥¸ë‹¤.", "ì˜ˆì–¸ëœ ë§Œë‚¨ì¸ê°€.", "...ì‹œê°„ì´ ì™”ë‹¤."],
            "battle_start": ["ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´ê°€ ëŒê³  ìˆë‹¤.", "...ê°ìì˜ ê¸¸ì„ ê°€ì.", "ì–´ë‘ ì´ ê¹Šì–´ì§€ê³  ìˆë‹¤.",
                           "ìš´ëª…ì´ ì‹œí—˜í•˜ê³  ìˆë‹¤.", "ì˜ˆì •ëœ ì‹œë ¨ì´ë‹¤.", "...ìš´ëª…ì— ë§¡ê¸°ì.",
                           "ë³„ë“¤ì´ ì†ì‚­ì¸ë‹¤.", "ìš´ëª…ì˜ ìˆœê°„ì´ë‹¤.", "...ëª¨ë“  ê²ƒì´ ì •í•´ì ¸ ìˆì—ˆë‹¤."],
            "victory": ["ì˜ˆì •ëœ ê²°ê³¼ì˜€ë‹¤.", "ìš´ëª…ì€ ì´ë¯¸ ì •í•´ì ¸ ìˆì—ˆë‹¤.", "...ê·¸ëŸ´ ì¤„ ì•Œì•˜ë‹¤.",
                       "ë³„ë“¤ì´ ë§í–ˆë˜ ëŒ€ë¡œë‹¤.", "ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´ê°€ ëŒì•˜ë‹¤.", "...ì˜ˆì–¸ëŒ€ë¡œë‹¤.",
                       "ëª¨ë“  ê²ƒì´ ê³„íš ì•ˆì— ìˆì—ˆë‹¤.", "ìš´ëª…ì„ ê±°ìŠ¤ë¥¼ ìˆ˜ëŠ” ì—†ë‹¤.", "...ë‹¹ì—°í•œ ê²°ê³¼ë‹¤."],
            "low_hp": ["...ì´ê²ƒë„ ìš´ëª…ì¸ê°€.", "ì•„ì§... ë•Œê°€ ì•„ë‹ˆë‹¤.", "ìš´ëª…ì´ ë‚  ë²„ë¦¬ì§€ ì•Šì„ ê²ƒì´ë‹¤.",
                      "...ì‹œë ¨ì˜ ì‹œê°„ì´êµ°.", "ìš´ëª…ì´ ì‹œí—˜í•˜ê³  ìˆë‹¤.", "...ì•„ì§ ëë‚˜ì§€ ì•Šì•˜ë‹¤.",
                      "ìš´ëª…ì˜ ì‹¤ì´ ëŠì–´ì§€ì§€ ì•Šì•˜ë‹¤.", "...ì´ê²ƒë„ ì˜ˆì •ëœ ì¼ì¸ê°€.", "ë³„ë“¤ì´ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤."],
            "item_request": ["...í•„ìš”í•˜ë‹¤.", "ìš´ëª…ì´ ìš”êµ¬í•˜ê³  ìˆë‹¤.", "ë„ì›€ì´... í•„ìš”í•˜ë‹¤.",
                           "...ìš´ëª…ì˜ ì¸ë„ë‹¤.", "ë³„ë“¤ì´ ì†ì‚­ì¸ë‹¤.", "...í•„ì—°ì ì¸ ìš”ì²­ì´ë‹¤.",
                           "ìš´ëª…ì˜ ì„ íƒì´ë‹¤.", "...ë„ì›€ì„ êµ¬í•œë‹¤.", "ìš´ëª…ì´ ì´ë„ëŠ” ëŒ€ë¡œ."],
            "praise": ["í¥ë¯¸ë¡­ë‹¤.", "ì˜ˆìƒê³¼ ë‹¤ë¥´êµ°.", "...ì¸ì •í•œë‹¤.",
                      "ìš´ëª…ì´ ì„ íƒí•œ ìë¡œêµ°.", "...íŠ¹ë³„í•œ ì¡´ì¬ë‹¤.", "ë³„ë“¤ë„ ì£¼ëª©í•˜ê³  ìˆë‹¤.",
                      "ì˜ˆì–¸ì— ì—†ë˜ ì¼ì´ë‹¤.", "...ë†€ëë‹¤.", "ìš´ëª…ì„ ë°”ê¿€ ìˆ˜ ìˆëŠ” ìì¸ê°€."],
            "thanks": ["...ê¸°ì–µí•˜ê² ë‹¤.", "ë¹šì„ ì¡Œë‹¤.", "ìš´ëª…ì´ ê°šê²Œ ë  ê²ƒì´ë‹¤.",
                      "...ì€í˜œë¥¼ ìƒˆê¸°ê² ë‹¤.", "ìš´ëª…ì˜ ì‹¤ì´ ë”ìš± ì–½í˜”ë‹¤.", "...ê°ì‚¬í•œë‹¤.",
                      "ë³„ë“¤ì´ ì¶•ë³µí•  ê²ƒì´ë‹¤.", "ìš´ëª…ì´ ë³´ìƒí•  ê²ƒì´ë‹¤.", "...ìŠì§€ ì•Šê² ë‹¤."]
        },
        CharacterPersonality.HOT_TEMPERED: {
            "greeting": ["ë­ì•¼! ëŠ¦ì—ˆì–ì•„!", "ë¹¨ë¦¬ ì‹œì‘í•˜ìê³ !", "ë‹µë‹µí•´ ì£½ê² ë„¤!",
                        "ì–¸ì œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•´?", "ì‹œê°„ ë‚­ë¹„í•˜ì§€ ë§ì!", "ë¹¨ë¦¬ë¹¨ë¦¬!",
                        "ë‹µë‹µí•˜ê²Œ ë­˜ ê·¸ë ‡ê²Œ ìƒê°í•´!", "ì‹œê°„ì´ ì•„ê¹Œì›Œ!", "ë¹¨ë¦¬ ì›€ì§ì—¬!"],
            "battle_start": ["ì´ì œì•¼! ë¹¨ë¦¬ ë¤ë²¼!", "ëŠ¦ì—ˆì–´! ë¹¨ë¦¬ ëë‚´ì!", "ë‹µë‹µí•˜ê²Œ ë­˜ ê·¸ë ‡ê²Œ ìƒê°í•´!",
                           "ë“œë””ì–´! ê¸°ë‹¤ë ¸ë‹¤ê³ !", "ë¹¨ë¦¬ í•´ì¹˜ì›Œë²„ë¦¬ì!", "ì§€ê²¨ì› ì–´!",
                           "ì‹œì›í•˜ê²Œ ë‚ ë ¤ë²„ë¦¬ì!", "ë‹µë‹µí•¨ì„ í’€ì–´ë³´ì!", "ë¶ˆíƒ€ì˜¤ë¥´ë„¤!"],
            "victory": ["ë‹¹ì—°í•˜ì§€! ìš°ë¦¬ê°€ ëˆ„êµ°ë°!", "ì´ ì •ë„ëŠ” ì‹ì€ ì£½ ë¨¹ê¸°ì•¼!", "ë‹¤ìŒ ì ì€ ì–´ë”” ìˆì–´?",
                       "ë„ˆë¬´ ì‰¬ì› ì–´! ì•„ì‰½ë‹¤!", "ì´ëŸ° ê±´ ì›Œë°ì—…ë„ ì•ˆ ë¼!", "ë” ê°•í•œ ë†ˆ ì—†ë‚˜?",
                       "ì‹œì›í–ˆì–´! ìŠ¤íŠ¸ë ˆìŠ¤ í•´ì†Œ!", "ì´ ë§›ì— ì‹¸ìš°ëŠ” ê±°ì§€!", "ì™„ì „ ì¿¨í–ˆì–´!"],
            "low_hp": ["ì•„! ì§œì¦ë‚˜!", "ì´ëŸ°! ë°©ì‹¬í–ˆë„¤!", "í™”ë‚˜ëŠ”ë°! ë¹¨ë¦¬ ì¹˜ë£Œí•´ì¤˜!",
                      "ì—´ë°›ì•„! ì´ëŸ° ì‹¤ìˆ˜ë¥¼!", "ì†ìƒí•´ ì£½ê² ì–´!", "ì§œì¦ë‚˜ê²Œ!",
                      "í™”ë‚  ëŒ€ë¡œ ë‚¬ì–´!", "ì´ëŸ° ë°”ë³´ ê°™ì€!", "ë¹¨ë¦¬ íšŒë³µí•˜ê³  ë³µìˆ˜í•˜ì!"],
            "item_request": ["ì•¼! ì•„ì´í…œ ì¢€ ì¤˜!", "ë¹¨ë¦¬ ì•„ì´í…œ!", "ë‹µë‹µí•´! ì¹˜ë£Œ ì•„ì´í…œ!",
                           "ë¹¨ë¦¬ë¹¨ë¦¬! ì•„ì´í…œ!", "ì§€ê¸ˆ ë‹¹ì¥ í•„ìš”í•´!", "ì„œë‘˜ëŸ¬!",
                           "ë¹¨ë¦¬ ì•ˆ ì£¼ë©´ í™”ë‚¼ ê±°ì•¼!", "ë‹µë‹µí•˜ê²Œ!", "ì‹œê¸‰í•´!"],
            "praise": ["ì˜¤! ê´œì°®ë„¤!", "ì²˜ìŒ ë³¸ ê±°ì¹˜ê³ ëŠ” í•  ë§Œí•´!", "ê·¸ë˜, ê·¸ë ‡ê²Œ í•´ì•¼ì§€!",
                      "ì´ì œì•¼ ì¢€ ë³¼ ë§Œí•˜ë„¤!", "ê·¸ë ‡ì§€! ì´ëŸ° ê²Œ ì‹¤ë ¥ì´ì•¼!", "ë“œë””ì–´ ì œëŒ€ë¡œ í•˜ëŠ”êµ¬ë‚˜!",
                      "ì‹œì›í•˜ê²Œ ì˜í•œë‹¤!", "ì´ëŸ° ì‹ìœ¼ë¡œ í•´ì•¼ì§€!", "ë§ˆìŒì— ë“ ë‹¤!"],
            "thanks": ["ì–´... ê³ ë§ˆì›Œ.", "ë­, ë‚˜ì˜ì§€ ì•Šì•˜ì–´.", "ë‹¤ìŒì—ë„ ë¶€íƒí•œë‹¤!",
                      "ê·¸ë˜, ì´ëŸ° ê²Œ ì¹œêµ¬ì§€!", "ê³ ë§ˆì›Œ! ë¹šì§„ ê±° ì•Œì•„!", "ì—­ì‹œ ë¯¿ì„ ë§Œí•´!",
                      "ì¢‹ì•„! ë§ˆìŒì— ë“¤ì–´!", "ì´ëŸ° ì¹œêµ¬ ê´œì°®ë„¤!", "ê³ ë§™ë‹¤ê³ !"]
        },
        CharacterPersonality.WISE: {
            "greeting": ["ì•ˆë…•í•˜ì‹­ë‹ˆë‹¤. ì˜¤ëŠ˜ë„ ë°°ìš¸ ì ì´ ë§ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.", "ì§€í˜œë¡œìš´ í•˜ë£¨ê°€ ë˜ê¸¸ ë°”ë¼ë©°.", "í‰ì•ˆí•œ ì¸ì‚¬ë¥¼ ë“œë¦½ë‹ˆë‹¤.",
                        "ì˜¤ëŠ˜ë„ ìƒˆë¡œìš´ ê¹¨ë‹¬ìŒì´ ìˆê¸°ë¥¼.", "ì§€í˜œë¥¼ ë‚˜ëˆ„ëŠ” ì‹œê°„ì´ ë˜ê¸¸.", "í‰í™”ë¡œìš´ ë§Œë‚¨ì…ë‹ˆë‹¤.",
                        "ë°°ì›€ì˜ ê¸°íšŒê°€ ë˜ê¸¸ ë°”ëë‹ˆë‹¤.", "ì„œë¡œì—ê²Œ ë„ì›€ì´ ë˜ëŠ” ì‹œê°„ì´ ë˜ê¸¸.", "ì§€í˜œë¡œìš´ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ê¸¸ ë°”ëë‹ˆë‹¤."],
            "battle_start": ["ì‹ ì¤‘í•˜ê²Œ ì ‘ê·¼í•©ì‹œë‹¤.", "ê²½í—˜ì´ ìš°ë¦¬ë¥¼ ì´ëŒ ê²ƒì…ë‹ˆë‹¤.", "ì§€í˜œë¡­ê²Œ í–‰ë™í•©ì‹œë‹¤.",
                           "ì°¨ë¶„í•˜ê²Œ ìƒí™©ì„ íŒŒì•…í•©ì‹œë‹¤.", "ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ í–‰ë™í•©ì‹œë‹¤.", "í˜„ëª…í•œ íŒë‹¨ì´ í•„ìš”í•©ë‹ˆë‹¤.",
                           "ì§€í˜œë¡œìš´ ì „ëµì„ ì„¸ì›ì‹œë‹¤.", "ì‹ ì¤‘í•œ ì ‘ê·¼ì´ ìŠ¹ë¦¬ë¥¼ ê°€ì ¸ë‹¤ì¤ë‹ˆë‹¤.", "ê²½í—˜ì˜ í˜ì„ ë¯¿ìŠµì‹œë‹¤."],
            "victory": ["ì¢‹ì€ êµí›ˆì„ ì–»ì—ˆìŠµë‹ˆë‹¤.", "ëª¨ë‘ì˜ ë…¸ë ¥ì´ ê²°ì‹¤ì„ ë§ºì—ˆìŠµë‹ˆë‹¤.", "ì§€í˜œë¡œìš´ ìŠ¹ë¦¬ì˜€ìŠµë‹ˆë‹¤.",
                       "ê²½í—˜ì´ ë¹›ì„ ë°œí–ˆìŠµë‹ˆë‹¤.", "í˜„ëª…í•œ ì„ íƒì´ì—ˆìŠµë‹ˆë‹¤.", "ì§€í˜œì˜ í˜ì„ ë³´ì•˜ìŠµë‹ˆë‹¤.",
                       "ë°°ì›€ì´ ìˆëŠ” ìŠ¹ë¦¬ì˜€ìŠµë‹ˆë‹¤.", "ëª¨ë‘ê°€ ì„±ì¥í–ˆìŠµë‹ˆë‹¤.", "ì¢‹ì€ ê²½í—˜ì´ì—ˆìŠµë‹ˆë‹¤."],
            "low_hp": ["ì´ê²ƒë„ í•˜ë‚˜ì˜ ê²½í—˜ì´êµ°ìš”.", "ë•Œë¡œëŠ” í›„í‡´ë„ ì§€í˜œì…ë‹ˆë‹¤.", "ë°°ì›€ì˜ ìˆœê°„ì´ë„¤ìš”.",
                      "ì‹œë ¨ì„ í†µí•´ ì„±ì¥í•©ë‹ˆë‹¤.", "í˜„ëª…í•œ ì„ íƒì´ í•„ìš”í•œ ë•Œì…ë‹ˆë‹¤.", "ê²½í—˜ìœ¼ë¡œ ì‚¼ê² ìŠµë‹ˆë‹¤.",
                      "ì§€í˜œë¡œìš´ í›„í‡´ë¥¼ ê³ ë ¤í•´ë´…ì‹œë‹¤.", "ì´ëŸ° ìˆœê°„ë„ ë°°ì›€ì…ë‹ˆë‹¤.", "í˜„ì‹¤ì„ ì§ì‹œí•´ì•¼ í•©ë‹ˆë‹¤."],
            "item_request": ["ì§€í˜œë¡œìš´ ì„ íƒì„ ë¶€íƒë“œë¦½ë‹ˆë‹¤.", "ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤.", "í˜„ëª…í•œ íŒë‹¨ì„ êµ¬í•©ë‹ˆë‹¤.",
                           "ì§€í˜œë¥¼ ë‚˜ëˆ ì£¼ì‹œê¸¸.", "ê²½í—˜ì—ì„œ ìš°ëŸ¬ë‚˜ëŠ” ë„ì›€ì„ êµ¬í•©ë‹ˆë‹¤.", "í˜„ëª…í•œ ì§€ì›ì„ ë¶€íƒë“œë¦½ë‹ˆë‹¤.",
                           "ì§€í˜œë¡œìš´ í˜‘ë ¥ì„ ìš”ì²­í•©ë‹ˆë‹¤.", "í•¨ê»˜ ë‚˜ëˆ„ëŠ” ê²ƒì´ ì§€í˜œì…ë‹ˆë‹¤.", "ë„ì›€ì„ ì²­í•©ë‹ˆë‹¤."],
            "praise": ["í›Œë¥­í•œ ì§€í˜œì…ë‹ˆë‹¤.", "ì¡´ê²½ìŠ¤ëŸ¬ìš´ íŒë‹¨ì´ì—ˆìŠµë‹ˆë‹¤.", "ë°°ìš¸ ì ì´ ë§ìŠµë‹ˆë‹¤.",
                      "ì§€í˜œë¡œìš´ í–‰ë™ì´ì—ˆìŠµë‹ˆë‹¤.", "ê²½í—˜ì—ì„œ ìš°ëŸ¬ë‚˜ëŠ” ì‹¤ë ¥ì…ë‹ˆë‹¤.", "í˜„ëª…í•œ ì„ íƒì´ì—ˆìŠµë‹ˆë‹¤.",
                      "ê¹Šì€ í†µì°°ë ¥ì…ë‹ˆë‹¤.", "ì§€í˜œì˜ ê¹Šì´ë¥¼ ë´…ë‹ˆë‹¤.", "ì¡´ê²½í•  ë§Œí•œ ì§€í˜œì…ë‹ˆë‹¤."],
            "thanks": ["ê¹Šì´ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.", "ì§€í˜œë¥¼ ë‚˜ëˆ ì£¼ì…”ì„œ ê³ ë§™ìŠµë‹ˆë‹¤.", "ì€í˜œë¥¼ ê¸°ì–µí•˜ê² ìŠµë‹ˆë‹¤.",
                      "í˜„ëª…í•œ ë„ì›€ì— ê°ì‚¬í•©ë‹ˆë‹¤.", "ì§€í˜œë¡œìš´ ì„ íƒì— ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.", "ê¹Šì€ ê³ ë§ˆì›€ì„ í‘œí•©ë‹ˆë‹¤.",
                      "ì§€í˜œë¥¼ í•¨ê»˜ ë‚˜ëˆ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.", "í˜„ëª…í•œ íŒë‹¨ì— ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.", "ì€í˜œë¡œìš´ ë„ì›€ì´ì—ˆìŠµë‹ˆë‹¤."]
        },
        CharacterPersonality.BALANCED: {
            "greeting": ["ì•ˆë…•í•˜ì„¸ìš”.", "ì¢‹ì€ í•˜ë£¨ë„¤ìš”.", "ë§Œë‚˜ì„œ ë°˜ê°‘ìŠµë‹ˆë‹¤.",
                        "ì˜¤ëŠ˜ë„ í•¨ê»˜ í•´ë´ìš”.", "ì˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤.", "ì¢‹ì€ ë‚ ì”¨ë„¤ìš”.",
                        "í•¨ê»˜ ê°€ë´…ì‹œë‹¤.", "ì¤€ë¹„ë˜ì…¨ë‚˜ìš”?", "ì‹œì‘í•´ë³¼ê¹Œìš”?"],
            "battle_start": ["ì‹ ì¤‘í•˜ê²Œ ê°€ë³´ì£ .", "ì„œë¡œ ë„ìš°ë©° í•´ë´ìš”.", "ìµœì„ ì„ ë‹¤í•´ë´…ì‹œë‹¤.",
                           "ê°ìì˜ ì—­í• ì„ í•´ë´ìš”.", "í˜‘ë ¥í•´ì„œ í•´ê²°í•´ë´…ì‹œë‹¤.", "ì°¨ê·¼ì°¨ê·¼ ê°€ë´…ì‹œë‹¤.",
                           "í•¨ê»˜ í˜ë‚´ë´ìš”.", "ì•ˆì „í•˜ê²Œ ì²˜ë¦¬í•´ë´…ì‹œë‹¤.", "ìƒí™©ì„ íŒŒì•…í•´ë´…ì‹œë‹¤."],
            "victory": ["ì˜ í•´ëƒˆë„¤ìš”.", "ì¢‹ì€ ê²°ê³¼ì…ë‹ˆë‹¤.", "ëª¨ë‘ ìˆ˜ê³ í•˜ì…¨ì–´ìš”.",
                       "ì„±ê³µì ì´ì—ˆì–´ìš”.", "ë‹¤í–‰íˆ ì˜ ëë‚¬ì–´ìš”.", "ë§Œì¡±ìŠ¤ëŸ¬ìš´ ê²°ê³¼ë„¤ìš”.",
                       "íŒ€ì›Œí¬ê°€ ì¢‹ì•˜ì–´ìš”.", "ëª¨ë‘ì˜ ë…¸ë ¥ ë•ë¶„ì´ì—ìš”.", "ë‹¤ìŒë„ ì˜ í•´ë´…ì‹œë‹¤."],
            "low_hp": ["ì¡°ê¸ˆ í˜ë“¤ì§€ë§Œ ê´œì°®ì•„ìš”.", "ì¹˜ë£Œê°€ í•„ìš”í•  ê²ƒ ê°™ì•„ìš”.", "ì ì‹œ ì‰¬ì–´ì•¼ê² ì–´ìš”.",
                      "ë¬´ë¦¬í•˜ì§€ ì•Šê² ì–´ìš”.", "ìƒí™©ì„ ë´ê°€ë©° í•˜ê² ì–´ìš”.", "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ í–‰ë™í•˜ê² ì–´ìš”.",
                      "ë„ì›€ì´ í•„ìš”í•  ê²ƒ ê°™ì•„ìš”.", "ì‹ ì¤‘í•˜ê²Œ ëŒ€ì²˜í•˜ê² ì–´ìš”.", "í˜„ì‹¤ì ìœ¼ë¡œ íŒë‹¨í•˜ê² ì–´ìš”."],
            "item_request": ["ì•„ì´í…œ ì¢€ ë‚˜ëˆ ì¤„ ìˆ˜ ìˆì„ê¹Œìš”?", "ë„ì›€ì´ í•„ìš”í•´ìš”.", "ë¶€íƒì´ ìˆì–´ìš”.",
                           "í•¨ê»˜ ë‚˜ëˆ  ì¨ìš”.", "í˜‘ë ¥ì´ í•„ìš”í•´ìš”.", "ì§€ì›ì„ ë¶€íƒë“œë ¤ìš”.",
                           "ë„ì™€ì£¼ì‹¤ ìˆ˜ ìˆë‚˜ìš”?", "ê°™ì´ ì‚¬ìš©í•´ë´ìš”.", "í•„ìš”í•œ ê²Œ ìˆì–´ìš”."],
            "praise": ["ì˜í•˜ì‹œë„¤ìš”.", "í›Œë¥­í•´ìš”.", "ì¢‹ì€ ì‹¤ë ¥ì´ì—ìš”.",
                      "ëŒ€ë‹¨í•˜ì„¸ìš”.", "ë©‹ì ¸ìš”.", "ì¸ìƒì ì´ì—ìš”.",
                      "ì‹¤ë ¥ì´ ì¢‹ìœ¼ì‹œë„¤ìš”.", "ë°°ìš¸ ì ì´ ë§ì•„ìš”.", "ì¡´ê²½ìŠ¤ëŸ¬ì›Œìš”."],
            "thanks": ["ê³ ë§ˆì›Œìš”.", "ë„ì›€ì´ ëì–´ìš”.", "ê°ì‚¬í•©ë‹ˆë‹¤.",
                      "ê³ ë§™ìŠµë‹ˆë‹¤.", "ë„ì™€ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”.", "ì •ë§ ê³ ë§ˆì›Œìš”.",
                      "í° ë„ì›€ì´ì—ˆì–´ìš”.", "ê°ì‚¬í•œ ë§ˆìŒì´ì—ìš”.", "ê³ ë§ˆìš´ ë¶„ì´ë„¤ìš”."]
        }
    }
    
    # ì§ì—…ë³„ íŠ¹ìˆ˜ ëŒ€ì‚¬ ì‹œìŠ¤í…œ
    CLASS_SPECIFIC_DIALOGUE = {
        "ì „ì‚¬": {
            "battle_cry": ["ì¹¼ë‚ ì— ë§¡ê¸´ë‹¤!", "ì „ì‚¬ì˜ ëª…ì˜ˆë¥¼ ê±¸ê³ !", "ë°©íŒ¨ì™€ ê²€ìœ¼ë¡œ!"],
            "taunt": ["ì´ ì •ë„ë¡œ ì „ì‚¬ë¥¼ ì“°ëŸ¬ëœ¨ë¦´ ìˆ˜ ìˆë‹¤ê³ ?", "ì•„ì§ í˜ì´ ë‚¨ì•„ìˆë‹¤!", "ì „ì‚¬ëŠ” ì‰½ê²Œ ë¬´ë„ˆì§€ì§€ ì•ŠëŠ”ë‹¤!"],
            "class_skill": ["ì „ì‚¬ì˜ í˜ì„ ë³´ì—¬ì£¼ê² ë‹¤!", "ê²€ì˜ ê¸¸ì„ ê±·ëŠ” ìì˜ ì‹¤ë ¥!", "ë¬´ë ¥ìœ¼ë¡œ ëŒíŒŒí•œë‹¤!"]
        },
        "ì•„í¬ë©”ì´ì§€": {
            "spell_cast": ["ë§ˆë ¥ì˜ ì§„ë¦¬ì—¬!", "ê³ ëŒ€ì˜ ì§€í˜œì—¬, ë‚˜ì—ê²Œ í˜ì„!", "ë§ˆë²•ì˜ ê¹Šì€ í˜ì„ ë³´ë¼!"],
            "mana_low": ["ë§ˆë ¥ì´... ë¶€ì¡±í•˜ë‹¤.", "ì ì‹œ ë§ˆë ¥ì„ ì¶©ì „í•´ì•¼ê² ë‹¤.", "ë§ˆë‚˜ê°€ ê³ ê°ˆë˜ê³  ìˆë‹¤."],
            "class_skill": ["ì§„ì •í•œ ë§ˆë²•ì˜ í˜ì„ ë³´ì—¬ì£¼ê² ë‹¤!", "ì•„í¬ë©”ì´ì§€ì˜ ì§€í˜œë¡œ!", "ë§ˆë²•ì˜ ì •ìˆ˜ë¥¼ ë‹¤ë£¨ê² ë‹¤!"]
        },
        "ê¶ìˆ˜": {
            "aim": ["ì •í™•íˆ ì¡°ì¤€í•œë‹¤.", "ë°”ëŒì˜ íë¦„ì„ ì½ëŠ”ë‹¤.", "í™”ì‚´ì´ ëª©í‘œë¥¼ ì°¾ì„ ê²ƒì´ë‹¤."],
            "critical_hit": ["ì™„ë²½í•œ ëª…ì¤‘!", "í™”ì‚´ì´ ê¸‰ì†Œë¥¼ ì°¾ì•˜ë‹¤!", "ì´ê²ƒì´ ê¶ìˆ˜ì˜ ì‹¤ë ¥ì´ë‹¤!"],
            "class_skill": ["ê¶ìˆ˜ì˜ ì •ë°€í•¨ì„ ë³´ë¼!", "ë°”ëŒê³¼ í•˜ë‚˜ê°€ ë˜ì–´!", "í™”ì‚´ì˜ ê¸¸ì„ ë”°ë¥´ë¼!"]
        },
        "ë„ì ": {
            "stealth": ["ê·¸ë¦¼ì ì†ìœ¼ë¡œ...", "ì¡°ìš©íˆ... ë“¤í‚¤ì§€ ë§ì.", "ì–´ë‘ ì´ ë‚˜ë¥¼ ìˆ¨ê²¨ì¤€ë‹¤."],
            "backstab": ["ë’¤ì—ì„œ ì‹¤ë¡€!", "ì˜ˆìƒí•˜ì§€ ëª»í–ˆì§€?", "ë„ì ì˜ ê¸°ìˆ ì´ë‹¤!"],
            "class_skill": ["ê·¸ë¦¼ìì˜ ê¸°ìˆ ì„ ë³´ì—¬ì£¼ê² ë‹¤!", "ë„ì ì˜ ë¯¼ì²©í•¨ìœ¼ë¡œ!", "ì€ë°€í•¨ì´ ìµœê³ ì˜ ë¬´ê¸°ë‹¤!"]
        },
        "ì„±ê¸°ì‚¬": {
            "divine_power": ["ì‹ ì„±í•œ ë¹›ì´ì—¬!", "ì •ì˜ì˜ ì´ë¦„ìœ¼ë¡œ!", "ì‹ ì˜ ê°€í˜¸ê°€ í•¨ê»˜í•œë‹¤!"],
            "heal": ["ì¹˜ìœ ì˜ ë¹›ì„ ë°›ì•„ë¼.", "ì‹ ì„±í•œ í˜ìœ¼ë¡œ íšŒë³µí•˜ë¼.", "ë¹›ì´ ìƒì²˜ë¥¼ ì¹˜ìœ í•œë‹¤."],
            "class_skill": ["ì„±ê¸°ì‚¬ì˜ ì‹ ë…ìœ¼ë¡œ!", "ì •ì˜ì˜ í˜ì„ ë³´ë¼!", "ì‹ ì„±í•œ ì˜ë¬´ë¥¼ ë‹¤í•˜ê² ë‹¤!"]
        },
        "í´ë ˆë¦­": {
            "heal": ["ì‹ ì˜ ì€ì´ìœ¼ë¡œ ì¹˜ìœ í•˜ì†Œì„œ.", "ì„±ìŠ¤ëŸ¬ìš´ ë¹›ì´ ìƒì²˜ë¥¼ ê°ì‹¸ë„¤.", "ì¹˜ìœ ì˜ ê¸°ë„ë¥¼ ì˜¬ë¦½ë‹ˆë‹¤."],
            "bless": ["ì¶•ë³µì´ í•¨ê»˜í•˜ê¸¸.", "ì‹ ì´ ë³´í˜¸í•´ì£¼ì‹¤ ê²ƒì…ë‹ˆë‹¤.", "ì„±ìŠ¤ëŸ¬ìš´ ê°€í˜¸ë¥¼ ë°›ìœ¼ì†Œì„œ."],
            "class_skill": ["ì‹ ì˜ ëœ»ì— ë”°ë¼!", "ì„±ìŠ¤ëŸ¬ìš´ í˜ìœ¼ë¡œ!", "ë¯¿ìŒì˜ ê¸°ì ì„ ë³´ì´ê² ë‹¤!"]
        },
        "ë°”ë“œ": {
            "song": ["ì´ ë…¸ë˜ê°€ í˜ì´ ë˜ê¸¸.", "ì„ ìœ¨ì— ë§ˆìŒì„ ë§¡ê²¨ë´.", "ìŒì•…ì´ ìš°ë¦¬ë¥¼ í•˜ë‚˜ë¡œ ë§Œë“ ë‹¤."],
            "inspire": ["ìš©ê¸°ë¥¼ ë¶ë‹ì•„ì£¼ëŠ” ì„ ìœ¨!", "í¬ë§ì˜ ë…¸ë˜ë¥¼ ë“¤ë ¤ì£¼ì§€.", "ë¦¬ë“¬ì— ë§ì¶° í•¨ê»˜í•˜ì!"],
            "class_skill": ["ë°”ë“œì˜ ì„ ìœ¨ë¡œ!", "ìŒì•…ì˜ ë§ˆë²•ì„ ëŠê»´ë´!", "ë…¸ë˜ê°€ ê¸°ì ì„ ë§Œë“ ë‹¤!"]
        },
        "ë“œë£¨ì´ë“œ": {
            "nature": ["ìì—°ì˜ í˜ì„ ë¹Œë¦°ë‹¤.", "ëŒ€ì§€ì˜ ê¸°ìš´ì´ í•¨ê»˜í•œë‹¤.", "ìˆ²ì˜ ì •ë ¹ë“¤ì´ ë„ì™€ì¤€ë‹¤."],
            "transform": ["ìì—°ê³¼ í•˜ë‚˜ê°€ ëœë‹¤.", "ì•¼ìƒì˜ í˜ì„ ë°›ì•„ë“¤ì¸ë‹¤.", "ë³€ì‹ ì˜ ì‹œê°„ì´ë‹¤!"],
            "class_skill": ["ìì—°ì˜ ì„­ë¦¬ë¡œ!", "ëŒ€ì§€ì˜ í˜ì„ ë¹Œë ¤!", "ë“œë£¨ì´ë“œì˜ ì§€í˜œë¡œ!"]
        },
        "ë„¤í¬ë¡œë§¨ì„œ": {
            "dark_magic": ["ì–´ë‘ ì˜ í˜ì´ì—¬...", "ì£½ìŒì˜ ë§ˆë²•ìœ¼ë¡œ...", "ì–¸ë°ë“œì˜ í˜ì„ ë¹Œë¦°ë‹¤."],
            "summon": ["ì£½ì€ ìë“¤ì´ì—¬, ì¼ì–´ë‚˜ë¼!", "ì–´ë‘ ì—ì„œ ì†Œí™˜í•œë‹¤.", "ì–¸ë°ë“œ êµ°ë‹¨ì´ì—¬!"],
            "class_skill": ["ì£½ìŒì˜ ë§ˆë²•ìœ¼ë¡œ!", "ì–´ë‘ ì˜ í˜ì„ ë³´ì—¬ì£¼ê² ë‹¤!", "ë„¤í¬ë¡œë§¨ì„œì˜ ì§„ì •í•œ í˜ì„!"]
        },
        "ì‚¬ë¬´ë¼ì´": {
            "honor": ["ì‚¬ë¬´ë¼ì´ì˜ ëª…ì˜ˆë¥¼ ê±¸ê³ !", "ë¬´ì‚¬ë„ì •ì‹ ìœ¼ë¡œ!", "ê²€ì˜ ë„ë¥¼ ë”°ë¥´ê² ë‹¤!"],
            "katana": ["ê²€ì´ ê¸¸ì„ ë³´ì—¬ì¤€ë‹¤.", "ì¼ê²€í•„ì‚´!", "ì‚¬ë¬´ë¼ì´ì˜ ê²€ë²•ì´ë‹¤!"],
            "class_skill": ["ì‚¬ë¬´ë¼ì´ì˜ í˜¼ìœ¼ë¡œ!", "ê²€ì˜ ë„ë¥¼ ë³´ì—¬ì£¼ê² ë‹¤!", "ë¬´ì‚¬ì˜ ê¸¸ì„ ê±·ëŠ”ë‹¤!"]
        },
        "ëª½í¬": {
            "meditation": ["ë§ˆìŒì„ ë¹„ìš´ë‹¤.", "ë‚´ë©´ì˜ í‰í™”ë¥¼...", "ìˆ˜í–‰ì˜ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ê² ë‹¤."],
            "martial_arts": ["ëª¸ê³¼ ë§ˆìŒì´ í•˜ë‚˜ê°€ ëœë‹¤.", "ë¬´ìˆ ì˜ ì§„ë¦¬ë¥¼ ë³´ë¼!", "ìˆ˜í–‰í•œ ê¸°ìˆ ì´ë‹¤!"],
            "class_skill": ["ëª½í¬ì˜ ìˆ˜í–‰ìœ¼ë¡œ!", "ë‚´ë©´ì˜ í˜ì„ ëŒì–´ë‚¸ë‹¤!", "ë¬´ìˆ ì˜ ë„ë¥¼ ë³´ì—¬ì£¼ê² ë‹¤!"]
        },
        "ê´‘ì „ì‚¬": {
            "rage": ["ë¶„ë…¸ê°€ ì¹˜ì†ŸëŠ”ë‹¤!", "í”¼ê°€ ë“ì–´ì˜¤ë¥¸ë‹¤!", "ê´‘ê¸°ê°€ í˜ì„ ì¤€ë‹¤!"],
            "berserker": ["ëª¨ë“  ê²ƒì„ íŒŒê´´í•˜ê² ë‹¤!", "ë¶„ë…¸ì˜ í˜ìœ¼ë¡œ!", "ê´‘ì „ì‚¬ì˜ ì§„ë…¸ë¥¼ ë³´ë¼!"],
            "class_skill": ["ê´‘ê¸°ì˜ í˜ìœ¼ë¡œ!", "ë¶„ë…¸ê°€ ë‚˜ë¥¼ ì§€ë°°í•œë‹¤!", "ê´‘ì „ì‚¬ì˜ ì§„ì •í•œ ëª¨ìŠµì„!"]
        }
    }
    
    # ìƒí˜¸ ì§ì—…ë³„ íŠ¹ìˆ˜ ëŒ€ì‚¬ (ìºë¦­í„° ê°„ ìƒí˜¸ì‘ìš©)
    INTER_CLASS_DIALOGUE = {
        ("ì „ì‚¬", "ì•„í¬ë©”ì´ì§€"): {
            "ì „ì‚¬": ["ë§ˆë²•ì‚¬ë‹˜, ì œê°€ ì•ì—ì„œ ë§‰ì„ í…Œë‹ˆ ë§ˆë²•ì„ ì¨ì£¼ì„¸ìš”!", "ë§ˆë²•ì˜ í˜ì„ ë¯¿ìŠµë‹ˆë‹¤!", "ë’¤ëŠ” ë¶€íƒë“œë¦½ë‹ˆë‹¤!"],
            "ì•„í¬ë©”ì´ì§€": ["ì „ì‚¬ì—¬, ë°©íŒ¨ë§‰ì´ì— ê°ì‚¬í•˜ë‹¤.", "ê·¸ëŒ€ì˜ ìš©ê¸°ì— ë§ˆë²•ìœ¼ë¡œ ë³´ë‹µí•˜ê² ë‹¤.", "í›Œë¥­í•œ ë°©ì–´ë‹¤!"]
        },
        ("ê¶ìˆ˜", "ë„ì "): {
            "ê¶ìˆ˜": ["ë„ì ë‹˜, ì €ëŠ” ì›ê±°ë¦¬ì—ì„œ ì§€ì›í•˜ê² ìŠµë‹ˆë‹¤!", "ì€ë°€í•œ ì‘ì „, ë©‹ì§€ë„¤ìš”!", "ì •í™•í•œ íƒ€ì´ë°ì´ì—ˆì–´ìš”!"],
            "ë„ì ": ["ê¶ìˆ˜ì˜ ì—„í˜¸ê°€ ìˆì–´ ë§ˆìŒ ë†“ê³  ì ì…í•  ìˆ˜ ìˆì—ˆë‹¤.", "í™”ì‚´ ì‹¤ë ¥ ëŒ€ë‹¨í•˜ë„¤.", "ì™„ë²½í•œ í˜‘ë ¥ì´ì—ˆë‹¤!"]
        },
        ("ì„±ê¸°ì‚¬", "í´ë ˆë¦­"): {
            "ì„±ê¸°ì‚¬": ["í´ë ˆë¦­ë‹˜ì˜ ì¹˜ìœ ì— ê°ì‚¬ë“œë¦½ë‹ˆë‹¤!", "í•¨ê»˜ ì‹ ì˜ ëœ»ì„ ì´ë£¨ì–´ë´…ì‹œë‹¤!", "ì„±ìŠ¤ëŸ¬ìš´ í˜‘ë ¥ì´ë„¤ìš”!"],
            "í´ë ˆë¦­": ["ì„±ê¸°ì‚¬ë‹˜ì˜ ì •ì˜ë¡œìš´ ë§ˆìŒì´ ì•„ë¦„ë‹µìŠµë‹ˆë‹¤.", "í•¨ê»˜ ì„ ì„ í–‰í•©ì‹œë‹¤.", "ì‹ ì´ ê¸°ë»í•˜ì‹¤ ê²ë‹ˆë‹¤."]
        },
        ("ë°”ë“œ", "ë“œë£¨ì´ë“œ"): {
            "ë°”ë“œ": ["ìì—°ì˜ ì„ ìœ¨ê³¼ ì œ ìŒì•…ì´ ì–´ìš°ëŸ¬ì§€ë„¤ìš”!", "ë“œë£¨ì´ë“œë‹˜ì˜ ìì—° ì¹œí™”ë ¥ì´ ë¶€ëŸ½ìŠµë‹ˆë‹¤!", "í•¨ê»˜ ì—°ì£¼í•´ë´ìš”!"],
            "ë“œë£¨ì´ë“œ": ["ë°”ë“œì˜ ë…¸ë˜ê°€ ìì—°ê³¼ ì¡°í™”ë¥¼ ì´ë£¬ë‹¤.", "ìŒì•…ë„ ìì—°ì˜ ì¼ë¶€êµ°.", "ì•„ë¦„ë‹¤ìš´ ì„ ìœ¨ì´ë‹¤."]
        },
        ("ë„¤í¬ë¡œë§¨ì„œ", "ì„±ê¸°ì‚¬"): {
            "ë„¤í¬ë¡œë§¨ì„œ": ["ì„±ê¸°ì‚¬ì—¬... ìš°ë¦¬ëŠ” ë‹¤ë¥¸ ê¸¸ì„ ê±·ì§€ë§Œ.", "ë¹›ê³¼ ì–´ë‘ ì˜ í˜‘ë ¥ì´ë¼ë‹ˆ.", "í¥ë¯¸ë¡œìš´ ì¡°í•©ì´êµ°."],
            "ì„±ê¸°ì‚¬": ["ì–´ë‘ ì˜ í˜ì´ì§€ë§Œ... ê°™ì€ í¸ì´ë‹ˆê¹Œ.", "ì •ì˜ë¥¼ ìœ„í•´ì„œë¼ë©´ í•¨ê»˜ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.", "ë³µì¡í•œ ì‹¬ì •ì´ì§€ë§Œ..."]
        },
        ("ì‚¬ë¬´ë¼ì´", "ëª½í¬"): {
            "ì‚¬ë¬´ë¼ì´": ["ëª½í¬ë‹˜ì˜ ìˆ˜í–‰ì •ì‹ ì„ ì¡´ê²½í•©ë‹ˆë‹¤!", "ë¬´ìˆ ì˜ ë„ì—ì„œëŠ” ê°™ì€ ê¸¸ì„ ê±·ëŠ”êµ°ìš”!", "ìˆ˜í–‰ìì˜ ë§ˆìŒê°€ì§ì´ í›Œë¥­í•©ë‹ˆë‹¤!"],
            "ëª½í¬": ["ì‚¬ë¬´ë¼ì´ì˜ ê²€ì˜ ë„, ê¹Šì´ ëŠê»´ì§‘ë‹ˆë‹¤.", "ë¬´ì‚¬ë„ì •ì‹ ê³¼ ìˆ˜í–‰ì •ì‹ , í†µí•˜ëŠ” ë°”ê°€ ìˆë„¤ìš”.", "ì„œë¡œ ë°°ìš¸ ì ì´ ë§ìŠµë‹ˆë‹¤."]
        },
        ("ê´‘ì „ì‚¬", "ë°”ë“œ"): {
            "ê´‘ì „ì‚¬": ["ë°”ë“œì˜ ë…¸ë˜ê°€... ë§ˆìŒì„ ì§„ì •ì‹œì¼œì£¼ëŠ”êµ°.", "ìŒì•…ì´ ë¶„ë…¸ë¥¼ ë‹¬ë˜ì¤€ë‹¤.", "ê³ ë§ˆìš´ ì„ ìœ¨ì´ë‹¤."],
            "ë°”ë“œ": ["ê´‘ì „ì‚¬ë‹˜ì˜ ì—´ì •ì ì¸ ëª¨ìŠµì—ì„œ ì˜ê°ì„ ë°›ì•˜ì–´ìš”!", "ê·¸ ì—ë„ˆì§€ë¥¼ ë…¸ë˜ë¡œ í‘œí˜„í•´ë³´ê² ì–´ìš”!", "ì—­ë™ì ì¸ ë¦¬ë“¬ì´ ë– ì˜¤ë¥´ë„¤ìš”!"]
        }
    }
    
    # í•„ë“œ ì‚¬ë‹´ (ê¸¸ê°€ë‹¤ê°€ í•˜ëŠ” ëŒ€í™”)
    FIELD_CASUAL_DIALOGUE = {
        CharacterPersonality.CHEERFUL: [
            "ì™€, ì˜¤ëŠ˜ ë‚ ì”¨ ì •ë§ ì¢‹ë‹¤!", "ì €ê¸° ì˜ˆìœ ê½ƒì´ í”¼ì—ˆë„¤!", "ëª¨í—˜í•˜ê¸° ë”± ì¢‹ì€ ë‚ ì”¨ì•¼!",
            "êµ¬ë¦„ì´ ì •ë§ ì˜ˆì˜ê²Œ ìƒê²¼ì–´!", "ë°”ëŒì´ ì‹œì›í•´ì„œ ê¸°ë¶„ ì¢‹ì•„!", "ìƒˆì†Œë¦¬ê°€ ì •ë§ ì•„ë¦„ë‹¤ì›Œ!",
            "ì´ëŸ° í‰í™”ë¡œìš´ ìˆœê°„ì´ ì¢‹ì•„!", "ëª¨ë‘ì™€ í•¨ê»˜ ê±·ëŠ” ê²Œ ì¦ê±°ì›Œ!", "ì˜¤ëŠ˜ì€ ë­”ê°€ ì¢‹ì€ ì¼ì´ ìƒê¸¸ ê²ƒ ê°™ì•„!",
            "ì € ë‚˜ë¬´ ê·¸ëŠ˜ì—ì„œ ì ê¹ ì‰¬ì–´ê°ˆê¹Œ?", "ê¸¸ê°€ì˜ í’ê²½ì´ ì •ë§ ì•„ë¦„ë‹¤ì›Œ!", "í•¨ê»˜ ì—¬í–‰í•˜ë‹ˆê¹Œ ë” ì¬ë°Œì–´!"
        ],
        CharacterPersonality.SERIOUS: [
            "ê¸¸ì´ í—˜í•˜ë‹¤. ì¡°ì‹¬í•˜ì.", "ì£¼ë³€ì„ ê²½ê³„í•´ì•¼ í•œë‹¤.", "ëª©ì ì§€ê¹Œì§€ ì–¼ë§ˆë‚˜ ë‚¨ì•˜ì„ê¹Œ.",
            "ì²´ë ¥ ê´€ë¦¬ì— ì‹ ê²½ì¨ì•¼ê² ë‹¤.", "ì´ ê¸¸ì´ ë§ëŠ” ê±´ê°€?", "íš¨ìœ¨ì ì¸ ë£¨íŠ¸ë¥¼ ì°¾ì•„ë³´ì.",
            "ì‹œê°„ì„ ë‚­ë¹„í•˜ì§€ ë§ì.", "ê³„íšëŒ€ë¡œ ì§„í–‰í•˜ê³  ìˆë‹¤.", "ë‹¤ìŒ ëª©í‘œë¥¼ í™•ì¸í•´ë³´ì.",
            "ì¤€ë¹„ë¬¼ì„ ì ê²€í•´ë³´ì.", "ì•ˆì „í•œ ë£¨íŠ¸ë¥¼ ì„ íƒí•˜ì.", "ì‹ ì¤‘í•˜ê²Œ í–‰ë™í•˜ì."
        ],
        CharacterPersonality.GENTLE: [
            "ëª¨ë‘ í”¼ê³¤í•˜ì§€ ì•Šìœ¼ì„¸ìš”?", "ì²œì²œíˆ ê°€ë„ ê´œì°®ì•„ìš”.", "ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.",
            "ì ê¹ ì‰¬ì–´ê°€ë„ ë ê¹Œìš”?", "ê¸¸ì´ í˜ë“¤ì–´ ë³´ì´ëŠ”ë° ê´œì°®ìœ¼ì„¸ìš”?", "ì„œë¡œ ë„ì™€ê°€ë©° ê°€ìš”.",
            "ì˜ˆìœ í’ê²½ì´ë„¤ìš”.", "í‰í™”ë¡œìš´ ê¸¸ì´ì–´ì„œ ë‹¤í–‰ì´ì—ìš”.", "ëª¨ë‘ ê±´ê°•í•˜ê²Œ ë„ì°©í•˜ê¸¸ ë°”ë¼ìš”.",
            "ì¡°ì‹¬í•´ì„œ ê°€ìš”.", "ì„œë¡œ ê±±ì •í•´ì£¼ë©° ê°€ë©´ ì¢‹ê² ì–´ìš”.", "ì•ˆì „ì´ ìµœìš°ì„ ì´ì—ìš”."
        ],
        CharacterPersonality.COLD: [
            "...", "ë¹¨ë¦¬ ê°€ì.", "ì‹œê°„ ë‚­ë¹„ë‹¤.",
            "...ë³„ë§ ì—†ë‹¤.", "ì¡°ìš©íˆ ê°€ì.", "...ê·¸ëƒ¥ ê°€ì.",
            "ë©ˆì¶”ì§€ ë§ì.", "...ê³„ì†.", "ë§í•  ê²Œ ì—†ë‹¤.",
            "...ì•ìœ¼ë¡œ.", "ì¡°ìš©í•œ ê²Œ ì¢‹ë‹¤.", "...ê·¸ëƒ¥."
        ],
        CharacterPersonality.PLAYFUL: [
            "ì‹¬ì‹¬í•˜ë‹¤~ ë­”ê°€ ì¬ë°ŒëŠ” ê±° ì—†ì„ê¹Œ?", "ì €ê¸° ëŒë©©ì´ë¡œ ê²Œì„í• ê¹Œ?", "ëˆ„ê°€ ë” ë¹¨ë¦¬ ê±¸ì„ ìˆ˜ ìˆë‚˜ ê²½ì£¼í•´ë³¼ê¹Œ?",
            "êµ¬ë¦„ ëª¨ì–‘ ë§ì¶”ê¸° ê²Œì„ ì–´ë•Œ?", "ê¸¸ê°€ì˜ ê½ƒ ê°œìˆ˜ ì„¸ì–´ë³¼ê¹Œ?", "ë°œê±¸ìŒ ë¦¬ë“¬ ë§ì¶°ì„œ ê°€ë³´ì!",
            "ì¬ë°ŒëŠ” ì´ì•¼ê¸° ì—†ë‚˜?", "ê¸¸ì—ì„œ ë­”ê°€ íŠ¹ë³„í•œ ê±° ë°œê²¬í•  ìˆ˜ ìˆì„ê¹Œ?", "ëª¨í—˜ ê°™ì•„ì„œ ì¬ë°Œì–´!",
            "ì € ë‚˜ë¬´ì— ì˜¬ë¼ê°€ë³¼ê¹Œ?", "ê¸¸ ì˜†ì— ë­ê°€ ìˆë‚˜ ì‚´í´ë³´ì!", "ì¬ë°Œê²Œ ê±¸ì–´ê°€ì!"
        ],
        CharacterPersonality.MYSTERIOUS: [
            "ìš´ëª…ì´ ìš°ë¦¬ë¥¼ ì´ëŒê³  ìˆë‹¤.", "ì´ ê¸¸ì˜ ëì— ë¬´ì—‡ì´ ê¸°ë‹¤ë¦¬ê³  ìˆì„ê¹Œ.", "ë³„ë“¤ì´ ì†ì‚­ì´ê³  ìˆë‹¤.",
            "ì˜ˆì •ëœ ê¸¸ì„ ê±·ê³  ìˆë‹¤.", "ìš´ëª…ì˜ ì‹¤ì´ ìš°ë¦¬ë¥¼ ì¸ë„í•œë‹¤.", "ëª¨ë“  ê²ƒì´ ê³„íš ì•ˆì— ìˆë‹¤.",
            "ì–´ë‘ ì´ ê¹Šì–´ì§€ê³  ìˆë‹¤.", "ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´ê°€ ëŒê³  ìˆë‹¤.", "ì˜ˆì–¸ì˜ ì‹œê°„ì´ ë‹¤ê°€ì˜¨ë‹¤.",
            "ìˆ¨ê²¨ì§„ ì§„ì‹¤ì´ ë“œëŸ¬ë‚  ê²ƒì´ë‹¤.", "ìš´ëª…ì„ ê±°ìŠ¤ë¥¼ ìˆ˜ëŠ” ì—†ë‹¤.", "ëª¨ë“  ê²ƒì´ ì—°ê²°ë˜ì–´ ìˆë‹¤."
        ],
        CharacterPersonality.HOT_TEMPERED: [
            "ì–¸ì œê¹Œì§€ ê±¸ì–´ì•¼ í•´?", "ë‹µë‹µí•˜ê²Œ ëŠë ¤!", "ë¹¨ë¦¬ ì¢€ ê°€ì!", 
            "ì‹œê°„ì´ ì•„ê¹Œì›Œ!", "ì´ë ‡ê²Œ ì²œì²œíˆ ê°€ë©´ ì–¸ì œ ë„ì°©í•´?", "ë‹µë‹µí•´ ì£½ê² ë„¤!",
            "ë” ë¹¨ë¦¬ ê°ˆ ìˆ˜ ì—†ë‚˜?", "ì§€ë£¨í•´ì„œ ëª» ê²¬ë””ê² ì–´!", "ë¹¨ë¦¬ë¹¨ë¦¬!",
            "ì‹œê°„ ë‚­ë¹„í•˜ì§€ ë§ì!", "ë‹µë‹µí•œ ì†ë„ë„¤!", "ì¢€ ë” í™œê¸°ì°¨ê²Œ ê°€ì!"
        ],
        CharacterPersonality.WISE: [
            "ì´ ê¸¸ì—ì„œë„ ë°°ìš¸ ì ì´ ìˆêµ°ìš”.", "ì—¬í–‰ ìì²´ê°€ í•˜ë‚˜ì˜ ìˆ˜í–‰ì…ë‹ˆë‹¤.", "ê¸¸ì—ì„œì˜ ê²½í—˜ë„ ì†Œì¤‘í•©ë‹ˆë‹¤.",
            "ìì—°ì—ì„œ ì§€í˜œë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.", "ê±¸ìœ¼ë©° ìƒê°í•  ì‹œê°„ì´ ìˆì–´ ì¢‹ìŠµë‹ˆë‹¤.", "ì—¬í–‰ì´ ë§ˆìŒì„ ë„“í˜€ì¤ë‹ˆë‹¤.",
            "ê¸¸ë™ë¬´ì™€ì˜ ëŒ€í™”ì—ì„œ ê¹¨ë‹¬ìŒì„ ì–»ìŠµë‹ˆë‹¤.", "ì„¸ìƒì„ ë³´ëŠ” ëˆˆì´ ë„“ì–´ì§‘ë‹ˆë‹¤.", "ê²½í—˜ì´ ì§€í˜œê°€ ë©ë‹ˆë‹¤.",
            "ìì—°ì˜ ì„­ë¦¬ë¥¼ ëŠë‚„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.", "ê¸¸ ìœ„ì˜ ëª¨ë“  ê²ƒì´ ìŠ¤ìŠ¹ì…ë‹ˆë‹¤.", "ì—¬í–‰ì„ í†µí•´ ì„±ì¥í•©ë‹ˆë‹¤."
        ],
        CharacterPersonality.BALANCED: [
            "ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”.", "ê¸¸ì´ í‰íƒ„í•´ì„œ ë‹¤í–‰ì´ì—ìš”.", "í•¨ê»˜ ê°€ë‹ˆê¹Œ ë“ ë“ í•´ìš”.",
            "í’ê²½ì´ ì•„ë¦„ë‹¤ì›Œìš”.", "ì ë‹¹íˆ ì‰¬ì–´ê°€ë©´ì„œ í•´ìš”.", "ëª¨ë‘ ê±´ê°•í•˜ê²Œ ê°€ë´ìš”.",
            "ëª©ì ì§€ê¹Œì§€ ì–¼ë§ˆë‚˜ ë‚¨ì•˜ì„ê¹Œìš”?", "ì°¨ê·¼ì°¨ê·¼ ê°€ë´…ì‹œë‹¤.", "ì„œë¡œ ë„ìš°ë©° ê°€ìš”.",
            "ì¢‹ì€ ì—¬í–‰ì´ ë˜ê³  ìˆì–´ìš”.", "í‰í™”ë¡œìš´ ê¸¸ì´ë„¤ìš”.", "í•¨ê»˜í•´ì„œ ì¦ê±°ì›Œìš”."
        ]
    }
    
    # íŒŒí‹°ì› ì „ìš© ì¸ì¹´ìš´í„° ëŒ€ì‚¬
    PARTY_ENCOUNTER_DIALOGUE = {
        "treasure_found": {
            CharacterPersonality.CHEERFUL: ["ì™€! ë³´ë¬¼ì´ë‹¤! ìš°ë¦¬ ìš´ì´ ì •ë§ ì¢‹ë„¤!", "ëŒ€ë°•! ì´ê±° ë‚˜ëˆ ê°€ì§€ì!", "ë³´ë¬¼ ë°œê²¬! ì‹ ë‚˜ëŠ”ë°?"],
            CharacterPersonality.SERIOUS: ["ë³´ë¬¼ì„ ë°œê²¬í–ˆë‹¤. ê³µí‰í•˜ê²Œ ë‚˜ëˆ„ì.", "ê°€ì¹˜ë¥¼ í‰ê°€í•´ë³´ì.", "ì‹ ì¤‘í•˜ê²Œ ë¶„ë°°í•˜ì."],
            CharacterPersonality.GENTLE: ["ë³´ë¬¼ì´ì—ìš”! ëª¨ë‘ í•¨ê»˜ ë‚˜ëˆ ìš”.", "ë‹¤ë“¤ ê¸°ì˜ì…¨ìœ¼ë©´ ì¢‹ê² ì–´ìš”.", "ìš´ì´ ì¢‹ì•˜ë„¤ìš”."],
            CharacterPersonality.COLD: ["ë³´ë¬¼ì´ë‹¤. ë‚˜ëˆ„ì.", "...ì“¸ë§Œí•˜ë‹¤.", "ê°€ì ¸ê°€ì."],
            CharacterPersonality.PLAYFUL: ["ì˜¤! ë³´ë¬¼ì°¾ê¸° ì„±ê³µ!", "ì¬ë°ŒëŠ” ë°œê²¬ì´ë„¤!", "ë³´ë¬¼ íŒŒí‹°ë‹¤!"],
            CharacterPersonality.MYSTERIOUS: ["ìš´ëª…ì´ ìš°ë¦¬ì—ê²Œ ì„ ë¬¼ì„ ì£¼ì—ˆêµ°.", "ì˜ˆì •ëœ ë³´ìƒì´ë‹¤.", "ë³„ë“¤ì˜ ì¶•ë³µì¸ê°€."],
            CharacterPersonality.HOT_TEMPERED: ["ë“œë””ì–´! ê¸°ë‹¤ë¦° ë³´ëŒì´ ìˆë„¤!", "ì´ëŸ° ê²Œ ìˆì–´ì•¼ì§€!", "ë¹¨ë¦¬ ë‚˜ëˆ ê°€ì!"],
            CharacterPersonality.WISE: ["ì¢‹ì€ ë°œê²¬ì…ë‹ˆë‹¤. ì§€í˜œë¡­ê²Œ ì‚¬ìš©í•©ì‹œë‹¤.", "ë³´ë¬¼ë³´ë‹¤ ê²½í—˜ì´ ë” ì†Œì¤‘í•©ë‹ˆë‹¤.", "ë‚˜ëˆ”ì˜ ì§€í˜œë¥¼ ë³´ì…ì‹œë‹¤."],
            CharacterPersonality.BALANCED: ["ë³´ë¬¼ì„ ë°œê²¬í–ˆì–´ìš”!", "ëª¨ë‘ í•¨ê»˜ ë‚˜ëˆ ìš”.", "ì¢‹ì€ ë°œê²¬ì´ë„¤ìš”."]
        },
        "enemy_spotted": {
            CharacterPersonality.CHEERFUL: ["ì ì´ë‹¤! í•˜ì§€ë§Œ ìš°ë¦¬ê°€ ì´ê¸¸ ê±°ì•¼!", "ì „íˆ¬ ì¤€ë¹„! ëª¨ë‘ íŒŒì´íŒ…!", "ê°™ì´ í˜ë‚´ì!"],
            CharacterPersonality.SERIOUS: ["ì ì„ ë°œê²¬í–ˆë‹¤. ì „íˆ¬ ì¤€ë¹„.", "ê³„íšëŒ€ë¡œ ì›€ì§ì´ì.", "ê°ìì˜ ì—­í• ì„ ê¸°ì–µí•˜ì."],
            CharacterPersonality.GENTLE: ["ì¡°ì‹¬í•˜ì„¸ìš”. ë‹¤ì¹˜ì§€ ë§ˆì„¸ìš”.", "ì•ˆì „í•˜ê²Œ ì²˜ë¦¬í•´ìš”.", "ì„œë¡œ ì§€ì¼œì£¼ë©´ì„œ í•´ìš”."],
            CharacterPersonality.COLD: ["ì ì´ë‹¤. ì²˜ë¦¬í•˜ì.", "ë¹ ë¥´ê²Œ ëë‚´ì.", "...ì‹œì‘í•˜ì."],
            CharacterPersonality.PLAYFUL: ["ê²Œì„ ì‹œì‘! ëˆ„ê°€ ë” ì˜í•˜ë‚˜ ë³´ì!", "ì¬ë°Œê² ë‹¤!", "ìŠ¤ë¦´ ìˆëŠ” ì „íˆ¬ë„¤!"],
            CharacterPersonality.MYSTERIOUS: ["ìš´ëª…ì´ ì‹œí—˜í•˜ê³  ìˆë‹¤.", "ì˜ˆì •ëœ ì‹œë ¨ì´êµ°.", "ìš´ëª…ì˜ ìˆœê°„ì´ë‹¤."],
            CharacterPersonality.HOT_TEMPERED: ["ë“œë””ì–´! ê¸°ë‹¤ë ¸ì–´!", "ì‹œì›í•˜ê²Œ í•´ì¹˜ì›Œë²„ë¦¬ì!", "ë¶ˆíƒ€ì˜¤ë¥´ë„¤!"],
            CharacterPersonality.WISE: ["ì‹ ì¤‘í•˜ê²Œ ì ‘ê·¼í•©ì‹œë‹¤.", "ê²½í—˜ì„ ì‚´ë ¤ í–‰ë™í•©ì‹œë‹¤.", "ì§€í˜œë¡­ê²Œ ëŒ€ì²˜í•©ì‹œë‹¤."],
            CharacterPersonality.BALANCED: ["ì ì„ ë°œê²¬í–ˆì–´ìš”.", "ì¡°ì‹¬í•´ì„œ ì²˜ë¦¬í•´ë´…ì‹œë‹¤.", "í•¨ê»˜ ëŒ€ì‘í•´ìš”."],
            CharacterPersonality.MYSTERIOUS: ["ìš´ëª…ì´ ì‹œí—˜í•˜ê³  ìˆë‹¤.", "ì˜ˆì •ëœ ì‹œë ¨ì´êµ°.", "ìš´ëª…ì˜ ìˆœê°„ì´ë‹¤."],
            CharacterPersonality.HOT_TEMPERED: ["ë“œë””ì–´! ê¸°ë‹¤ë ¸ì–´!", "ì‹œì›í•˜ê²Œ í•´ì¹˜ì›Œë²„ë¦¬ì!", "ë¶ˆíƒ€ì˜¤ë¥´ë„¤!"],
            CharacterPersonality.WISE: ["ì‹ ì¤‘í•˜ê²Œ ì ‘ê·¼í•©ì‹œë‹¤.", "ê²½í—˜ì„ ì‚´ë ¤ í–‰ë™í•©ì‹œë‹¤.", "ì§€í˜œë¡­ê²Œ ëŒ€ì²˜í•©ì‹œë‹¤."]
        },
        "rest_time": {
            CharacterPersonality.CHEERFUL: ["íœ´ì‹ ì‹œê°„ì´ë‹¤! ë‹¤ë“¤ ìˆ˜ê³ í–ˆì–´!", "ì ê¹ ì‰¬ë©´ì„œ ì´ì•¼ê¸°í•˜ì!", "ê¸°ë¶„ ì „í™˜í•˜ì!"],
            CharacterPersonality.SERIOUS: ["ì ë‹¹í•œ íœ´ì‹ì´ í•„ìš”í•˜ë‹¤.", "ì²´ë ¥ì„ íšŒë³µí•˜ì.", "ë‹¤ìŒì„ ì¤€ë¹„í•˜ì."],
            CharacterPersonality.GENTLE: ["ëª¨ë‘ í”¼ê³¤í•˜ì…¨ì£ ? í‘¹ ì‰¬ì„¸ìš”.", "í¸íˆ ì‰¬ì…¨ìœ¼ë©´ ì¢‹ê² ì–´ìš”.", "ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”."],
            CharacterPersonality.COLD: ["ì‰¬ì.", "...íœ´ì‹.", "ì ê¹ ë©ˆì¶”ì."],
            CharacterPersonality.PLAYFUL: ["íœ´ì‹ íƒ€ì„! ë­”ê°€ ì¬ë°ŒëŠ” ê±° í•˜ì!", "ì‹¬ì‹¬í•œë° ê²Œì„í• ê¹Œ?", "ì¬ë°Œê²Œ ì‰¬ì–´ë³´ì!"],
            CharacterPersonality.MYSTERIOUS: ["íœ´ì‹ë„ ìš´ëª…ì˜ ì¼ë¶€ë‹¤.", "ì‹œê°„ì˜ íë¦„ì„ ëŠë¼ì.", "ì ì‹œ ì„±ì°°ì˜ ì‹œê°„ì„."],
            CharacterPersonality.HOT_TEMPERED: ["ë“œë””ì–´ ì‰´ ìˆ˜ ìˆë„¤!", "ë¹¨ë¦¬ íšŒë³µí•˜ê³  ê³„ì† ê°€ì!", "ì‰¬ëŠ” ê²ƒë„ ì¢‹ì§€ë§Œ..."],
            CharacterPersonality.WISE: ["íœ´ì‹ì„ í†µí•´ ì¬ì¶©ì „í•©ì‹œë‹¤.", "ì§€ì¹œ ëª¸ê³¼ ë§ˆìŒì„ ë‹¬ë˜ìš”.", "íœ´ì‹ë„ ì§€í˜œì˜ ì¼ë¶€ì…ë‹ˆë‹¤."],
            CharacterPersonality.BALANCED: ["ì ë‹¹íˆ ì‰¬ì–´ê°€ë©´ì„œ í•´ìš”.", "ëª¨ë‘ ìˆ˜ê³ í•˜ì…¨ì–´ìš”.", "ì ê¹ ì‰¬ì—ˆë‹¤ ê°€ë´…ì‹œë‹¤."]
        }
    }
    
    # ìƒí˜¸ ì§ì—…ë³„ íŠ¹ìˆ˜ ëŒ€ì‚¬ ì‹œìŠ¤í…œ
    INTER_CLASS_DIALOGUE = {
        ("ì „ì‚¬", "ì•„í¬ë©”ì´ì§€"): {
            "cooperation": ["ë§ˆë²•ì‚¬ì—¬, ë‚´ê°€ ê¸¸ì„ ì—´ì–´ì£¼ê² ë‹¤!", "ë§ˆë²•ì˜ ì§€ì›ì´ í•„ìš”í•˜ë‹¤.", "ê²€ê³¼ ë§ˆë²•ì˜ ì¡°í•©ì´ë‹¤!"],
            "complement": ["ë„¤ ë§ˆë²•ì´ ì—†ì—ˆë‹¤ë©´ í˜ë“¤ì—ˆì„ ê²ƒì´ë‹¤.", "ë§ˆë²•ì‚¬ì˜ ì§€í˜œì— ê°ì‚¬í•œë‹¤.", "ì¢‹ì€ ì½¤ë¹„ë„¤ì´ì…˜ì´ë‹¤."]
        },
        ("ê¶ìˆ˜", "ì „ì‚¬"): {
            "cooperation": ["ì „ì‚¬ê°€ ì•ì¥ì„œì£¼ë©´ ë‚´ê°€ ë’¤ì—ì„œ ì§€ì›í•˜ê² ë‹¤!", "ê·¼ì ‘ ì „íˆ¬ëŠ” ë§¡ê²¨ë¼.", "ì›ê±°ë¦¬ì—ì„œ ì—„í˜¸í•˜ê² ë‹¤!"],
            "complement": ["ì „ì‚¬ì˜ ìš©ë§¹í•¨ ë•ë¶„ì´ë‹¤.", "ì•ì¥ì„œ ì¤˜ì„œ ê³ ë§™ë‹¤.", "ë“ ë“ í•œ ë°©íŒ¨ ì—­í• ì´ì—ˆë‹¤."]
        },
        ("ì„±ê¸°ì‚¬", "ì•”í‘ê¸°ì‚¬"): {
            "conflict": ["ì–´ë‘ ì˜ ê¸°ì‚¬ì—¬... ê²½ê³„í•˜ê² ë‹¤.", "ë¹›ê³¼ ì–´ë‘ ì´ ë§Œë‚¬êµ°.", "ì„œë¡œ ë‹¤ë¥¸ ê¸¸ì´ì§€ë§Œ..."],
            "respect": ["ì–´ë‘ ì˜ í˜ì´ì§€ë§Œ... ì¸ì •í•œë‹¤.", "ë‹¤ë¥¸ ê¸¸ì´ì§€ë§Œ ì‹¤ë ¥ì€ í™•ì‹¤í•˜ë‹¤.", "ë¹›ê³¼ ì–´ë‘ , ëª¨ë‘ í•„ìš”í•œ í˜ì´ë‹¤."]
        },
        ("ë°”ë“œ", "ëª¨ë“ ì§ì—…"): {
            "encourage": ["ëª¨ë‘ í˜ë‚´ìš”! ì œ ë…¸ë˜ê°€ í˜ì´ ë  ê±°ì˜ˆìš”!", "ìŒì•…ìœ¼ë¡œ ì—¬ëŸ¬ë¶„ì„ ì‘ì›í•˜ê² ìŠµë‹ˆë‹¤!", "ì„ ìœ¨ì— ë§ì¶° í•¨ê»˜ ì‹¸ì›Œìš”!"],
            "support": ["ì œê°€ ë’¤ì—ì„œ ì§€ì›í•˜ê² ìŠµë‹ˆë‹¤!", "ë…¸ë˜ë¡œ ë§ˆìŒì„ ì¹˜ìœ í•´ë“œë¦´ê²Œìš”.", "ìŒì•…ì˜ í˜ì„ ë¯¿ì–´ì£¼ì„¸ìš”!"]
        },
        ("ë“œë£¨ì´ë“œ", "ì •ë ¹ìˆ ì‚¬"): {
            "nature_bond": ["ìì—°ì„ ì‚¬ë‘í•˜ëŠ” ë™ì§€ì—¬!", "ìì—°ì˜ í˜ì„ í•¨ê»˜ ë‚˜ëˆ„ì.", "ëŒ€ì§€ê°€ ìš°ë¦¬ë¥¼ ì¶•ë³µí•˜ê³  ìˆë‹¤."],
            "synergy": ["ìì—°ì˜ ì¡°í™”ê°€ ì™„ë²½í•˜ë‹¤.", "ì •ë ¹ê³¼ ìì—°ì´ í•˜ë‚˜ê°€ ë˜ì—ˆë‹¤.", "ì´ê²ƒì´ ì§„ì •í•œ ìì—°ì˜ í˜ì´ë‹¤!"]
        }
    }

    
    @staticmethod
    def get_gender_from_name(name: str) -> CharacterGender:
        """ì´ë¦„ìœ¼ë¡œ ì„±ë³„ íŒë‹¨"""
        if name in CharacterTraits.MALE_NAMES:
            return CharacterGender.MALE
        elif name in CharacterTraits.FEMALE_NAMES:
            return CharacterGender.FEMALE
        else:
            # ê¸°ë³¸ê°’: ëœë¤
            return random.choice([CharacterGender.MALE, CharacterGender.FEMALE])
    
    @staticmethod
    def get_random_personality() -> CharacterPersonality:
        """ëœë¤ ì„±ê²© ë°˜í™˜"""
        return random.choice(list(CharacterPersonality))
    
    @staticmethod
    def get_dialogue(personality: CharacterPersonality, situation: str) -> str:
        """ì„±ê²©ì— ë”°ë¥¸ ëŒ€í™” ë°˜í™˜"""
        dialogues = CharacterTraits.PERSONALITY_DIALOGUE.get(personality, {})
        situation_dialogues = dialogues.get(situation, ["..."])
        return random.choice(situation_dialogues)

class AIGameMode(Enum):
    """AI ê²Œì„ëª¨ë“œ íƒ€ì…"""
    SINGLE_CONTROL = "single_control"       # 1ëª…ë§Œ ì¡°ì‘, ë‚˜ë¨¸ì§€ AI
    DUAL_CONTROL = "dual_control"           # 2ëª… ì¡°ì‘, ë‚˜ë¨¸ì§€ AI
    MIXED_CONTROL = "mixed_control"         # í˜¼í•© ëª¨ë“œ (ìƒí™©ì— ë”°ë¼ ë³€ê²½)
    FULL_AI_SUPPORT = "full_ai_support"     # ëª¨ë“  AI, í”Œë ˆì´ì–´ëŠ” ì „ëµ ì§€ì‹œë§Œ

class AIGameModeManager:
    """AI ê²Œì„ëª¨ë“œ ê´€ë¦¬ì"""
    
    def __init__(self):
        self.current_mode = AIGameMode.SINGLE_CONTROL
        self.player_controlled_characters = []  # í”Œë ˆì´ì–´ê°€ ì¡°ì‘í•˜ëŠ” ìºë¦­í„°ë“¤
        self.ai_companions = []                 # AIê°€ ì¡°ì‘í•˜ëŠ” ë™ë£Œë“¤
        self.pending_ai_requests = []           # AIì˜ ìš”ì²­/ì œì•ˆ ëª©ë¡
        self.coordination_opportunities = []    # í˜‘ë™ ê³µê²© ê¸°íšŒ
        self.item_sharing_enabled = True       # ì•„ì´í…œ ê³µìœ  í—ˆìš©
        self.ai_mode_active = False             # í´ë˜ì‹ ëª¨ë“œ í™œì„±í™” ìƒíƒœ
        
    def initialize_ai_mode(self, party_members: List[Character], controlled_count: int = 1):
        """í´ë˜ì‹ ëª¨ë“œ ì´ˆê¸°í™”"""
        self.ai_mode_active = True  # í´ë˜ì‹ ëª¨ë“œ í™œì„±í™”
        
        if controlled_count >= len(party_members):
            print("âš ï¸ ëª¨ë“  ìºë¦­í„°ë¥¼ ì§ì ‘ ì¡°ì‘í•©ë‹ˆë‹¤.")
            self.player_controlled_characters = party_members[:]
            self.ai_companions = []
            return
        
        # í”Œë ˆì´ì–´ê°€ ì¡°ì‘í•  ìºë¦­í„° ì„ íƒ
        # ê°œì„ ëœ ìºë¦­í„° ì„ íƒ ì‹œìŠ¤í…œ ì‚¬ìš©
        from game.ai_character_selector import select_player_characters_with_cursor_menu
        self.player_controlled_characters = select_player_characters_with_cursor_menu(party_members, controlled_count)
        
        # ë‚˜ë¨¸ì§€ëŠ” AI ë™ë£Œë¡œ ì„¤ì •
        ai_characters = [char for char in party_members if char not in self.player_controlled_characters]
        self.ai_companions = []
        
        for char in ai_characters:
            personality = self._assign_personality_to_character(char)
            ai_companion = AICompanion(char, personality)
            self.ai_companions.append(ai_companion)
            print(f"ğŸ¤– {char.name}ì„(ë¥¼) AIê°€ ì¡°ì‘í•©ë‹ˆë‹¤ (ì„±ê²©: {personality.value})")
        
        print(f"\nâœ… AI ê²Œì„ëª¨ë“œ í™œì„±í™”!")
        print(f"   í”Œë ˆì´ì–´ ì¡°ì‘: {len(self.player_controlled_characters)}ëª…")
        print(f"   AI ì¡°ì‘: {len(self.ai_companions)}ëª…")
    
    def _select_player_characters(self, party_members: List[Character], count: int) -> List[Character]:
        """í”Œë ˆì´ì–´ê°€ ì¡°ì‘í•  ìºë¦­í„° ì„ íƒ - ê°•ì œ ì‹¤í–‰ ë³´ì¥"""
        print(f"\nğŸ® ì§ì ‘ ì¡°ì‘í•  ìºë¦­í„°ë¥¼ {count}ëª… ì„ íƒí•´ì£¼ì„¸ìš”!")
        print("="*60)
        
        # ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ ê¸°ë°˜ ì„ íƒìœ¼ë¡œ ê°•ì œ ì‹¤í–‰
        selected = []
        remaining_members = list(party_members)
        
        while len(selected) < count and remaining_members:
            print(f"\nï¿½ ì„ íƒ ê°€ëŠ¥í•œ ìºë¦­í„° ëª©ë¡ ({len(selected)+1}/{count}):")
            print("-"*40)
            
            for i, char in enumerate(remaining_members, 1):
                hp_ratio = int((char.current_hp / char.max_hp) * 100) if char.max_hp > 0 else 0
                mp_ratio = int((char.current_mp / char.max_mp) * 100) if char.max_mp > 0 else 0
                print(f"{i}. {char.name} (Lv.{char.level}, {char.character_class})")
                print(f"   HP: {hp_ratio}% | MP: {mp_ratio}% | ê³µê²©: {char.attack} | ë°©ì–´: {char.defense}")
            
            print(f"\nï¿½ íŒíŠ¸: ë‹¤ì–‘í•œ ì—­í• ì˜ ìºë¦­í„°ë¥¼ ì„ íƒí•˜ë©´ ë” ìœ ë¦¬í•©ë‹ˆë‹¤!")
            
            try:
                choice_input = input(f"ìºë¦­í„° ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (1-{len(remaining_members)}): ").strip()
                
                if not choice_input:
                    print("âŒ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                    continue
                
                choice_idx = int(choice_input) - 1
                
                if 0 <= choice_idx < len(remaining_members):
                    selected_char = remaining_members[choice_idx]
                    selected.append(selected_char)
                    remaining_members.remove(selected_char)
                    print(f"âœ… {selected_char.name}ì„(ë¥¼) ì„ íƒí–ˆìŠµë‹ˆë‹¤!")
                    
                    if len(selected) < count:
                        input("ë‹¤ìŒ ìºë¦­í„°ë¥¼ ì„ íƒí•˜ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”...")
                else:
                    print(f"âŒ 1ë¶€í„° {len(remaining_members)} ì‚¬ì´ì˜ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                    
            except ValueError:
                print("âŒ ìœ íš¨í•œ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            except KeyboardInterrupt:
                print("\nâš ï¸ ì„ íƒì„ ì·¨ì†Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìºë¦­í„°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.")
        
        # ì„ íƒì´ ë¶€ì¡±í•œ ê²½ìš° ìë™ìœ¼ë¡œ ì²« ë²ˆì§¸ ìºë¦­í„°ë“¤ ì„ íƒ
        while len(selected) < count and party_members:
            for char in party_members:
                if char not in selected:
                    selected.append(char)
                    print(f"ğŸ¤– {char.name}ì´(ê°€) ìë™ìœ¼ë¡œ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤.")
                    break
            if len(selected) >= count:
                break
        
        print(f"\nğŸ‰ ì„ íƒ ì™„ë£Œ! í”Œë ˆì´ì–´ê°€ ì¡°ì‘í•  ìºë¦­í„°:")
        for i, char in enumerate(selected, 1):
            print(f"  {i}. {char.name} ({char.character_class})")
        
        input("ê³„ì†í•˜ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”...")
        return selected
    
    def _assign_personality_to_character(self, character: Character) -> AIPersonality:
        """ì‹¤ì œ ê²Œì„ ì§ì—… ì‹œìŠ¤í…œì— ë”°ë¥¸ ì„±ê²© í• ë‹¹ (28ê°œ ì§ì—…)"""
        class_personalities = {
            # ë¬¼ë¦¬ ê·¼ì ‘ ê³„ì—´
            "ì „ì‚¬": [AIPersonality.AGGRESSIVE, AIPersonality.DEFENSIVE],
            "ê¸°ì‚¬": [AIPersonality.DEFENSIVE, AIPersonality.SUPPORTIVE],
            "ì„±ê¸°ì‚¬": [AIPersonality.SUPPORTIVE, AIPersonality.DEFENSIVE],
            "ì•”í‘ê¸°ì‚¬": [AIPersonality.AGGRESSIVE, AIPersonality.TACTICAL],
            "ìš©ê¸°ì‚¬": [AIPersonality.AGGRESSIVE, AIPersonality.BALANCED],
            "ê²€ì„±": [AIPersonality.AGGRESSIVE, AIPersonality.TACTICAL],
            "ì‚¬ë¬´ë¼ì´": [AIPersonality.AGGRESSIVE, AIPersonality.BALANCED],
            "ê²€íˆ¬ì‚¬": [AIPersonality.AGGRESSIVE, AIPersonality.DEFENSIVE],
            "ê´‘ì „ì‚¬": [AIPersonality.AGGRESSIVE, AIPersonality.AGGRESSIVE],
            "ëª½í¬": [AIPersonality.BALANCED, AIPersonality.TACTICAL],
            
            # ì›ê±°ë¦¬ ë¬¼ë¦¬ ê³„ì—´
            "ê¶ìˆ˜": [AIPersonality.TACTICAL, AIPersonality.BALANCED],
            "ë„ì ": [AIPersonality.AGGRESSIVE, AIPersonality.TACTICAL],
            "ì•”ì‚´ì": [AIPersonality.AGGRESSIVE, AIPersonality.TACTICAL],
            "í•´ì ": [AIPersonality.AGGRESSIVE, AIPersonality.BALANCED],
            
            # ë§ˆë²• ê³„ì—´
            "ì•„í¬ë©”ì´ì§€": [AIPersonality.TACTICAL, AIPersonality.SUPPORTIVE],
            "ë„¤í¬ë¡œë§¨ì„œ": [AIPersonality.TACTICAL, AIPersonality.AGGRESSIVE],
            "ì •ë ¹ìˆ ì‚¬": [AIPersonality.TACTICAL, AIPersonality.SUPPORTIVE],
            "ì‹œê°„ìˆ ì‚¬": [AIPersonality.TACTICAL, AIPersonality.SUPPORTIVE],
            "ì°¨ì›ìˆ ì‚¬": [AIPersonality.TACTICAL, AIPersonality.AGGRESSIVE],
            "ì—°ê¸ˆìˆ ì‚¬": [AIPersonality.SUPPORTIVE, AIPersonality.BALANCED],
            "ë§ˆê²€ì‚¬": [AIPersonality.BALANCED, AIPersonality.AGGRESSIVE],
            "ê¸°ê³„ê³µí•™ì": [AIPersonality.TACTICAL, AIPersonality.BALANCED],
            
            # ì§€ì› ê³„ì—´
            "ë°”ë“œ": [AIPersonality.SUPPORTIVE, AIPersonality.BALANCED],
            "ì‹ ê´€": [AIPersonality.SUPPORTIVE, AIPersonality.DEFENSIVE],
            "ë“œë£¨ì´ë“œ": [AIPersonality.BALANCED, AIPersonality.SUPPORTIVE],
            "ë¬´ë‹¹": [AIPersonality.SUPPORTIVE, AIPersonality.TACTICAL],
            
            # íŠ¹ìˆ˜ ê³„ì—´
            "ì² í•™ì": [AIPersonality.SUPPORTIVE, AIPersonality.TACTICAL]
        }
        
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        possible_personalities = class_personalities.get(character_class, [AIPersonality.BALANCED])
        return random.choice(possible_personalities)
    
    def process_combat_turn(self, character: Character, party: List[Character], enemies: List[Character]):
        """ì „íˆ¬ í„´ ì²˜ë¦¬ (AI/í”Œë ˆì´ì–´ êµ¬ë¶„)"""
        if character in self.player_controlled_characters:
            # í”Œë ˆì´ì–´ê°€ ì§ì ‘ ì¡°ì‘
            return self._process_player_turn(character, party, enemies)
        else:
            # AIê°€ ìë™ ì¡°ì‘
            return self._process_ai_turn(character, party, enemies)
    
    def _process_player_turn(self, character: Character, party: List[Character], enemies: List[Character]):
        """í”Œë ˆì´ì–´ í„´ ì²˜ë¦¬"""
        print(f"\nğŸ® {character.name}ì˜ í„´ (í”Œë ˆì´ì–´ ì¡°ì‘)")
        
        # AI ìš”ì²­ í™•ì¸
        self._check_ai_requests()
        
        # í˜‘ë™ ê³µê²© ê¸°íšŒ í™•ì¸
        coord_opportunities = self._check_coordination_opportunities(character, party, enemies)
        
        # ê¸°ë³¸ í–‰ë™ ì˜µì…˜ë“¤
        actions = [
            "âš”ï¸ ê³µê²©",
            "âœ¨ ìŠ¤í‚¬ ì‚¬ìš©", 
            "ğŸ§ª ì•„ì´í…œ ì‚¬ìš©",
            "ğŸ›¡ï¸ ë°©ì–´",
            "ğŸ’ ì¥ë¹„ ê´€ë¦¬",
            "ğŸ³ ìš”ë¦¬ ì‚¬ìš©",
            "ğŸŒŸ í•„ë“œìŠ¤í‚¬ ì‚¬ìš©",
            "ğŸ’¾ ì „íˆ¬ ì¤‘ ì €ì¥",
            "ğŸ“Š ìƒíƒœ í™•ì¸"
        ]
        
        # í˜‘ë™ ê³µê²©ì´ ê°€ëŠ¥í•˜ë©´ ì¶”ê°€
        if coord_opportunities:
            actions.append("ğŸ¤ í˜‘ë™ ê³µê²©")
        
        # AI ìš”ì²­ì´ ìˆìœ¼ë©´ ì¶”ê°€
        if self.pending_ai_requests:
            actions.append("ğŸ’¬ AI ìš”ì²­ í™•ì¸")
        
        print("\ní–‰ë™ ì„ íƒ:")
        for i, action in enumerate(actions, 1):
            print(f"{i}. {action}")
        
        try:
            choice = int(input("ì„ íƒ: ")) - 1
            if 0 <= choice < len(actions):
                action = actions[choice]
                return self._execute_player_action(character, action, party, enemies)
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return self._process_player_turn(character, party, enemies)
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return self._process_player_turn(character, party, enemies)
    
    def _process_ai_turn(self, character: Character, party: List[Character], enemies: List[Character]):
        """AI í„´ ì²˜ë¦¬"""
        # í•´ë‹¹ ìºë¦­í„°ì˜ AI ë™ë£Œ ì°¾ê¸°
        ai_companion = next((ai for ai in self.ai_companions if ai.character == character), None)
        
        # AI ë™ë£Œê°€ ì•„ë‹ˆë©´ ì ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŒ - ê¸°ë³¸ ì  AI ì‚¬ìš©
        if not ai_companion:
            # ì  ìºë¦­í„°ì¸ì§€ í™•ì¸
            if character in enemies or getattr(character, 'character_class', '') == 'Enemy':
                print(f"\nğŸ¤– {character.name}ì˜ í„´ (ì  AI)")
                return self._process_enemy_ai_turn(character, party, enemies)
            else:
                # ê·¸ ì™¸ì˜ ê²½ìš° ê¸°ë³¸ ë°©ì–´
                return "defend", {}
        
        print(f"\nğŸ¤– {character.name}ì˜ í„´ (AI ì¡°ì‘)")
        
        # AI í–‰ë™ ê²°ì •
        action_type, action_data = ai_companion.decide_action(party, enemies)
        
        if action_type == "request":
            # AIê°€ í”Œë ˆì´ì–´ì—ê²Œ ìš”ì²­
            request_type = action_data["type"]
            message = ai_companion.make_request_to_player(request_type)
            self.pending_ai_requests.append({
                "companion": ai_companion,
                "type": request_type,
                "message": message,
                "timestamp": time.time()
            })
            print(f"ğŸ’¬ {message}")
            
            # ìš”ì²­ í›„ ê¸°ë³¸ í–‰ë™ ìˆ˜í–‰
            return "defend", {}
        
        # AI í–‰ë™ ì‹¤í–‰
        print(f"   ğŸ’­ AI íŒë‹¨: {self._get_action_description(action_type, action_data)}")
        return action_type, action_data
    
    def _process_enemy_ai_turn(self, character: Character, party: List[Character], enemies: List[Character]):
        """ì  AI í„´ ì²˜ë¦¬ - ê³ ê¸‰ AI ì‹œìŠ¤í…œ ì‚¬ìš©"""
        import random
        
        # ì‚´ì•„ìˆëŠ” ì•„êµ° íƒ€ê²Ÿ ì°¾ê¸°
        alive_party = [char for char in party if char.is_alive]
        if not alive_party:
            return "defend", {}
        
        # ê³ ê¸‰ AI ì‹œìŠ¤í…œ ì‚¬ìš©
        try:
            from game.smart_ai import SmartEnemyAI, AIPersonality
            from game.enemy_system import EnemyType
            
            # ì ì˜ ì„±ê²© ê²°ì • (ìºë¦­í„° í´ë˜ìŠ¤ë‚˜ íƒ€ì…ì— ë”°ë¼)
            character_class = getattr(character, 'character_class', 'ì „ì‚¬')
            enemy_personality = self._determine_enemy_personality(character_class)
            
            # ìŠ¤ë§ˆíŠ¸ AI ìƒì„±
            if not hasattr(character, '_smart_ai'):
                character._smart_ai = SmartEnemyAI(enemy_personality)
            
            smart_ai = character._smart_ai
            
            # ì „ì¥ ìƒíƒœ ì •ë³´
            battlefield_state = {
                'turn_number': getattr(self, 'turn_count', 0),
                'party_formation': self._analyze_party_formation(alive_party),
                'enemy_formation': self._analyze_party_formation([e for e in enemies if e.is_alive])
            }
            
            # AI í–‰ë™ ê²°ì •
            ai_action = smart_ai.choose_action(character, enemies, alive_party, battlefield_state)
            
            action_type = ai_action.get('type', 'attack')
            target = ai_action.get('target')
            skill = ai_action.get('skill')
            reasoning = ai_action.get('expected_outcome', 'ì „ëµì  í–‰ë™')
            
            print(f"   ğŸ§  ê³ ê¸‰ AI íŒë‹¨: {reasoning}")
            
            # í–‰ë™ ì‹¤í–‰
            if action_type == 'brv_attack' and target:
                return "brv_attack", {"target": target}
            elif action_type == 'hp_attack' and target:
                return "hp_attack", {"target": target}
            elif action_type == 'skill' and target:
                # ìŠ¤í‚¬ ì •ë³´ê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ë³¸ ê³µê²©
                if skill:
                    return "skill", {"skill": skill, "target": target}
                else:
                    return "attack", {"target": target}
            elif action_type == 'defend':
                return "defend", {}
            elif action_type == 'heal':
                return "heal", {"target": character}
            else:
                # ê¸°ë³¸ ê³µê²©
                return "attack", {"target": target or alive_party[0]}
                
        except ImportError:
            # ê³ ê¸‰ AIê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ AI ì‚¬ìš©
            return self._basic_enemy_ai_turn(character, party, enemies)
    
    def _determine_enemy_personality(self, character_class: str):
        """ì ì˜ ì„±ê²© ê²°ì • - ì‹¤ì œ ì  ì¢…ë¥˜ ê¸°ë°˜"""
        from game.smart_ai import AIPersonality
        
        # ì‹¤ì œ ì  ì¢…ë¥˜ì— ë”°ë¥¸ ì„±ê²© ë§¤í•‘
        personality_map = {
            # ì¼ë°˜ ëª¬ìŠ¤í„° (1-10ì¸µ) - ë‹¨ìˆœí•˜ê³  ê³µê²©ì 
            'ê³ ë¸”ë¦°': AIPersonality.AGGRESSIVE,
            'ì˜¤í¬': AIPersonality.BERSERKER,
            'ìŠ¤ì¼ˆë ˆí†¤': AIPersonality.DEFENSIVE,
            'ì¢€ë¹„': AIPersonality.BERSERKER,
            'ê±°ë¯¸': AIPersonality.TACTICAL,
            'ì¥': AIPersonality.AGGRESSIVE,
            'ë°•ì¥': AIPersonality.AGGRESSIVE,
            'ëŠ‘ëŒ€': AIPersonality.BERSERKER,
            'ìŠ¬ë¼ì„': AIPersonality.DEFENSIVE,
            'ì„í”„': AIPersonality.TACTICAL,
            
            # ì¤‘ê¸‰ ëª¬ìŠ¤í„° (11-20ì¸µ) - ì „ìˆ ì 
            'ë‹¤í¬ì—˜í”„': AIPersonality.TACTICAL,
            'íŠ¸ë¡¤': AIPersonality.BERSERKER,
            'ì˜¤ê±°': AIPersonality.AGGRESSIVE,
            'í™‰ê³ ë¸”ë¦°': AIPersonality.TACTICAL,
            'ì™€ì´íŠ¸': AIPersonality.TACTICAL,
            'ë ˆì´ìŠ¤': AIPersonality.ADAPTIVE,
            'ê°€ê³ ì¼': AIPersonality.DEFENSIVE,
            'ë¯¸ë…¸íƒ€ìš°ë¡œìŠ¤': AIPersonality.BERSERKER,
            'ì¼„íƒ€ìš°ë¡œìŠ¤': AIPersonality.TACTICAL,
            'í•˜í”¼': AIPersonality.AGGRESSIVE,
            'ë°”ì‹¤ë¦¬ìŠ¤í¬': AIPersonality.TACTICAL,
            
            # ê³ ê¸‰ ëª¬ìŠ¤í„° (21-30ì¸µ) - ì§€ëŠ¥ì 
            'ë“œë ˆì´í¬': AIPersonality.AGGRESSIVE,
            'í‚¤ë©”ë¼': AIPersonality.ADAPTIVE,
            'ë§Œí‹°ì½”ì–´': AIPersonality.BERSERKER,
            'ê·¸ë¦¬í°': AIPersonality.TACTICAL,
            'ì™€ì´ë²ˆ': AIPersonality.AGGRESSIVE,
            'ë¦¬ì¹˜': AIPersonality.TACTICAL,
            'ë±€íŒŒì´ì–´': AIPersonality.ADAPTIVE,
            'ë°ëª¬': AIPersonality.AGGRESSIVE,
            'ë°ë¹Œ': AIPersonality.TACTICAL,
            'ì—˜ë¦¬ë©˜íƒˆ': AIPersonality.ADAPTIVE,
            
            # ìµœê³ ê¸‰ ëª¬ìŠ¤í„° (31-40ì¸µ) - ë§¤ìš° ì§€ëŠ¥ì 
            'ë“œë˜ê³¤': AIPersonality.TACTICAL,
            'ì•„ì¹˜ë¦¬ì¹˜': AIPersonality.ADAPTIVE,
            'ë°œë¡œê·¸': AIPersonality.BERSERKER,
            'ì„œíë²„ìŠ¤': AIPersonality.ADAPTIVE,
            'ì¸íë²„ìŠ¤': AIPersonality.ADAPTIVE,
            'ê³ ëŒ€ê³¨ë ˜': AIPersonality.DEFENSIVE,
            'í¬ë¼ì¼„': AIPersonality.BERSERKER,
            'ë² íˆëª¨ìŠ¤': AIPersonality.AGGRESSIVE,
            'ë¦¬ë°”ì´ì–´ë˜': AIPersonality.TACTICAL,
            'í”¼ë‹‰ìŠ¤': AIPersonality.ADAPTIVE,
            
            # ì „ì„¤ê¸‰ ëª¬ìŠ¤í„° (41-50ì¸µ) - ìµœê³  ì§€ëŠ¥
            'ì—˜ë”ë“œë˜ê³¤': AIPersonality.TACTICAL,
            'íƒ€ì´íƒ„': AIPersonality.AGGRESSIVE,
            'ì²œê³„ì¸': AIPersonality.DEFENSIVE,
            'íƒ€ë½ì²œì‚¬': AIPersonality.ADAPTIVE,
            'ê³µí—ˆêµ°ì£¼': AIPersonality.TACTICAL,
            'ê·¸ë¦¼ìì™•': AIPersonality.ADAPTIVE,
            'ì£½ìŒêµ°ì£¼': AIPersonality.TACTICAL,
            'í˜¼ëˆì•¼ìˆ˜': AIPersonality.BERSERKER,
            'ë‚˜ì´íŠ¸ë©”ì–´': AIPersonality.ADAPTIVE,
            'ì•„ë°”íƒ€': AIPersonality.TACTICAL,
            
            # ì •ë ¹ ê³„ì—´ - ì›ì†Œì— ë”°ë¥¸ ì„±ê²©
            'í™”ì—¼ë„ë¡±ë‡½': AIPersonality.AGGRESSIVE,
            'ì–¼ìŒê³¨ë ˜': AIPersonality.DEFENSIVE,
            'í­í’ìƒˆ': AIPersonality.TACTICAL,
            'ëŒ€ì§€ì •ë ¹': AIPersonality.DEFENSIVE,
            'ë°”ëŒì •ë ¹': AIPersonality.ADAPTIVE,
            'ë¬¼ë‹˜í”„': AIPersonality.SUPPORT,
            'ë¹›ì„¸ë¼í•Œ': AIPersonality.DEFENSIVE,
            'ì–´ë‘ ê·¸ë¦¼ì': AIPersonality.TACTICAL,
            'ë…íˆë“œë¼': AIPersonality.BERSERKER,
            'ìˆ˜ì •ê³¨ë ˜': AIPersonality.DEFENSIVE,
            
            # íŠ¹ìˆ˜ ëª¬ìŠ¤í„°ë“¤
            'ì² ê¸°ì‚¬': AIPersonality.DEFENSIVE,
            'ë¼ˆë“œë˜ê³¤': AIPersonality.AGGRESSIVE,
            'ìœ ë ¹ê¸°ì‚¬': AIPersonality.TACTICAL,
            'í™”ì—¼ì•…ë§ˆ': AIPersonality.BERSERKER,
            'ì„œë¦¬ê±°ì¸': AIPersonality.AGGRESSIVE,
            'ì²œë‘¥ë…ìˆ˜ë¦¬': AIPersonality.TACTICAL,
            'ë°”ìœ„ê±°ì¸': AIPersonality.DEFENSIVE,
            'ë°”ëŒì§€ë‹ˆ': AIPersonality.ADAPTIVE,
            'ë¬¼ë“œë˜ê³¤': AIPersonality.TACTICAL,
            'ê·¸ë¦¼ìì•”ì‚´ì': AIPersonality.TACTICAL,
            
            # ê³ ìœ„ ì¡´ì¬ë“¤
            'ê³µí—ˆì¶”ì ì': AIPersonality.ADAPTIVE,
            'í˜¼ëˆìƒˆë¼': AIPersonality.BERSERKER,
            'ê¿ˆë¨¹ëŠ”ì': AIPersonality.TACTICAL,
            'ì˜í˜¼ìˆ˜í™•ì': AIPersonality.AGGRESSIVE,
            'ì •ì‹ ì§€ë°°ì': AIPersonality.TACTICAL,
            'ì‹œê°„ë§ë ¹': AIPersonality.ADAPTIVE,
            'ê³µê°„ê³µí¬': AIPersonality.TACTICAL,
            'í˜„ì‹¤ì™œê³¡ì': AIPersonality.ADAPTIVE,
            'ì°¨ì›ë§ˆê·€': AIPersonality.TACTICAL,
            'ì˜ì›ìˆ˜í˜¸ì': AIPersonality.DEFENSIVE,
            
            # ìµœì¢… ë³´ìŠ¤ê¸‰
            'ìš°ì£¼ê³µí¬': AIPersonality.ADAPTIVE,
            'íƒœê³ ì•¼ìˆ˜': AIPersonality.BERSERKER,
            'ê³ ëŒ€ì•…': AIPersonality.TACTICAL,
            'ìŠí˜€ì§„ì‹ ': AIPersonality.ADAPTIVE,
            'ì‹¬ì—°êµ°ì£¼': AIPersonality.TACTICAL,
            'ì§€ì˜¥ê³µì‘': AIPersonality.AGGRESSIVE,
            'ì²œê³„ê²½ë¹„ë³‘': AIPersonality.DEFENSIVE,
            'ê³µí—ˆí™©ì œ': AIPersonality.TACTICAL,
            'ê·¸ë¦¼ìì—¬ì œ': AIPersonality.ADAPTIVE,
            'í˜¼ëˆëŒ€êµ°ì£¼': AIPersonality.BERSERKER,
            'ì£½ìŒí™”ì‹ ': AIPersonality.TACTICAL,
            'íŒŒê´´ì': AIPersonality.BERSERKER,
            'ì°½ì¡°ì': AIPersonality.ADAPTIVE,
            'ê´€ì°°ì': AIPersonality.TACTICAL,
            'ì‹¬íŒì': AIPersonality.DEFENSIVE,
            'ì²˜í˜•ì': AIPersonality.AGGRESSIVE,
            'ì „ë ¹': AIPersonality.SUPPORT,
            'ì˜ˆì–¸ì': AIPersonality.TACTICAL,
            'ì‹ íƒ': AIPersonality.ADAPTIVE,
            'í˜„ì': AIPersonality.TACTICAL,
            'ê´‘ì¸': AIPersonality.BERSERKER,
            'ë°©ë‘ì': AIPersonality.ADAPTIVE,
            'íƒêµ¬ì': AIPersonality.TACTICAL,
            'ìˆ˜í˜¸ì': AIPersonality.DEFENSIVE,
            'ì„¸ê³„íŒŒê´´ì': AIPersonality.BERSERKER,
            

            
            # ê¸°ë³¸ ì ë“¤
            'Enemy': AIPersonality.AGGRESSIVE,
        }
        
        return personality_map.get(character_class, AIPersonality.AGGRESSIVE)
    
    def _analyze_party_formation(self, party: List[Character]) -> Dict:
        """íŒŒí‹° êµ¬ì„± ë¶„ì„"""
        if not party:
            return {}
        
        total_hp = sum(char.current_hp for char in party)
        max_total_hp = sum(char.max_hp for char in party)
        avg_hp_ratio = total_hp / max_total_hp if max_total_hp > 0 else 0
        
        # ì§ì—… ë¶„í¬
        classes = [getattr(char, 'character_class', 'ì „ì‚¬') for char in party]
        class_count = {}
        for cls in classes:
            class_count[cls] = class_count.get(cls, 0) + 1
        
        return {
            'size': len(party),
            'avg_hp_ratio': avg_hp_ratio,
            'class_distribution': class_count,
            'frontline_count': len([c for c in party if getattr(c, 'character_class', '') in ['ì „ì‚¬', 'ì„±ê¸°ì‚¬', 'ê¸°ì‚¬', 'ëª½í¬']]),
            'backline_count': len([c for c in party if getattr(c, 'character_class', '') in ['ë§ˆë²•ì‚¬', 'ê¶ìˆ˜', 'ë°”ë“œ', 'ì‹ ê´€']])
        }
    
    def _basic_enemy_ai_turn(self, character: Character, party: List[Character], enemies: List[Character]):
        """ê¸°ë³¸ ì  AI (í´ë°±)"""
        import random
        
        alive_party = [char for char in party if char.is_alive]
        if not alive_party:
            return "defend", {}
        
        # ê¸°ë³¸ AI í–‰ë™ íŒ¨í„´ (ì´ì „ ë¡œì§)
        action_chance = random.random()
        
        if action_chance < 0.7:
            # ê³µê²© - ê°€ì¥ HPê°€ ë‚®ì€ íƒ€ê²Ÿì„ ìš°ì„  ê³µê²©
            target = min(alive_party, key=lambda x: x.current_hp / x.max_hp)
            print(f"   ğŸ’­ ê¸°ë³¸ AI íŒë‹¨: {target.name}ì„(ë¥¼) ê³µê²©!")
            return "attack", {"target": target}
            
        elif action_chance < 0.9:
            # ìŠ¤í‚¬ ì‚¬ìš© ì‹œë„
            try:
                from game.new_skill_system import SkillDatabase
                skill_db = SkillDatabase()
                character_class = getattr(character, 'character_class', 'ì „ì‚¬')
                skills = skill_db.get_skills(character_class)
                
                if skills:
                    # MPê°€ ì¶©ë¶„í•œ ìŠ¤í‚¬ ì¤‘ì—ì„œ ì„ íƒ
                    usable_skills = [s for s in skills if s.get('mp_cost', 0) <= character.current_mp]
                    if usable_skills:
                        skill = random.choice(usable_skills)
                        target = random.choice(alive_party)
                        print(f"   ğŸ’­ ê¸°ë³¸ AI íŒë‹¨: {skill.get('name', 'ìŠ¤í‚¬')}ì„(ë¥¼) ì‚¬ìš©!")
                        return "skill", {"skill": skill, "target": target}
            except:
                pass
            
            # ìŠ¤í‚¬ ì‚¬ìš© ì‹¤íŒ¨ì‹œ ê³µê²©
            target = random.choice(alive_party)
            return "attack", {"target": target}
        else:
            # ë°©ì–´
            print(f"   ğŸ’­ ê¸°ë³¸ AI íŒë‹¨: ë°©ì–´ ìì„¸!")
            return "defend", {}
    
    def _check_ai_requests(self):
        """AI ìš”ì²­ í™•ì¸ ë° í‘œì‹œ"""
        if not self.pending_ai_requests:
            return
        
        print(f"\nğŸ’¬ AI ë™ë£Œë“¤ì˜ ìš”ì²­ì´ {len(self.pending_ai_requests)}ê°œ ìˆìŠµë‹ˆë‹¤:")
        for i, request in enumerate(self.pending_ai_requests):
            print(f"   {i+1}. {request['message']}")
    
    def _check_coordination_opportunities(self, character: Character, party: List[Character], enemies: List[Character]) -> List[Dict]:
        """í˜‘ë™ ê³µê²© ê¸°íšŒ í™•ì¸"""
        opportunities = []
        
        for ai_companion in self.ai_companions:
            if not ai_companion.character.is_alive:
                continue
            
            # AIê°€ í˜‘ë™ ê³µê²©ì„ ì¤€ë¹„ ì¤‘ì¸ì§€ í™•ì¸
            if ai_companion.coordinated_attack_ready:
                opportunities.append({
                    "partner": ai_companion.character,
                    "type": "coordinated_attack",
                    "description": f"{ai_companion.character.name}ê³¼(ì™€) í˜‘ë™ ê³µê²© ê°€ëŠ¥"
                })
        
        return opportunities
    
    def _execute_player_action(self, character: Character, action: str, party: List[Character], enemies: List[Character]):
        """í”Œë ˆì´ì–´ í–‰ë™ ì‹¤í–‰"""
        if action == "ğŸ¤ í˜‘ë™ ê³µê²©":
            return self._execute_coordination_attack(character, party, enemies)
        elif action == "ğŸ’¬ AI ìš”ì²­ í™•ì¸":
            return self._handle_ai_requests()
        elif action == "âš”ï¸ ê³µê²©":
            return "attack", {}
        elif action == "âœ¨ ìŠ¤í‚¬ ì‚¬ìš©":
            return self._select_and_use_skill(character, party, enemies)
        elif action == "ğŸ§ª ì•„ì´í…œ ì‚¬ìš©":
            return self._select_and_use_item(character, party)
        elif action == "ğŸ›¡ï¸ ë°©ì–´":
            return "defend", {}
        elif action == "ğŸ“Š ìƒíƒœ í™•ì¸":
            self._show_party_status(party)
            return self._process_player_turn(character, party, enemies)
        else:
            return "defend", {}
    
    def _select_and_use_skill(self, character: Character, party: List[Character], enemies: List[Character]):
        """ìŠ¤í‚¬ ì„ íƒ ë° ì‚¬ìš©"""
        from game.new_skill_system import get_class_skills
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        skills = get_class_skills(character_class)
        
        if not skills:
            print(f"âŒ {character.name}ì€(ëŠ”) ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤í‚¬ì´ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
        
        # ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¤í‚¬ í•„í„°ë§ (MP ì¶©ë¶„í•œ ê²ƒë§Œ)
        usable_skills = [skill for skill in skills if skill.get("mp_cost", 0) <= character.current_mp]
        
        if not usable_skills:
            print(f"âŒ MPê°€ ë¶€ì¡±í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤í‚¬ì´ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
        
        print(f"\nâœ¨ {character.name}ì˜ ìŠ¤í‚¬ ëª©ë¡ (MP: {character.current_mp}/{character.max_mp}):")
        for i, skill in enumerate(usable_skills, 1):
            mp_cost = skill.get("mp_cost", 0)
            skill_name = skill.get("name", "ì•Œ ìˆ˜ ì—†ëŠ” ìŠ¤í‚¬")
            skill_desc = skill.get("description", "ì„¤ëª… ì—†ìŒ")
            print(f"{i}. {skill_name} (MP {mp_cost}) - {skill_desc}")
        
        try:
            choice = int(input("ì‚¬ìš©í•  ìŠ¤í‚¬ ì„ íƒ (0: ì·¨ì†Œ): ")) - 1
            if choice == -1:
                return self._process_player_turn(character, party, enemies)
            elif 0 <= choice < len(usable_skills):
                selected_skill = usable_skills[choice]
                
                # ëŒ€ìƒ ì„ íƒ
                target = self._select_skill_target(selected_skill, character, party, enemies)
                if target:
                    return "skill", {
                        "skill": selected_skill,
                        "target": target,
                        "mp_cost": selected_skill.get("mp_cost", 0)
                    }
                else:
                    return self._process_player_turn(character, party, enemies)
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return self._process_player_turn(character, party, enemies)
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return self._process_player_turn(character, party, enemies)
    
    def _select_and_use_item(self, character: Character, party: List[Character]):
        """ì•„ì´í…œ ì„ íƒ ë° ì‚¬ìš©"""
        if not hasattr(character, 'inventory') or not character.inventory:
            print(f"âŒ {character.name}ì€(ëŠ”) ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
        
        # ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´í…œ ëª©ë¡
        consumable_items = []
        for item_name, quantity in character.inventory.get_items_list():
            if quantity > 0:
                # ì†Œëª¨í’ˆì¸ì§€ í™•ì¸
                from game.items import ItemDatabase, ItemType
                item_db = ItemDatabase()
                item = item_db.get_item(item_name)
                if item and item.item_type == ItemType.CONSUMABLE:
                    consumable_items.append((item, quantity))
        
        if not consumable_items:
            print(f"âŒ {character.name}ì€(ëŠ”) ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì†Œëª¨í’ˆì´ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
        
        print(f"\nğŸ§ª {character.name}ì˜ ì•„ì´í…œ ëª©ë¡:")
        for i, (item, quantity) in enumerate(consumable_items, 1):
            print(f"{i}. {item.name} x{quantity} - {item.description}")
        
        try:
            choice = int(input("ì‚¬ìš©í•  ì•„ì´í…œ ì„ íƒ (0: ì·¨ì†Œ): ")) - 1
            if choice == -1:
                return self._process_player_turn(character, party, [])
            elif 0 <= choice < len(consumable_items):
                selected_item, _ = consumable_items[choice]
                
                # ëŒ€ìƒ ì„ íƒ
                target = self._select_item_target(selected_item, character, party)
                if target:
                    return "use_item", {
                        "item": selected_item,
                        "target": target
                    }
                else:
                    return self._process_player_turn(character, party, [])
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return self._process_player_turn(character, party, [])
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return self._process_player_turn(character, party, [])
    
    def _select_skill_target(self, skill, caster, party: List[Character], enemies: List[Character]):
        """ìŠ¤í‚¬ ëŒ€ìƒ ì„ íƒ"""
        skill_type = skill.get("type", "BRV_ATTACK")
        
        if skill_type in ["BRV_ATTACK", "HP_ATTACK", "BRV_HP_ATTACK"]:
            # ì  ëŒ€ìƒ ìŠ¤í‚¬
            alive_enemies = [e for e in enemies if e.is_alive]
            if not alive_enemies:
                print("âŒ ê³µê²©í•  ëŒ€ìƒì´ ì—†ìŠµë‹ˆë‹¤.")
                return None
                
            if len(alive_enemies) == 1:
                return alive_enemies[0]
            
            print("\nğŸ¯ ê³µê²© ëŒ€ìƒ ì„ íƒ:")
            for i, enemy in enumerate(alive_enemies, 1):
                print(f"{i}. {enemy.name} (HP: {enemy.current_hp}/{enemy.max_hp})")
            
            try:
                choice = int(input("ëŒ€ìƒ ì„ íƒ: ")) - 1
                if 0 <= choice < len(alive_enemies):
                    return alive_enemies[choice]
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return None
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return None
                
        else:
            # ì•„êµ° ëŒ€ìƒ ìŠ¤í‚¬ (íë§, ë²„í”„ ë“±)
            alive_allies = [ally for ally in party if ally.is_alive]
            if not alive_allies:
                return None
                
            if len(alive_allies) == 1:
                return alive_allies[0]
            
            print("\nğŸ’š ëŒ€ìƒ ì„ íƒ:")
            for i, ally in enumerate(alive_allies, 1):
                print(f"{i}. {ally.name} (HP: {ally.current_hp}/{ally.max_hp})")
            
            try:
                choice = int(input("ëŒ€ìƒ ì„ íƒ: ")) - 1
                if 0 <= choice < len(alive_allies):
                    return alive_allies[choice]
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return None
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return None
    
    def _select_item_target(self, item, user, party: List[Character]):
        """ì•„ì´í…œ ëŒ€ìƒ ì„ íƒ"""
        # ëŒ€ë¶€ë¶„ì˜ ì†Œëª¨í’ˆì€ ì•„êµ° ëŒ€ìƒ
        alive_allies = [ally for ally in party if ally.is_alive]
        if not alive_allies:
            return None
            
        if len(alive_allies) == 1:
            return alive_allies[0]
        
        print(f"\nğŸ¯ {item.name} ì‚¬ìš© ëŒ€ìƒ ì„ íƒ:")
        for i, ally in enumerate(alive_allies, 1):
            print(f"{i}. {ally.name} (HP: {ally.current_hp}/{ally.max_hp}, MP: {ally.current_mp}/{ally.max_mp})")
        
        try:
            choice = int(input("ëŒ€ìƒ ì„ íƒ: ")) - 1
            if 0 <= choice < len(alive_allies):
                return alive_allies[choice]
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return None
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return None
    
    def _execute_coordination_attack(self, character: Character, party: List[Character], enemies: List[Character]):
        """í˜‘ë™ ê³µê²© ì‹¤í–‰"""
        ready_partners = [ai for ai in self.ai_companions 
                         if ai.coordinated_attack_ready and ai.character.is_alive]
        
        if not ready_partners:
            print("âŒ í˜‘ë™ ê³µê²©í•  ë™ë£Œê°€ ì—†ìŠµë‹ˆë‹¤.")
            return "attack", {}
        
        # íŒŒíŠ¸ë„ˆ ì„ íƒ
        if len(ready_partners) == 1:
            partner = ready_partners[0]
        else:
            print("í˜‘ë™ ê³µê²© íŒŒíŠ¸ë„ˆ ì„ íƒ:")
            for i, ai in enumerate(ready_partners, 1):
                print(f"{i}. {ai.character.name}")
            
            try:
                choice = int(input("ì„ íƒ: ")) - 1
                if 0 <= choice < len(ready_partners):
                    partner = ready_partners[choice]
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return "attack", {}
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return "attack", {}
        
        # í˜‘ë™ ê³µê²© ê°œì‹œ ëŒ€ì‚¬ (ì„±ê²©ë³„)
        character_personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
        partner_personality = getattr(partner.character, 'personality', CharacterPersonality.BALANCED)
        
        # í˜‘ë™ê³µê²© ì‹œì‘ ëŒ€ì‚¬ (ì„±ê²©ë³„ ëŒ€í­ í™•ì¥)
        coordination_start_dialogues = {
            CharacterPersonality.CHEERFUL: [
                f"{partner.character.name}! ê°™ì´ í˜ë‚´ì!", 
                f"ìš°ë¦¬ í˜¸í¡ ë§ì¶°ì„œ ê°€ë³´ì!", 
                f"{partner.character.name}ê³¼ í•¨ê»˜ë¼ë©´ ë¬´ì„­ì§€ ì•Šì•„!",
                f"ì•¼í˜¸! {partner.character.name}ê³¼ ì½¤ë³´ ì‹œê°„ì´ì•¼!",
                f"ìš°ë¦¬ ë‘˜ì´ë©´ ë­ë“  í•  ìˆ˜ ìˆì–´!",
                f"{partner.character.name}, ì‹ ë‚˜ëŠ” í˜‘ë™ ê³µê²© í•´ë³´ì!",
                f"í•¨ê»˜ë¼ë©´ ë” ê°•í•´ì ¸!",
                f"ìš°ë¦¬ì˜ íŒŒì›Œë¥¼ í•©ì³ë³´ì!",
                f"{partner.character.name}! ì™„ë²½í•œ íŒ€ì›Œí¬ë¥¼ ë³´ì—¬ì¤˜!",
                f"ë‘˜ì´ í˜ì„ í•©ì¹˜ë©´ ìµœê°•ì´ì•¼!"
            ],
            CharacterPersonality.SERIOUS: [
                f"{partner.character.name}, ê³„íšëŒ€ë¡œ ì›€ì§ì´ì.", 
                f"í˜‘ë™ ê³µê²© ê°œì‹œí•œë‹¤.", 
                f"{partner.character.name}, ì‹ í˜¸ì— ë§ì¶°ì„œ.",
                f"ì „ìˆ ì  í˜‘ë ¥ì„ ì‹œì‘í•œë‹¤.",
                f"{partner.character.name}, ì •í™•í•œ íƒ€ì´ë°ìœ¼ë¡œ.",
                f"ê³„ì‚°ëœ í˜‘ë™ ê³µê²©ì´ë‹¤.",
                f"íš¨ìœ¨ì ì¸ í˜‘ë ¥ì´ í•„ìš”í•˜ë‹¤.",
                f"{partner.character.name}, í”„ë¡œí˜ì…”ë„í•˜ê²Œ ê°€ì.",
                f"ì™„ë²½í•œ ì‹¤í–‰ì„ ìœ„í•´ í˜‘ë ¥í•˜ì.",
                f"ì „ëµì  íŒŒíŠ¸ë„ˆì‹­ì„ ë°œíœ˜í•˜ì."
            ],
            CharacterPersonality.GENTLE: [
                f"{partner.character.name}ë‹˜, í•¨ê»˜í•´ìš”.", 
                f"ì„œë¡œ ë„ìš°ë©° ê°€ìš”.", 
                f"{partner.character.name}ë‹˜ê³¼ í•¨ê»˜ë¼ë©´ ì•ˆì‹¬ì´ì—ìš”.",
                f"ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ í•¨ê»˜ í•´ë´ìš”.",
                f"{partner.character.name}ë‹˜, ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.",
                f"ì„œë¡œ ì§€ì¼œì£¼ë©´ì„œ í•´ìš”.",
                f"ì•ˆì „í•˜ê²Œ í˜‘ë ¥í•´ë´ìš”.",
                f"{partner.character.name}ë‹˜ì˜ ë„ì›€ì´ í•„ìš”í•´ìš”.",
                f"í•¨ê»˜í•˜ë©´ ë” ì•ˆì „í•  ê±°ì˜ˆìš”.",
                f"ì„œë¡œë¥¼ ë¯¿ê³  ê°€ë´ìš”."
            ],
            CharacterPersonality.COLD: [
                f"{partner.character.name}... ë”°ë¼ì™€.", 
                f"í˜‘ë™ ê³µê²©.", 
                f"...ì‹œì‘í•˜ì.",
                f"{partner.character.name}... í•„ìš”í•˜ë‹¤.",
                f"...í•¨ê»˜.",
                f"íš¨ìœ¨ì ì´ë‹¤.",
                f"{partner.character.name}... ì›€ì§ì—¬.",
                f"...í˜‘ë ¥.",
                f"ì‹œê°„ì´ë‹¤.",
                f"...ê°€ì."
            ],
            CharacterPersonality.PLAYFUL: [
                f"{partner.character.name}! ì¬ë°ŒëŠ” ì½¤ë³´ ë³´ì—¬ì£¼ì!", 
                f"í˜‘ë™ ê³µê²© ê²Œì„ ì‹œì‘!", 
                f"ìš°ë¦¬ í•©ë™ ê³µì—° ì–´ë•Œ?",
                f"ì¬ë°ŒëŠ” ë†€ì´ ì‹œê°„ì´ì•¼!",
                f"{partner.character.name}ê³¼ í•¨ê»˜í•˜ëŠ” ìŠ¤í™í„°í´!",
                f"ë‘˜ì´ì„œ ë©‹ì§„ ì‡¼ë¥¼ í•´ë³´ì!",
                f"ì™„ì „ ì¿¨í•œ í˜‘ë™ ê³µê²©!",
                f"ê²Œì„ì²˜ëŸ¼ ì¬ë°Œê²Œ í•´ë³´ì!",
                f"{partner.character.name}! ìš°ë¦¬ë§Œì˜ í•„ì‚´ê¸°!",
                f"ì‹ ë‚˜ëŠ” ì½¤ë³´ í”Œë ˆì´!"
            ],
            CharacterPersonality.MYSTERIOUS: [
                f"ìš´ëª…ì´ ìš°ë¦¬ë¥¼ í•˜ë‚˜ë¡œ ë§Œë“¤ì—ˆë‹¤, {partner.character.name}.", 
                f"ì˜ˆì •ëœ í˜‘ë ¥ì´êµ°.", 
                f"ë³„ë“¤ì´ ìŠ¹ì¸í•œ ì¡°í•©ì´ë‹¤.",
                f"ìˆ™ëª…ì ì¸ ë§Œë‚¨ì´êµ°, {partner.character.name}.",
                f"ìš´ëª…ì˜ ì‹¤ì´ ì–½í˜”ë‹¤.",
                f"ì˜ˆì–¸ëœ í˜‘ë ¥ì˜ ìˆœê°„ì´ë‹¤.",
                f"ë³„ìë¦¬ê°€ ìš°ë¦¬ì˜ í˜‘ë ¥ì„ ë§í•˜ê³  ìˆë‹¤.",
                f"ìš´ëª…ì´ ì´ë„ëŠ” ëŒ€ë¡œ, {partner.character.name}.",
                f"ì‹œê³µì„ ë„˜ë‚˜ë“œëŠ” í˜‘ë ¥ì´êµ°.",
                f"ì •í•´ì§„ ìš´ëª…ì„ ë”°ë¥´ì."
            ],
            CharacterPersonality.HOT_TEMPERED: [
                f"{partner.character.name}! ë¹¨ë¦¬ ë”°ë¼ì™€!", 
                f"ì‹œì›í•˜ê²Œ ë‚ ë ¤ë²„ë¦¬ì!", 
                f"í˜‘ë™ ê³µê²©ìœ¼ë¡œ ë°•ì‚´ë‚´ì!",
                f"ë¶ˆíƒ€ëŠ” í˜‘ë ¥ì´ë‹¤!",
                f"{partner.character.name}! í™”ëˆí•˜ê²Œ ê°€ì!",
                f"ëœ¨ê²ê²Œ ì‹¸ì›Œë³´ì!",
                f"ì‹œì›í•œ í˜‘ë™ ê³µê²©ì´ë‹¤!",
                f"í­ë°œì ì¸ ì½¤ë³´ë¥¼ ë³´ì—¬ì£¼ì!",
                f"{partner.character.name}! ì—´ì •ì ìœ¼ë¡œ!",
                f"ê²©ë ¬í•œ í˜‘ë ¥ ì „íˆ¬!"
            ],
            CharacterPersonality.WISE: [
                f"{partner.character.name}, ì§€í˜œë¥¼ í•©ì³ë³´ì.", 
                f"í˜‘ë ¥ì´ ìŠ¹ë¦¬ë¥¼ ê°€ì ¸ë‹¤ì¤„ ê²ƒì´ë‹¤.", 
                f"ìš°ë¦¬ì˜ ê²½í—˜ì„ í•©ì¹˜ì.",
                f"í˜„ëª…í•œ í˜‘ë ¥ì´ ì—´ì‡ ë‹¤.",
                f"{partner.character.name}, ê¹Šì€ ì´í•´ë¥¼ ë°”íƒ•ìœ¼ë¡œ.",
                f"ì§€í˜œë¡œìš´ ì—°í•©ì´ë‹¤.",
                f"ê²½í—˜ê³¼ ì§€ì‹ì˜ ìœµí•©ì´ë‹¤.",
                f"í˜„ëª…í•œ íŒë‹¨ìœ¼ë¡œ í˜‘ë ¥í•˜ì.",
                f"ê¹Šì´ ìˆëŠ” í˜‘ë ¥ì„ í•´ë³´ì.",
                f"ì§€í˜œë¡œìš´ ìë“¤ì˜ í˜‘ë™ì´ë‹¤."
            ],
            CharacterPersonality.BALANCED: [
                f"{partner.character.name}, í•¨ê»˜ í•´ë´…ì‹œë‹¤.",
                f"í˜‘ë ¥í•´ì„œ í•´ê²°í•´ë´ìš”.",
                f"ì„œë¡œ ë„ìš°ë©° ê°€ë´…ì‹œë‹¤.",
                f"ì¢‹ì€ í˜‘ë™ì´ ë  ê²ƒ ê°™ì•„ìš”.",
                f"{partner.character.name}ì™€ í•¨ê»˜ë¼ë©´ ê´œì°®ì„ ê±°ì˜ˆìš”.",
                f"ê· í˜•ì¡íŒ í˜‘ë ¥ì„ í•´ë´…ì‹œë‹¤.",
                f"ì ì ˆí•œ í˜‘ë™ ê³µê²©ì´ì—ìš”.",
                f"í•¨ê»˜í•˜ë©´ ë” ì¢‹ì„ ê±°ì˜ˆìš”."
            ]
        }
        
        # íŒŒíŠ¸ë„ˆì˜ ì‘ë‹µ ëŒ€ì‚¬ (ì„±ê²©ë³„ ëŒ€í­ í™•ì¥)
        partner_response_dialogues = {
            CharacterPersonality.CHEERFUL: [
                f"ì¢‹ì•„! {character.name}ê³¼ í•¨ê»˜ ê°€ì!", 
                f"ìš°ë¦¬ íŒ€ì›Œí¬ ë³´ì—¬ì£¼ì!", 
                f"ì‹ ë‚˜ëŠ” í˜‘ë™ ê³µê²©ì´ë‹¤!",
                f"ì™„ì „ ê¸°ëŒ€ë¼! {character.name}!",
                f"ìš°ë¦¬ í˜¸í¡ì´ ì™„ë²½í•´!",
                f"ìµœê³ ì˜ íŒŒíŠ¸ë„ˆì•¼!",
                f"í•¨ê»˜ë¼ë©´ ë­ë“  í•  ìˆ˜ ìˆì–´!",
                f"ì™€! ë©‹ì§„ ì½¤ë³´ê°€ ë  ê²ƒ ê°™ì•„!",
                f"{character.name}ê³¼ í•¨ê»˜í•˜ë‹ˆê¹Œ ë” ì‹ ë‚˜!",
                f"ìš°ë¦¬ê°€ ìµœê°• ë“€ì˜¤ì§€!"
            ],
            CharacterPersonality.SERIOUS: [
                f"ì´í•´í–ˆë‹¤, {character.name}.", 
                f"ì „ìˆ ì— ë”°ë¼ í–‰ë™í•˜ê² ë‹¤.", 
                f"í˜‘ë ¥ ê°œì‹œ.",
                f"ëª…ë ¹ì„ ë”°ë¥´ê² ë‹¤.",
                f"ê³„íšì— ë™ì˜í•œë‹¤.",
                f"ì „ë¬¸ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ê² ë‹¤.",
                f"íš¨ìœ¨ì ì¸ í˜‘ë ¥ì´ë‹¤.",
                f"ì™„ë²½í•˜ê²Œ ì‹¤í–‰í•˜ê² ë‹¤.",
                f"ì±…ì„ê°ì„ ê°€ì§€ê³  ì„í•˜ê² ë‹¤.",
                f"í”„ë¡œë‹¤ìš´ í˜‘ë ¥ì´ë‹¤."
            ],
            CharacterPersonality.GENTLE: [
                f"ë„¤, {character.name}ë‹˜. ì¡°ì‹¬í•´ì„œ ê°€ìš”.", 
                f"í•¨ê»˜í•´ì„œ ë“ ë“ í•´ìš”.", 
                f"ì„œë¡œ ì§€ì¼œì£¼ë©´ì„œ í•´ìš”.",
                f"ì•ˆì „í•˜ê²Œ í•¨ê»˜ í•´ë´ìš”.",
                f"{character.name}ë‹˜ê³¼ í•¨ê»˜ë¼ë©´ ë§ˆìŒì´ í¸í•´ìš”.",
                f"ì„œë¡œ ë„ìš°ë©° ê°€ìš”.",
                f"ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.",
                f"ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ í•´ë´ìš”.",
                f"í•¨ê»˜í•˜ë‹ˆê¹Œ ì•ˆì‹¬ì´ì—ìš”.",
                f"ì„œë¡œë¥¼ ë¯¿ê³  ê°€ë´ìš”."
            ],
            CharacterPersonality.COLD: [
                f"...ì•Œê² ë‹¤.", 
                f"{character.name}... ë”°ë¥´ê² ë‹¤.", 
                f"...ì‹œì‘í•˜ì.",
                f"...ì´í•´í–ˆë‹¤.",
                f"í˜‘ë ¥í•œë‹¤.",
                f"...ì›€ì§ì´ê² ë‹¤.",
                f"ë”°ë¼ê°€ê² ë‹¤.",
                f"...ì¤€ë¹„ëë‹¤.",
                f"ì‹œì‘í•˜ì.",
                f"...ì¢‹ë‹¤."
            ],
            CharacterPersonality.PLAYFUL: [
                f"ì˜¤! {character.name}ê³¼ ì½¤ë³´ë¼ë‹ˆ ì¬ë°Œê² ì–´!", 
                f"í˜‘ë™ í”Œë ˆì´ ì‹œì‘!", 
                f"ìš°ë¦¬ê°€ ìµœê³ ì˜ ë“€ì˜¤ì•¼!",
                f"ì™„ì „ ì¿¨í•œ ì½¤ë³´ë„¤!",
                f"ê²Œì„ ê°™ì•„ì„œ ì¬ë°Œì–´!",
                f"ìš°ë¦¬ë§Œì˜ ìŠ¤í˜ì…œ ì½¤ë³´!",
                f"ì‹ ë‚˜ëŠ” ë†€ì´ ì‹œê°„ì´ì•¼!",
                f"ë©‹ì§„ ì‡¼ë¥¼ í•´ë³´ì!",
                f"ì™„ì „ í¥ë¯¸ì§„ì§„í•´!",
                f"ìµœê³ ì˜ ì—”í„°í…Œì¸ë¨¼íŠ¸!"
            ],
            CharacterPersonality.MYSTERIOUS: [
                f"ìš´ëª…ì˜ ì‹¤ì´ ì–½í˜”êµ°, {character.name}.", 
                f"ì˜ˆì •ëœ ìˆœê°„ì´ë‹¤.", 
                f"ë³„ë“¤ì´ ì¶•ë³µí•˜ë¦¬ë¼.",
                f"ìˆ™ëª…ì ì¸ í˜‘ë ¥ì´êµ°.",
                f"ìš´ëª…ì´ ì´ë„ëŠ” ëŒ€ë¡œ.",
                f"ì˜ˆì–¸ëœ ìˆœê°„ì´ ì™”ë‹¤.",
                f"ë³„ìë¦¬ê°€ ë§í•˜ê³  ìˆë‹¤.",
                f"ì‹œê³µì„ ë„˜ë‚˜ë“œëŠ” í˜‘ë ¥.",
                f"ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´ê°€ ëˆë‹¤.",
                f"ì •í•´ì§„ ê¸¸ì„ ë”°ë¼ê°€ì."
            ],
            CharacterPersonality.HOT_TEMPERED: [
                f"ë“œë””ì–´! {character.name}ê³¼ í•¨ê»˜!", 
                f"ì‹œì›í•˜ê²Œ í•´ë³´ì!", 
                f"ë¶ˆíƒ€ëŠ” í˜‘ë™ ê³µê²©ì´ë‹¤!",
                f"í™”ëˆí•œ ì½¤ë³´ë‹¤!",
                f"ì—´ì •ì ìœ¼ë¡œ ê°€ì!",
                f"í­ë°œì ì¸ í˜‘ë ¥ì´ì•¼!",
                f"ëœ¨ê²ê²Œ ì‹¸ìš°ì!",
                f"ê²©ë ¬í•œ ì „íˆ¬ë‹¤!",
                f"ì‹œì›í•œ í•œë°©ì´ë‹¤!",
                f"ë¶ˆê½ƒ íŠ€ëŠ” í˜‘ë ¥!"
            ],
            CharacterPersonality.WISE: [
                f"í˜„ëª…í•œ íŒë‹¨ì´ë‹¤, {character.name}.", 
                f"í˜‘ë ¥ì˜ ì§€í˜œë¥¼ ë³´ì´ì.", 
                f"í•¨ê»˜ë¼ë©´ ìŠ¹ë¦¬í•  ìˆ˜ ìˆë‹¤.",
                f"ì§€í˜œë¡œìš´ ì—°í•©ì´ë‹¤.",
                f"ê²½í—˜ì˜ í˜ì„ í•©ì¹˜ì.",
                f"ê¹Šì´ ìˆëŠ” í˜‘ë ¥ì´ë‹¤.",
                f"í˜„ëª…í•œ ì„ íƒì´ì—ˆë‹¤.",
                f"ì§€í˜œë¡œìš´ ìë“¤ì˜ ë§Œë‚¨.",
                f"ê¹¨ë‹¬ìŒì˜ í˜‘ë ¥ì´ë‹¤.",
                f"ì§€ì‹ê³¼ ê²½í—˜ì˜ ìœµí•©."
            ],
            CharacterPersonality.BALANCED: [
                f"ì¢‹ì•„ìš”, {character.name}ë‹˜.",
                f"í•¨ê»˜ í•´ë´…ì‹œë‹¤.",
                f"í˜‘ë ¥í•´ì„œ í•´ê²°í•´ìš”.",
                f"ì ì ˆí•œ íŒë‹¨ì´ì—ìš”.",
                f"ì„œë¡œ ë„ìš°ë©° ê°€ìš”.",
                f"ê· í˜•ì¡íŒ í˜‘ë ¥ì´ë„¤ìš”.",
                f"í•¨ê»˜í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”.",
                f"ì ë‹¹íˆ ì¡°ì‹¬í•´ì„œ ê°€ìš”."
            ]
        }
        
        # ì§ì—…ë³„ íŠ¹ìˆ˜ í˜‘ë™ê³µê²© ëŒ€ì‚¬
        class_coordination_dialogues = self._get_class_coordination_dialogue(
            getattr(character, 'character_class', 'ì „ì‚¬'),
            getattr(partner.character, 'character_class', 'ì „ì‚¬')
        )
        
        # ëŒ€ì‚¬ ì¶œë ¥ (ì•ˆì „í•œ ê¸°ë³¸ê°’ í¬í•¨)
        start_dialogue = random.choice(coordination_start_dialogues.get(character_personality, 
            ["í•¨ê»˜ ê°€ì!", "í˜‘ë ¥í•˜ì!", "ê°™ì´ í•´ë³´ì!", "í˜ì„ í•©ì¹˜ì!", "í•¨ê»˜ ì‹¸ìš°ì!"]))
        response_dialogue = random.choice(partner_response_dialogues.get(partner_personality, 
            ["ì•Œê² ë‹¤!", "ì¢‹ì•„!", "í•¨ê»˜ í•˜ì!", "ê·¸ë˜!", "ë”°ë¼ê°€ê² ë‹¤!"]))
        
        print(f"\nâš¡ {character.name}: \"{start_dialogue}\"")
        print(f"âš¡ {partner.character.name}: \"{response_dialogue}\"")
        
        if class_coordination_dialogues:
            print(f"ğŸ’« {random.choice(class_coordination_dialogues)}")
        
        time.sleep(1.5)  # ëŒ€ì‚¬ ì½ì„ ì‹œê°„ ì œê³µ
        
        # í˜‘ë™ ê³µê²© ì• ë‹ˆë©”ì´ì…˜
        from game.ui_animations import show_coordination_attack_animation
        show_coordination_attack_animation(character.name, partner.character.name)
        
        # í˜‘ë™ ê³µê²© ìƒíƒœ í•´ì œ
        partner.coordinated_attack_ready = False
        
        # ë°ë¯¸ì§€ ë³´ë„ˆìŠ¤ ì ìš©
        return "coordinated_attack", {"partner": partner.character}
    
    def _get_class_coordination_dialogue(self, class1: str, class2: str) -> List[str]:
        """ì§ì—…ë³„ í˜‘ë™ê³µê²© íŠ¹ìˆ˜ ëŒ€ì‚¬"""
        coordination_pairs = {
            ("ì „ì‚¬", "ì•„í¬ë©”ì´ì§€"): [
                "ê²€ê³¼ ë§ˆë²•ì˜ ì™„ë²½í•œ ì¡°í•©ì´ë‹¤!",
                "ë¬´ë ¥ê³¼ ë§ˆë ¥ì´ í•˜ë‚˜ê°€ ë˜ì—ˆë‹¤!",
                "ë¬¼ë¦¬ì™€ ë§ˆë²•ì˜ í•˜ëª¨ë‹ˆ!"
            ],
            ("ê¶ìˆ˜", "ë„ì "): [
                "ì›ê±°ë¦¬ì™€ ê·¼ê±°ë¦¬ì˜ ì™„ë²½í•œ í˜‘ë ¥!",
                "ì •ë°€í•¨ê³¼ ë¯¼ì²©í•¨ì˜ ì¡°í•©!",
                "ê·¸ë¦¼ìì™€ í™”ì‚´ì˜ ì¶¤!"
            ],
            ("ì„±ê¸°ì‚¬", "í´ë ˆë¦­"): [
                "ì‹ ì„±í•œ ë¹›ì´ í•˜ë‚˜ê°€ ë˜ì—ˆë‹¤!",
                "ì •ì˜ì™€ ì¹˜ìœ ì˜ ì‹ ì„±í•œ í˜‘ë ¥!",
                "ì‹ ì˜ ëœ»ì´ ìš°ë¦¬ë¥¼ í•˜ë‚˜ë¡œ!"
            ],
            ("ë°”ë“œ", "ë“œë£¨ì´ë“œ"): [
                "ìì—°ì˜ ì„ ìœ¨ê³¼ ìŒì•…ì´ ì–´ìš°ëŸ¬ì§„ë‹¤!",
                "ìƒëª…ì˜ ë…¸ë˜ê°€ ìš¸ë ¤í¼ì§„ë‹¤!",
                "ìì—°ê³¼ ìŒì•…ì˜ ì™„ë²½í•œ í•˜ëª¨ë‹ˆ!"
            ],
            ("ì‚¬ë¬´ë¼ì´", "ëª½í¬"): [
                "ê²€ì˜ ë„ì™€ ë¬´ìˆ ì˜ ë„ê°€ ë§Œë‚¬ë‹¤!",
                "ë¬´ì‚¬ë„ì™€ ìˆ˜í–‰ì •ì‹ ì˜ ìœµí•©!",
                "ë™ì–‘ ë¬´ìˆ ì˜ ì™„ë²½í•œ ì¡°í™”!"
            ],
            ("ê´‘ì „ì‚¬", "ë„¤í¬ë¡œë§¨ì„œ"): [
                "ë¶„ë…¸ì™€ ì–´ë‘ ì˜ ìœ„í—˜í•œ ì¡°í•©!",
                "ê´‘ê¸°ì™€ ì£½ìŒì´ ì†ì„ ì¡ì•˜ë‹¤!",
                "íŒŒê´´ì ì¸ í˜‘ë ¥ì˜ ì‹œì‘!"
            ]
        }
        
        # ìˆœì„œë¥¼ ë°”ê¿”ì„œë„ í™•ì¸
        dialogue_list = coordination_pairs.get((class1, class2))
        if not dialogue_list:
            dialogue_list = coordination_pairs.get((class2, class1))
        
        return dialogue_list or []
    
    def show_coordination_success_dialogue(self, character: Character, partner: Character):
        """í˜‘ë™ê³µê²© ì„±ê³µ í›„ ëŒ€ì‚¬"""
        character_personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
        partner_personality = getattr(partner, 'personality', CharacterPersonality.BALANCED)
        
        # í˜‘ë™ê³µê²© ì„±ê³µ ëŒ€ì‚¬ (ì„±ê²©ë³„ ëŒ€í­ í™•ì¥)
        success_dialogues = {
            CharacterPersonality.CHEERFUL: [
                f"ìš°ì™€! {partner.name}ê³¼ ì™„ë²½í•œ ì½¤ë³´ì˜€ì–´!",
                f"ìš°ë¦¬ ì •ë§ ìµœê³ ì•¼!",
                f"ì‹ ë‚˜ëŠ” íŒ€ì›Œí¬ì˜€ì–´!",
                f"ì—­ì‹œ ìš°ë¦¬ê°€ ìµœê°•ì´ì•¼!",
                f"ì™„ì „ ë©‹ì§„ í˜‘ë ¥ì´ì—ˆì–´!",
                f"ìš°ë¦¬ í˜¸í¡ì´ ì •ë§ ì¢‹ë„¤!",
                f"ì„±ê³µ! ìš°ë¦¬ê°€ í•´ëƒˆì–´!",
                f"ìµœê³ ì˜ íŒŒíŠ¸ë„ˆì‹­ì´ì•¼!",
                f"ì™€! ì´ëŸ° ê²Œ ì§„ì§œ íŒ€ì›Œí¬ì§€!",
                f"ìš°ë¦¬ ì •ë§ ì˜ ë§ì•„!"
            ],
            CharacterPersonality.SERIOUS: [
                f"{partner.name}ê³¼ì˜ í˜‘ë ¥ì´ ì™„ë²½í–ˆë‹¤.",
                f"ì „ìˆ  ì„±ê³µ.",
                f"íš¨ê³¼ì ì¸ ì—°ê³„ì˜€ë‹¤.",
                f"ê³„íšëŒ€ë¡œ ì‹¤í–‰ëë‹¤.",
                f"í”„ë¡œí˜ì…”ë„í•œ í˜‘ë ¥ì´ì—ˆë‹¤.",
                f"ì •í™•í•œ ì‹¤í–‰ì´ì—ˆë‹¤.",
                f"ì˜ˆìƒí•œ ê²°ê³¼ë‹¤.",
                f"íš¨ìœ¨ì ì¸ ê³µê²©ì´ì—ˆë‹¤.",
                f"ì™„ë²½í•œ ì—°ê³„ê³µê²©.",
                f"ì „ë¬¸ê°€ë‹¤ìš´ í˜‘ë ¥."
            ],
            CharacterPersonality.GENTLE: [
                f"{partner.name}ë‹˜ê³¼ ì˜ í•´ëƒˆë„¤ìš”.",
                f"í•¨ê»˜í•´ì„œ ì¢‹ì•˜ì–´ìš”.",
                f"ì„œë¡œ ì˜ ë„ì™”ë„¤ìš”.",
                f"ë¬´ì‚¬íˆ ì„±ê³µí–ˆì–´ìš”.",
                f"ë‹¤í–‰íˆ ì˜ ëë„¤ìš”.",
                f"ì„œë¡œ ì§€ì¼œì£¼ë©° ì˜ í–ˆì–´ìš”.",
                f"ì•ˆì „í•˜ê²Œ í•´ëƒˆì–´ìš”.",
                f"í•¨ê»˜ë¼ì„œ ê°€ëŠ¥í–ˆì–´ìš”.",
                f"ì„œë¡œë¥¼ ë¯¿ê³  ì˜ í–ˆë„¤ìš”.",
                f"ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ì˜ í•´ëƒˆì–´ìš”."
            ],
            CharacterPersonality.COLD: [
                f"...ì„±ê³µí–ˆë‹¤.",
                f"{partner.name}... ë‚˜ì˜ì§€ ì•Šêµ°.",
                f"...íš¨ê³¼ì ì´ì—ˆë‹¤.",
                f"...ì˜ˆìƒ ë²”ìœ„ë‹¤.",
                f"ì„±ê³µ.",
                f"...ë§Œì¡±ìŠ¤ëŸ½ë‹¤.",
                f"ì¢‹ë‹¤.",
                f"...ê·¸ëŸ­ì €ëŸ­.",
                f"ì™„ë£Œ.",
                f"...ì¶©ë¶„í•˜ë‹¤."
            ],
            CharacterPersonality.PLAYFUL: [
                f"ì™€! {partner.name}ê³¼ í™˜ìƒì ì¸ ì½¤ë³´!",
                f"ì™„ì „ ì¿¨í•œ ì„±ê³µì´ì•¼!",
                f"ìš°ë¦¬ ì •ë§ ë©‹ì ¸!",
                f"ê²Œì„ í´ë¦¬ì–´! ìµœê³ ì•¼!",
                f"ìŠ¤í˜ì…œ ì½¤ë³´ ì„±ê³µ!",
                f"ì™„ì „ ì¬ë°ŒëŠ” í˜‘ë ¥ì´ì—ˆì–´!",
                f"ìš°ë¦¬ê°€ ì£¼ì¸ê³µì´ì•¼!",
                f"ë©‹ì§„ ì‡¼ì˜€ì–´!",
                f"ì™„ì „ ëŒ€ë°•ì´ì•¼!",
                f"ìµœê³ ì˜ ì—”í„°í…Œì¸ë¨¼íŠ¸!"
            ],
            CharacterPersonality.MYSTERIOUS: [
                f"ìš´ëª…ì´ ìš°ë¦¬ë¥¼ ì¶•ë³µí–ˆêµ°, {partner.name}.",
                f"ë³„ë“¤ì´ ë¯¸ì†Œì§“ê³  ìˆë‹¤.",
                f"ì˜ˆì •ëœ ì„±ê³µì´ì—ˆë‹¤.",
                f"ìš°ì£¼ì˜ ì„­ë¦¬ê°€ ë„ì™”ë‹¤.",
                f"ìˆ™ëª…ì ì¸ ìŠ¹ë¦¬ë‹¤.",
                f"ì‹œê³µì„ ë„˜ë‚˜ë“œëŠ” í˜‘ë ¥ì˜ ê²°ì‹¤.",
                f"ìš´ëª…ì˜ ì‹¤ì´ ì˜¬ë°”ë¥´ê²Œ ì—®ì˜€ë‹¤.",
                f"ë³„ìë¦¬ê°€ ì¶•ë³µí•œ ê²°ê³¼.",
                f"ì˜ˆì–¸ì´ í˜„ì‹¤ì´ ë˜ì—ˆë‹¤.",
                f"ì‹ ë¹„ë¡œìš´ í˜ì˜ ìœµí•©."
            ],
            CharacterPersonality.HOT_TEMPERED: [
                f"ì‹œì›í•˜ë‹¤! {partner.name}ê³¼ ì™„ë²½í•œ í˜‘ë ¥!",
                f"ë¶ˆíƒ€ëŠ” ì„±ê³µì´ì•¼!",
                f"ì—´ì •ì˜ ê²°ê³¼ë‹¤!",
                f"í™”ëˆí•œ ì½¤ë³´ì˜€ì–´!",
                f"í­ë°œì ì¸ í˜‘ë ¥ì´ì—ˆë‹¤!",
                f"ëœ¨ê±°ìš´ ìŠ¹ë¦¬ì•¼!",
                f"ì‹œì›í•œ í•œë°©ì´ì—ˆì–´!",
                f"ê²©ë ¬í•œ ì„±ê³µ!",
                f"ë¶ˆê½ƒ íŠ€ëŠ” í˜‘ë ¥ì˜ ê²°ê³¼!",
                f"ì—´ì •ì ì¸ íŒ€ì›Œí¬!"
            ],
            CharacterPersonality.WISE: [
                f"{partner.name}ê³¼ì˜ ì§€í˜œë¡œìš´ í˜‘ë ¥ì´ì—ˆë‹¤.",
                f"ê²½í—˜ì˜ í˜ì´ ë°œíœ˜ëë‹¤.",
                f"í˜„ëª…í•œ íŒë‹¨ì˜ ê²°ê³¼ë‹¤.",
                f"ì§€ì‹ê³¼ ê²½í—˜ì˜ ìœµí•©.",
                f"ê¹Šì´ ìˆëŠ” í˜‘ë ¥ì˜ ì„±ê³¼.",
                f"ì§€í˜œë¡œìš´ ìë“¤ì˜ ìŠ¹ë¦¬.",
                f"í˜„ëª…í•œ ì—°í•©ì˜ ê²°ì‹¤.",
                f"ê¹¨ë‹¬ìŒì´ ì´ëˆ ì„±ê³µ.",
                f"ì§€í˜œì™€ í˜‘ë ¥ì˜ ì¡°í™”.",
                f"ê²½í—˜ì´ ë§Œë“  ì™„ë²½í•œ ê²°ê³¼."
            ],
            CharacterPersonality.BALANCED: [
                f"{partner.name}ë‹˜ê³¼ ì˜ í•´ëƒˆë„¤ìš”.",
                f"ì ì ˆí•œ í˜‘ë ¥ì´ì—ˆì–´ìš”.",
                f"ê· í˜•ì¡íŒ íŒ€ì›Œí¬ì˜€ë„¤ìš”.",
                f"ì„œë¡œ ì˜ ë§ì¶°ì„œ ì„±ê³µí–ˆì–´ìš”.",
                f"í•¨ê»˜í•´ì„œ ì¢‹ì€ ê²°ê³¼ê°€ ë‚˜ì™”ë„¤ìš”.",
                f"ì ë‹¹íˆ ì˜ í•´ëƒˆì–´ìš”.",
                f"ì„œë¡œ ë„ì™€ì„œ ì„±ê³µí–ˆë„¤ìš”.",
                f"ì¢‹ì€ í˜‘ë ¥ì´ì—ˆì–´ìš”."
            ]
        }
        
        # íŒŒíŠ¸ë„ˆ ì‘ë‹µ ëŒ€ì‚¬
        partner_success_responses = {
            CharacterPersonality.CHEERFUL: [
                f"ê·¸ëŸ¬ê²Œ! {character.name}ê³¼ í•¨ê»˜ë¼ì„œ ê°€ëŠ¥í–ˆì–´!",
                f"ìš°ë¦¬ ì¡°í•© ì •ë§ ìµœê³ ì•¼!",
                f"ë‹¤ìŒì—ë„ ë˜ í•˜ì!",
                f"ì™„ì „ ì‹ ë‚¬ì–´!",
                f"ìš°ë¦¬ê°€ ì§„ì§œ ë“œë¦¼íŒ€ì´ì•¼!"
            ],
            CharacterPersonality.SERIOUS: [
                f"íš¨ê³¼ì ì¸ í˜‘ë ¥ì´ì—ˆë‹¤, {character.name}.",
                f"ë‹¤ìŒì—ë„ ì´ëŸ°ì‹ìœ¼ë¡œ í•˜ì.",
                f"ì „ìˆ ì ìœ¼ë¡œ ì„±ê³µì ì´ì—ˆë‹¤.",
                f"ê³„íšëŒ€ë¡œ ì§„í–‰ëë‹¤.",
                f"ë§Œì¡±ìŠ¤ëŸ¬ìš´ ê²°ê³¼ë‹¤."
            ],
            CharacterPersonality.GENTLE: [
                f"ë„¤, {character.name}ë‹˜ ë•ë¶„ì´ì—ìš”.",
                f"í•¨ê»˜í•´ì„œ ë‹¤í–‰ì´ì—ˆì–´ìš”.",
                f"ì„œë¡œ ì˜ ë„ì™”ë„¤ìš”.",
                f"ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ì˜ í•´ëƒˆì–´ìš”.",
                f"ë¬´ì‚¬íˆ ëë‚˜ì„œ ë‹¤í–‰ì´ì—ìš”."
            ],
            CharacterPersonality.COLD: [
                f"...ë‚˜ì˜ì§€ ì•Šì•˜ë‹¤.",
                f"{character.name}... ì¸ì •í•œë‹¤.",
                f"...ì„±ê³µì ì´ì—ˆë‹¤.",
                f"ì¢‹ë‹¤.",
                f"...ê·¸ëŸ­ì €ëŸ­."
            ],
            CharacterPersonality.PLAYFUL: [
                f"ìš°ì™€! {character.name}! ì™„ì „ ì¬ë°Œì—ˆì–´!",
                f"ë˜ í•´ë³´ì! ë„ˆë¬´ ì¬ë°Œì–´!",
                f"ìš°ë¦¬ ì½¤ë¹„ ì™„ì „ ì¿¨í•´!",
                f"ê²Œì„ ê°™ì•„ì„œ ì‹ ë‚˜!",
                f"ìµœê³ ì˜ ë“€ì˜¤ì•¼!"
            ],
            CharacterPersonality.MYSTERIOUS: [
                f"ìš´ëª…ì ì¸ í˜‘ë ¥ì´ì—ˆë‹¤, {character.name}.",
                f"ë³„ë“¤ì´ ìš°ë¦¬ë¥¼ ì¶•ë³µí–ˆë‹¤.",
                f"ì˜ˆì •ëœ ê²°ê³¼ì˜€êµ°.",
                f"ìš°ì£¼ì˜ ëœ»ì´ì—ˆë‹¤.",
                f"ì‹ ë¹„ë¡œìš´ ì¡°í™”ì˜€ë‹¤."
            ],
            CharacterPersonality.HOT_TEMPERED: [
                f"ê·¸ë˜! {character.name}! ì‹œì›í–ˆì–´!",
                f"ì´ëŸ° ë§›ì— í˜‘ë ¥í•˜ëŠ” ê±°ì§€!",
                f"ë¶ˆíƒ€ëŠ” í˜‘ë ¥ì´ì—ˆì–´!",
                f"ë‹¤ìŒì—ë„ ì´ë ‡ê²Œ í•˜ì!",
                f"ì—´ì •ì ì´ì—ˆì–´!"
            ],
            CharacterPersonality.WISE: [
                f"í˜„ëª…í•œ í˜‘ë ¥ì´ì—ˆë‹¤, {character.name}.",
                f"ì§€í˜œë¡œìš´ íŒë‹¨ì´ì—ˆë‹¤.",
                f"ê²½í—˜ì˜ ê°€ì¹˜ë¥¼ ëŠê¼ˆë‹¤.",
                f"ê¹Šì´ ìˆëŠ” í˜‘ë ¥ì´ì—ˆë‹¤.",
                f"ë°°ìš¸ ì ì´ ë§ì•˜ë‹¤."
            ],
            CharacterPersonality.BALANCED: [
                f"ì¢‹ì•˜ì–´ìš”, {character.name}ë‹˜.",
                f"ì ì ˆí•œ í˜‘ë ¥ì´ì—ˆë„¤ìš”.",
                f"ì„œë¡œ ì˜ ë§ì·„ì–´ìš”.",
                f"ê· í˜•ì¡íŒ íŒ€ì›Œí¬ì˜€ì–´ìš”.",
                f"í•¨ê»˜í•´ì„œ ì¢‹ì•˜ì–´ìš”."
            ]
        }
        
        # ì„±ê³µ ëŒ€ì‚¬ ì¶œë ¥
        success_dialogue = random.choice(success_dialogues.get(character_personality, [f"{partner.name}ê³¼ ì˜ í–ˆë‹¤!"]))
        partner_response = random.choice(partner_success_responses.get(partner_personality, ["ê·¸ë ‡ë‹¤!"]))
        
        print(f"\nâœ¨ {character.name}: \"{success_dialogue}\"")
        print(f"âœ¨ {partner.name}: \"{partner_response}\"")
        
        # ê°€ë” ì§ì—…ë³„ íŠ¹ìˆ˜ ì„±ê³µ ëŒ€ì‚¬ ì¶”ê°€ (30% í™•ë¥ )
        if random.random() < 0.3:
            class_success_dialogues = self._get_class_success_dialogue(
                getattr(character, 'character_class', 'ì „ì‚¬'),
                getattr(partner, 'character_class', 'ì „ì‚¬')
            )
            if class_success_dialogues:
                print(f"ğŸ’« {random.choice(class_success_dialogues)}")
        
        time.sleep(2)  # ëŒ€ì‚¬ ì½ì„ ì‹œê°„ ì œê³µ
    
    def _get_class_success_dialogue(self, class1: str, class2: str) -> List[str]:
        """ì§ì—…ë³„ í˜‘ë™ê³µê²© ì„±ê³µ íŠ¹ìˆ˜ ëŒ€ì‚¬"""
        success_pairs = {
            ("ì „ì‚¬", "ì•„í¬ë©”ì´ì§€"): [
                "ê²€ê³¼ ë§ˆë²•ì´ ì™„ë²½í•œ ìŠ¹ë¦¬ë¥¼ ë§Œë“¤ì–´ëƒˆë‹¤!",
                "ë¬´ë ¥ê³¼ ë§ˆë ¥ì˜ ì¡°í™”ë¡œìš´ ìŠ¹ë¦¬!",
                "ë¬¼ë¦¬ì™€ ë§ˆë²•ì˜ ì™„ë²½í•œ ìœµí•©ì´ì—ˆë‹¤!"
            ],
            ("ê¶ìˆ˜", "ë„ì "): [
                "ì •ë°€í•¨ê³¼ ë¯¼ì²©í•¨ì˜ ì™„ë²½í•œ ê²°í•©!",
                "ì›ê±°ë¦¬ì™€ ê·¼ê±°ë¦¬ì˜ í™˜ìƒì ì¸ í˜‘ë ¥!",
                "ê·¸ë¦¼ìì™€ í™”ì‚´ì´ ë§Œë“  ì˜ˆìˆ í’ˆ!"
            ],
            ("ì„±ê¸°ì‚¬", "í´ë ˆë¦­"): [
                "ì‹ ì„±í•œ ë¹›ì˜ ìŠ¹ë¦¬ë‹¤!",
                "ì •ì˜ì™€ ì¹˜ìœ ê°€ í•˜ë‚˜ëœ ê²°ê³¼!",
                "ì‹ ì˜ ì¶•ë³µë°›ì€ í˜‘ë ¥ì´ì—ˆë‹¤!"
            ],
            ("ë°”ë“œ", "ë“œë£¨ì´ë“œ"): [
                "ìì—°ê³¼ ìŒì•…ì˜ ì™„ë²½í•œ í•˜ëª¨ë‹ˆ!",
                "ìƒëª…ì˜ ì„ ìœ¨ì´ ìŠ¹ë¦¬ë¥¼ ì´ëŒì—ˆë‹¤!",
                "ìì—°ì˜ ì¶•ë³µë°›ì€ í˜‘ë ¥!"
            ],
            ("ì‚¬ë¬´ë¼ì´", "ëª½í¬"): [
                "ë¬´ì‚¬ë„ì™€ ìˆ˜í–‰ì •ì‹ ì˜ ì™„ë²½í•œ ìŠ¹ë¦¬!",
                "ë™ì–‘ ë¬´ìˆ ì˜ ê¹Šì´ë¥¼ ë³´ì—¬ì¤€ í˜‘ë ¥!",
                "ê²€ê³¼ ì£¼ë¨¹ì´ ë§Œë“  ì˜ˆìˆ !"
            ],
            ("ê´‘ì „ì‚¬", "ë„¤í¬ë¡œë§¨ì„œ"): [
                "ê´‘ê¸°ì™€ ì–´ë‘ ì˜ ìœ„í—˜í•œ ìŠ¹ë¦¬!",
                "íŒŒê´´ì ì¸ í˜ì˜ ì™„ë²½í•œ ì¡°í™”!",
                "ë¶„ë…¸ì™€ ì£½ìŒì´ ë§Œë“  ê³µí¬ì˜ í˜‘ë ¥!"
            ]
        }
        
        # ìˆœì„œë¥¼ ë°”ê¿”ì„œë„ í™•ì¸
        dialogue_list = success_pairs.get((class1, class2))
        if not dialogue_list:
            dialogue_list = success_pairs.get((class2, class1))
        
        return dialogue_list or []
    
    def check_equipment_durability(self, party: List[Character]):
        """ì¥ë¹„ ë‚´êµ¬ë„ í™•ì¸ ë° ê²½ê³  ì‹œìŠ¤í…œ"""
        warnings = []
        
        for character in party:
            if not hasattr(character, 'equipment') or not character.equipment:
                continue
                
            # ì¥ì°©ëœ ëª¨ë“  ì¥ë¹„ ë‚´êµ¬ë„ í™•ì¸
            for slot, item in character.equipment.items():
                if not item or not hasattr(item, 'durability') or not hasattr(item, 'max_durability'):
                    continue
                    
                durability_percent = (item.durability / item.max_durability) * 100
                
                # ë‚´êµ¬ë„ì— ë”°ë¥¸ ê²½ê³  ë ˆë²¨
                if durability_percent <= 10:
                    warnings.append({
                        'character': character,
                        'item': item,
                        'slot': slot,
                        'durability': durability_percent,
                        'level': 'critical'
                    })
                elif durability_percent <= 25:
                    warnings.append({
                        'character': character,
                        'item': item,
                        'slot': slot,
                        'durability': durability_percent,
                        'level': 'warning'
                    })
        
        # ê²½ê³  ì¶œë ¥
        if warnings:
            self._show_durability_warnings(warnings)
            
        return warnings
    
    def _show_durability_warnings(self, warnings: List[Dict]):
        """ë‚´êµ¬ë„ ê²½ê³  ëŒ€í™” ì¶œë ¥"""
        critical_warnings = [w for w in warnings if w['level'] == 'critical']
        normal_warnings = [w for w in warnings if w['level'] == 'warning']
        
        # ì¹˜ëª…ì  ê²½ê³  (10% ì´í•˜)
        for warning in critical_warnings:
            character = warning['character']
            item = warning['item']
            personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
            
            critical_dialogues = {
                CharacterPersonality.CHEERFUL: [
                    f"ì•—! {item.name}ì´ ê±°ì˜ ë¶€ì„œì ¸ê°€ê³  ìˆì–´!", 
                    f"ì´ëŸ°! {item.name} ë¹¨ë¦¬ ìˆ˜ë¦¬í•´ì•¼ê² ì–´!",
                    f"ìœ„í—˜í•´! {item.name}ì´ ê³§ ë§ê°€ì§ˆ ê²ƒ ê°™ì•„!"
                ],
                CharacterPersonality.SERIOUS: [
                    f"{item.name}ì˜ ë‚´êµ¬ë„ê°€ í•œê³„ì— ë„ë‹¬í–ˆë‹¤.",
                    f"ì¦‰ì‹œ {item.name} ìˆ˜ë¦¬ê°€ í•„ìš”í•˜ë‹¤.",
                    f"{item.name} êµì²´ë¥¼ ê³ ë ¤í•´ì•¼ í•œë‹¤."
                ],
                CharacterPersonality.GENTLE: [
                    f"{item.name}ì´ ë§ì´ ì†ìƒëì–´ìš”...",
                    f"ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ë‹¤ë¤„ì•¼ í•  ê²ƒ ê°™ì•„ìš”.",
                    f"{item.name} ìˆ˜ë¦¬í•´ì•¼ê² ì–´ìš”."
                ],
                CharacterPersonality.COLD: [
                    f"{item.name}... í•œê³„ë‹¤.",
                    f"ìˆ˜ë¦¬ í•„ìš”.",
                    f"êµì²´ ê³ ë ¤."
                ],
                CharacterPersonality.PLAYFUL: [
                    f"ì–´? {item.name}ì´ ë¶€ì„œì ¸ê°€ê³  ìˆì–´!",
                    f"ì´ëŸ°! ê²Œì„ì˜¤ë²„ ë  ë»”í–ˆë„¤!",
                    f"{item.name} ì‘ê¸‰ì²˜ì¹˜ í•„ìš”!"
                ],
                CharacterPersonality.MYSTERIOUS: [
                    f"{item.name}ì˜ ìƒëª…ë ¥ì´ ë‹¤í•´ê°€ê³  ìˆë‹¤.",
                    f"ìš´ëª…ì´ ìƒˆë¡œìš´ ì¥ë¹„ë¥¼ ìš”êµ¬í•˜ëŠ”êµ°.",
                    f"{item.name}ì˜ ì‹œëŒ€ê°€ ëë‚˜ê°€ê³  ìˆë‹¤."
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    f"ì  ì¥! {item.name}ì´ ê±°ì˜ ë¶€ì„œì¡Œì–´!",
                    f"ë¹¨ë¦¬ ìˆ˜ë¦¬í•˜ì!",
                    f"ì´ëŸ° ìƒíƒœë¡œëŠ” ì‹¸ìš¸ ìˆ˜ ì—†ì–´!"
                ],
                CharacterPersonality.WISE: [
                    f"{item.name}ì˜ ìˆ˜ëª…ì´ ë‹¤í–ˆêµ°.",
                    f"í˜„ëª…í•œ ì„ íƒì´ í•„ìš”í•˜ë‹¤.",
                    f"ê²½í—˜ìƒ ì¦‰ì‹œ ì¡°ì¹˜ê°€ í•„ìš”í•˜ë‹¤."
                ],
                CharacterPersonality.BALANCED: [
                    f"{item.name} ë‚´êµ¬ë„ê°€ ìœ„í—˜í•´ìš”.",
                    f"ìˆ˜ë¦¬ê°€ í•„ìš”í•œ ê²ƒ ê°™ì•„ìš”.",
                    f"ì¡°ì‹¬í•´ì„œ ì‚¬ìš©í•´ì•¼ê² ì–´ìš”."
                ]
            }
            
            dialogue = random.choice(critical_dialogues.get(personality, 
                [f"{item.name} ë‚´êµ¬ë„ê°€ ìœ„í—˜í•©ë‹ˆë‹¤!", f"ì¦‰ì‹œ ìˆ˜ë¦¬ê°€ í•„ìš”í•´ìš”!"]))
            print(f"\nâš ï¸ {character.name}: \"{dialogue}\"")
        
        # ì¼ë°˜ ê²½ê³  (25% ì´í•˜)
        for warning in normal_warnings:
            character = warning['character']
            item = warning['item']
            personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
            
            warning_dialogues = {
                CharacterPersonality.CHEERFUL: [
                    f"{item.name}ì´ ì¢€ ë‚¡ì•˜ë„¤.",
                    f"ê³§ ìˆ˜ë¦¬í•´ì£¼ë©´ ì¢‹ê² ì–´!",
                    f"{item.name} ê´€ë¦¬ê°€ í•„ìš”í•´."
                ],
                CharacterPersonality.SERIOUS: [
                    f"{item.name} ì ê²€ì´ í•„ìš”í•˜ë‹¤.",
                    f"ìˆ˜ë¦¬ ì¼ì •ì„ ì¡ì•„ì•¼ê² ë‹¤.",
                    f"ì˜ˆë°© ì •ë¹„ê°€ í•„ìš”í•˜ë‹¤."
                ],
                CharacterPersonality.GENTLE: [
                    f"{item.name}ì´ ì¡°ê¸ˆ ê±±ì •ë˜ë„¤ìš”.",
                    f"ë¯¸ë¦¬ ê´€ë¦¬í•´ë‘ë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”.",
                    f"ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ì‚¬ìš©í•´ì•¼ê² ì–´ìš”."
                ],
                CharacterPersonality.COLD: [
                    f"{item.name}... ì£¼ì˜.",
                    f"ì ê²€ í•„ìš”.",
                    f"ê´€ë¦¬í•˜ì."
                ],
                CharacterPersonality.PLAYFUL: [
                    f"{item.name}ì´ ì‚ê±±ê±°ë¦¬ë„¤!",
                    f"ë©”ì¸í„°ë„ŒìŠ¤ íƒ€ì„!",
                    f"ìˆ˜ë¦¬ ê²Œì„ í•´ë³¼ê¹Œ?"
                ],
                CharacterPersonality.MYSTERIOUS: [
                    f"{item.name}ì˜ ê¸°ìš´ì´ ì•½í•´ì§€ê³  ìˆë‹¤.",
                    f"ê´€ì‹¬ì´ í•„ìš”í•œ ì‹œì ì´êµ°.",
                    f"ë³„ë“¤ì´ ìˆ˜ë¦¬ë¥¼ ê¶Œí•˜ê³  ìˆë‹¤."
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    f"{item.name} ìƒíƒœê°€ ì•ˆ ì¢‹ì•„!",
                    f"ë¹¨ë¦¬ ì†ë´ì•¼ê² ì–´!",
                    f"ë¯¸ë¦¬ë¯¸ë¦¬ ê´€ë¦¬í•˜ì!"
                ],
                CharacterPersonality.WISE: [
                    f"{item.name} ê´€ë¦¬ ì‹œê¸°ê°€ ì™”ë‹¤.",
                    f"í˜„ëª…í•œ ì˜ˆë°©ì´ í•„ìš”í•˜ë‹¤.",
                    f"ê²½í—˜ìƒ ì§€ê¸ˆ ìˆ˜ë¦¬í•˜ëŠ” ê²Œ ì¢‹ë‹¤."
                ],
                CharacterPersonality.BALANCED: [
                    f"{item.name} ìƒíƒœë¥¼ í™•ì¸í•´ë´ìš”.",
                    f"ì ì ˆí•œ ê´€ë¦¬ê°€ í•„ìš”í•´ìš”.",
                    f"ë¯¸ë¦¬ ìˆ˜ë¦¬í•´ë‘ë©´ ì¢‹ê² ì–´ìš”."
                ]
            }
            
            dialogue = random.choice(warning_dialogues.get(personality, 
                [f"{item.name} ê´€ë¦¬ê°€ í•„ìš”í•´ìš”.", f"ì ê²€í•´ë´ì•¼ê² ì–´ìš”."]))
            print(f"\nğŸ’¡ {character.name}: \"{dialogue}\"")
    
    def suggest_repair_locations(self, party: List[Character]):
        """ìˆ˜ë¦¬ ì¥ì†Œ ì¶”ì²œ"""
        warnings = self.check_equipment_durability(party)
        
        if warnings:
            print(f"\nğŸ”§ ìˆ˜ë¦¬ ì¶”ì²œ:")
            print(f"   - ëŒ€ì¥ê°„ì—ì„œ ìˆ˜ë¦¬")
            print(f"   - ìˆ˜ë¦¬ ë„êµ¬ ì‚¬ìš©")
            print(f"   - ë§ˆì„ ìƒì¸ ë°©ë¬¸")
            
            # AIê°€ ìˆ˜ë¦¬ ì œì•ˆ
            if self.ai_companions and random.random() < 0.7:
                companion = random.choice(self.ai_companions)
                personality = getattr(companion, 'personality', CharacterPersonality.BALANCED)
                
                repair_suggestions = {
                    CharacterPersonality.CHEERFUL: [
                        "ë§ˆì„ì— ê°€ì„œ ìˆ˜ë¦¬í•˜ì!", "ëŒ€ì¥ê°„ ê°€ë©´ ê¸ˆë°© ê³ ì¹  ìˆ˜ ìˆì–´!", 
                        "ìˆ˜ë¦¬ ë„êµ¬ë„ ìˆì§€ ì•Šë‚˜?"
                    ],
                    CharacterPersonality.SERIOUS: [
                        "íš¨ìœ¨ì ì¸ ìˆ˜ë¦¬ ë°©ë²•ì„ ì°¾ì•„ë³´ì.", "ê³„íšì ìœ¼ë¡œ ìˆ˜ë¦¬í•˜ëŠ” ê²Œ ì¢‹ê² ë‹¤.",
                        "ì „ë¬¸ê°€ì—ê²Œ ë§¡ê¸°ëŠ” ê²Œ ì•ˆì „í•˜ë‹¤."
                    ],
                    CharacterPersonality.GENTLE: [
                        "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ìˆ˜ë¦¬í•´ë´ìš”.", "ì „ë¬¸ê°€ê»˜ ë¶€íƒë“œë¦¬ëŠ” ê²Œ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”.",
                        "ì•ˆì „í•˜ê²Œ ê³ ì³ì•¼ì£ ."
                    ],
                    CharacterPersonality.COLD: [
                        "ìˆ˜ë¦¬í•˜ì.", "ëŒ€ì¥ê°„.", "íš¨ìœ¨ì ìœ¼ë¡œ."
                    ],
                    CharacterPersonality.PLAYFUL: [
                        "ìˆ˜ë¦¬ íƒ€ì„!", "ëŒ€ì¥ê°„ ë†€ì´ ê°€ì!", "ê³ ì¹˜ëŠ” ì¬ë¯¸ë„ ì ì í• ê±¸?"
                    ],
                    CharacterPersonality.MYSTERIOUS: [
                        "ìš´ëª…ì´ ìˆ˜ë¦¬ë¥¼ ìš”êµ¬í•˜ê³  ìˆë‹¤.", "ë³„ë“¤ì´ ëŒ€ì¥ê°„ì„ ê°€ë¦¬í‚¤ê³  ìˆë‹¤.",
                        "ì‹ ë¹„ë¡œìš´ ìˆ˜ë¦¬ì˜ ì‹œê°„ì´ë‹¤."
                    ],
                    CharacterPersonality.HOT_TEMPERED: [
                        "ë¹¨ë¦¬ ìˆ˜ë¦¬í•˜ëŸ¬ ê°€ì!", "ëŒ€ì¥ê°„ìœ¼ë¡œ ë‹¬ë ¤!", "ì§€ê¸ˆ ë‹¹ì¥!"
                    ],
                    CharacterPersonality.WISE: [
                        "í˜„ëª…í•œ ìˆ˜ë¦¬ê°€ í•„ìš”í•˜ë‹¤.", "ê²½í—˜ìƒ ì „ë¬¸ê°€ê°€ ìµœê³ ë‹¤.",
                        "ì§€í˜œë¡­ê²Œ ê´€ë¦¬í•˜ì."
                    ],
                    CharacterPersonality.BALANCED: [
                        "ì ì ˆí•œ ìˆ˜ë¦¬ê°€ í•„ìš”í•´ìš”.", "ê· í˜•ì¡íŒ ê´€ë¦¬ë¥¼ í•´ë´ìš”.",
                        "ì•ˆì •ì ìœ¼ë¡œ ìˆ˜ë¦¬í•˜ì£ ."
                    ]
                }
                
                suggestion = random.choice(repair_suggestions.get(personality, 
                    ["ìˆ˜ë¦¬í•´ì•¼ê² ì–´ìš”.", "ê´€ë¦¬ê°€ í•„ìš”í•´ìš”."]))
                print(f"ğŸ’¬ {companion.character.name}: \"{suggestion}\"")

                print(f"ğŸ’¬ {companion.character.name}: \"{suggestion}\"")

    def suggest_equipment_enhancement(self, character: Character):
        """ì¥ë¹„ ê°•í™” ì¶”ì²œ ì‹œìŠ¤í…œ"""
        if not hasattr(character, 'equipment') or not character.equipment:
            return
        
        enhanceable_items = []
        
        # ê°•í™” ê°€ëŠ¥í•œ ì•„ì´í…œ ì°¾ê¸°
        for slot, item in character.equipment.items():
            if not item:
                continue
                
            # ê°•í™” ë ˆë²¨ í™•ì¸ (ê¸°ë³¸ê°’ 0)
            enhancement_level = getattr(item, 'enhancement_level', 0)
            max_enhancement = getattr(item, 'max_enhancement', 10)
            
            if enhancement_level < max_enhancement:
                # ê°•í™” íš¨ê³¼ ê³„ì‚°
                potential_stats = self._calculate_enhancement_potential(item, enhancement_level + 1)
                enhanceable_items.append({
                    'item': item,
                    'slot': slot,
                    'current_level': enhancement_level,
                    'potential_stats': potential_stats,
                    'priority': self._calculate_enhancement_priority(character, item, slot)
                })
        
        if not enhanceable_items:
            return
        
        # ìš°ì„ ìˆœìœ„ ì •ë ¬
        enhanceable_items.sort(key=lambda x: x['priority'], reverse=True)
        
        # AIê°€ ê°•í™” ì¶”ì²œ
        personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
        top_recommendation = enhanceable_items[0]
        
        enhancement_dialogues = {
            CharacterPersonality.CHEERFUL: [
                f"{top_recommendation['item'].name} ê°•í™”í•˜ë©´ ë” ê°•í•´ì§ˆ ê²ƒ ê°™ì•„!",
                f"ì™€! ê°•í™”í•˜ë©´ ì™„ì „ íŒŒì›Œì—…ì´ê² ëŠ”ê±¸?",
                f"ê°•í™” ì‹œìŠ¤í…œ ì¨ë³´ì!"
            ],
            CharacterPersonality.SERIOUS: [
                f"{top_recommendation['item'].name} ê°•í™”ê°€ ì „ëµì ìœ¼ë¡œ ìœ ë¦¬í•˜ë‹¤.",
                f"ê³„ì‚°í•´ë³´ë‹ˆ ê°•í™” íš¨ê³¼ê°€ ì¢‹ê² ë‹¤.",
                f"íš¨ìœ¨ì ì¸ ê°•í™”ê°€ í•„ìš”í•˜ë‹¤."
            ],
            CharacterPersonality.GENTLE: [
                f"{top_recommendation['item'].name} ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ê°•í™”í•´ë³¼ê¹Œìš”?",
                f"ì•ˆì „í•˜ê²Œ ê°•í™”í•˜ë©´ ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”.",
                f"ë¬´ë¦¬í•˜ì§€ ì•ŠëŠ” ì„ ì—ì„œ ê°•í™”í•´ë´ìš”."
            ],
            CharacterPersonality.COLD: [
                f"{top_recommendation['item'].name}... ê°•í™”.",
                f"íš¨ìœ¨ì ì´ë‹¤.",
                f"ê°•í™”í•˜ì."
            ],
            CharacterPersonality.PLAYFUL: [
                f"{top_recommendation['item'].name} ê°•í™” ê²Œì„ í•´ë³´ì!",
                f"ì—…ê·¸ë ˆì´ë“œ íƒ€ì„!",
                f"ê°•í™”í•˜ë©´ ë” ì¿¨í•´ì§ˆ ê±°ì•¼!"
            ],
            CharacterPersonality.MYSTERIOUS: [
                f"ìš´ëª…ì´ {top_recommendation['item'].name}ì˜ ê°•í™”ë¥¼ ì›í•œë‹¤.",
                f"ë³„ë“¤ì´ ê°•í™”ì˜ ì‹œê°„ì„ ì•Œë ¤ì£¼ê³  ìˆë‹¤.",
                f"ì‹ ë¹„ë¡œìš´ í˜ìœ¼ë¡œ ê°•í™”í•˜ì."
            ],
            CharacterPersonality.HOT_TEMPERED: [
                f"{top_recommendation['item'].name} ë¹¨ë¦¬ ê°•í™”í•˜ì!",
                f"ë” ê°•í•˜ê²Œ ë§Œë“¤ì–´ì•¼ê² ì–´!",
                f"ê°•í™”ë¡œ íŒŒì›Œì—…!"
            ],
            CharacterPersonality.WISE: [
                f"{top_recommendation['item'].name} ê°•í™”ê°€ í˜„ëª…í•œ ì„ íƒì´ë‹¤.",
                f"ê²½í—˜ìƒ ì§€ê¸ˆì´ ê°•í™” íƒ€ì´ë°ì´ë‹¤.",
                f"ì§€í˜œë¡­ê²Œ ê°•í™”í•´ë³´ì."
            ],
            CharacterPersonality.BALANCED: [
                f"{top_recommendation['item'].name} ê°•í™”í•´ë³¼ê¹Œìš”?",
                f"ì ì ˆí•œ ê°•í™”ê°€ í•„ìš”í•´ ë³´ì—¬ìš”.",
                f"ê· í˜•ì¡íŒ ê°•í™”ë¥¼ í•´ë´…ì‹œë‹¤."
            ]
        }
        
        dialogue = random.choice(enhancement_dialogues.get(personality, 
            [f"{top_recommendation['item'].name} ê°•í™”ë¥¼ ê³ ë ¤í•´ë³´ì„¸ìš”.", "ê°•í™”í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”."]))
        print(f"\nâœ¨ {character.name}: \"{dialogue}\"")
        
        # ê°•í™” ì •ë³´ ì¶œë ¥
        print(f"   ğŸ¯ ì¶”ì²œ: {top_recommendation['item'].name} (+{top_recommendation['current_level']} â†’ +{top_recommendation['current_level']+1})")
        if top_recommendation['potential_stats']:
            for stat, value in top_recommendation['potential_stats'].items():
                print(f"      {stat}: +{value}")
    
    def _calculate_enhancement_potential(self, item, target_level: int) -> Dict[str, int]:
        """ê°•í™” ì‹œ ì ì¬ ìŠ¤íƒ¯ ê³„ì‚°"""
        potential = {}
        
        # ê¸°ë³¸ ìŠ¤íƒ¯ë“¤
        base_stats = ['attack_power', 'defense', 'magic_power', 'magic_defense', 'accuracy', 'evasion']
        
        for stat in base_stats:
            if hasattr(item, stat):
                base_value = getattr(item, stat, 0)
                if base_value > 0:
                    # ê°•í™” ë ˆë²¨ë‹¹ 5-15% ì¦ê°€
                    enhancement_bonus = int(base_value * (target_level * 0.1))
                    potential[stat] = enhancement_bonus
        
        return potential
    
    def _calculate_enhancement_priority(self, character: Character, item, slot: str) -> float:
        """ê°•í™” ìš°ì„ ìˆœìœ„ ê³„ì‚°"""
        priority = 0.0
        
        # ìŠ¬ë¡¯ë³„ ê¸°ë³¸ ìš°ì„ ìˆœìœ„
        slot_priority = {
            'weapon': 1.0,
            'armor': 0.8,
            'helmet': 0.6,
            'boots': 0.4,
            'accessory': 0.5
        }
        priority += slot_priority.get(slot, 0.3)
        
        # ì§ì—…ë³„ ìš°ì„ ìˆœìœ„
        class_priority = {
            'ì „ì‚¬': {'weapon': 1.2, 'armor': 1.0},
            'ì•„í¬ë©”ì´ì§€': {'weapon': 1.1, 'accessory': 1.0},
            'ê¶ìˆ˜': {'weapon': 1.3, 'boots': 0.8},
            'ë„ì ': {'weapon': 1.1, 'boots': 1.0},
            'í´ë ˆë¦­': {'weapon': 0.9, 'armor': 1.1},
            'ì„±ê¸°ì‚¬': {'weapon': 1.0, 'armor': 1.2}
        }
        
        char_class = getattr(character, 'character_class', 'ì „ì‚¬')
        if char_class in class_priority and slot in class_priority[char_class]:
            priority *= class_priority[char_class][slot]
        
        # í˜„ì¬ ê°•í™” ë ˆë²¨ (ë‚®ì„ìˆ˜ë¡ ìš°ì„ ìˆœìœ„ ë†’ìŒ)
        current_level = getattr(item, 'enhancement_level', 0)
        priority *= (1.0 / (current_level + 1))
        
        return priority
    
    def check_party_equipment_synergy(self, party: List[Character]):
        """íŒŒí‹° ì¥ë¹„ ì‹œë„ˆì§€ ë¶„ì„"""
        synergy_suggestions = []
        
        # ì§ì—… ì¡°í•© ë¶„ì„
        party_classes = [getattr(char, 'character_class', 'ì „ì‚¬') for char in party]
        class_combinations = self._analyze_class_combinations(party_classes)
        
        # ì¶”ì²œ ì‹œë„ˆì§€
        for combination in class_combinations:
            suggestions = self._get_synergy_recommendations(combination, party)
            synergy_suggestions.extend(suggestions)
        
        # AIê°€ ì‹œë„ˆì§€ ì¶”ì²œ
        if synergy_suggestions and self.ai_companions and random.random() < 0.6:
            companion = random.choice(self.ai_companions)
            personality = getattr(companion, 'personality', CharacterPersonality.BALANCED)
            
            top_suggestion = random.choice(synergy_suggestions)
            
            synergy_dialogues = {
                CharacterPersonality.CHEERFUL: [
                    "ìš°ë¦¬ íŒ€ ì¡°í•©ì´ ì™„ì „ ì¢‹ì•„ì§ˆ ê²ƒ ê°™ì•„!",
                    "ì‹œë„ˆì§€ íš¨ê³¼ë¡œ ë” ê°•í•´ì§€ì!",
                    "íŒ€ì›Œí¬ ì¥ë¹„ë¡œ íŒŒì›Œì—…!"
                ],
                CharacterPersonality.SERIOUS: [
                    "ì „ëµì  ì¥ë¹„ ì¡°í•©ì„ ê³ ë ¤í•´ë³´ì.",
                    "íŒ€ ì‹œë„ˆì§€ ìµœì í™”ê°€ í•„ìš”í•˜ë‹¤.",
                    "ê³„ì‚°ëœ ì¥ë¹„ ë°°ì¹˜ê°€ ì¤‘ìš”í•˜ë‹¤."
                ],
                CharacterPersonality.WISE: [
                    "íŒ€ì˜ ì¡°í™”ë¥¼ ê³ ë ¤í•œ ì¥ë¹„ê°€ í˜„ëª…í•˜ë‹¤.",
                    "ê²½í—˜ìƒ ì‹œë„ˆì§€ê°€ ìŠ¹ë¦¬ì˜ ì—´ì‡ ë‹¤.",
                    "ì§€í˜œë¡œìš´ ì¥ë¹„ ì„ íƒì´ í•„ìš”í•˜ë‹¤."
                ],
                CharacterPersonality.PLAYFUL: [
                    "íŒ€ ì½”ë””ë„¤ì´ì…˜ ê²Œì„ í•´ë³´ì!",
                    "ì‹œë„ˆì§€ ì½¤ë³´ ì™„ì„±í•˜ì!",
                    "ì™„ì „ ì¿¨í•œ íŒ€ ì„¸íŒ…!"
                ]
            }
            
            dialogue = random.choice(synergy_dialogues.get(personality, 
                ["íŒ€ ì‹œë„ˆì§€ë¥¼ ê³ ë ¤í•´ë´ìš”.", "ì¡°í•©ì„ ë§ì¶°ë³´ë©´ ì¢‹ê² ì–´ìš”."]))
            print(f"\nğŸ”— {companion.character.name}: \"{dialogue}\"")
            print(f"   ğŸ’¡ {top_suggestion}")
    
    def _analyze_class_combinations(self, party_classes: List[str]) -> List[str]:
        """ì§ì—… ì¡°í•© ë¶„ì„"""
        combinations = []
        
        # ì „í˜•ì ì¸ ì¡°í•©ë“¤
        if 'ì „ì‚¬' in party_classes and 'í´ë ˆë¦­' in party_classes:
            combinations.append('íƒ±ì»¤-íëŸ¬')
        
        if 'ì•„í¬ë©”ì´ì§€' in party_classes and 'ì „ì‚¬' in party_classes:
            combinations.append('ë§ˆë²•-ë¬¼ë¦¬')
        
        if 'ê¶ìˆ˜' in party_classes and 'ë„ì ' in party_classes:
            combinations.append('ì›ê±°ë¦¬-ê·¼ê±°ë¦¬')
        
        if 'ì„±ê¸°ì‚¬' in party_classes:
            combinations.append('ì„±ê¸°ì‚¬-ì¤‘ì‹¬')
        
        return combinations
    
    def _get_synergy_recommendations(self, combination: str, party: List[Character]) -> List[str]:
        """ì‹œë„ˆì§€ ì¶”ì²œì‚¬í•­"""
        recommendations = []
        
        synergy_map = {
            'íƒ±ì»¤-íëŸ¬': [
                "ì „ì‚¬ëŠ” ë°©ì–´ë ¥ ê°•í™”, í´ë ˆë¦­ì€ íšŒë³µë ¥ ê°•í™” ì¶”ì²œ",
                "HP ì¦ê°€ ì¥ë¹„ë¡œ ìƒì¡´ë ¥ í–¥ìƒ",
                "ë°©ì–´êµ¬ ì„¸íŠ¸ íš¨ê³¼ í™œìš©"
            ],
            'ë§ˆë²•-ë¬¼ë¦¬': [
                "ë§ˆë²•ì‚¬ëŠ” ë§ˆë ¥ ì¦ê°€, ì „ì‚¬ëŠ” ê³µê²©ë ¥ ì¦ê°€",
                "ì†ì„± ì €í•­ ì¥ë¹„ë¡œ ê· í˜• ë§ì¶”ê¸°",
                "MP íšŒë³µ ì•„ì´í…œ ê³µìœ "
            ],
            'ì›ê±°ë¦¬-ê·¼ê±°ë¦¬': [
                "ê¶ìˆ˜ëŠ” ì •í™•ë„, ë„ì ì€ íšŒí”¼ìœ¨ ê°•í™”",
                "ì´ë™ì†ë„ ì¦ê°€ ì¥ë¹„ ê³µìœ ",
                "í¬ë¦¬í‹°ì»¬ í™•ë¥  í–¥ìƒ"
            ],
            'ì„±ê¸°ì‚¬-ì¤‘ì‹¬': [
                "ì„±ê¸°ì‚¬ ì¤‘ì‹¬ì˜ ë°©ì–´ ì „ìˆ ",
                "ì‹ ì„± ê³„ì—´ ì¥ë¹„ ì‹œë„ˆì§€",
                "íŒ€ ì „ì²´ ë°©ì–´ë ¥ í–¥ìƒ"
            ]
        }
        
        return synergy_map.get(combination, [])

        return synergy_map.get(combination, [])

    def smart_equipment_recommendation(self, character: Character, available_items: List = None):
        """í˜„ì¬ ìƒí™©ê³¼ ìŠ¤íƒ¯ì„ ê³ ë ¤í•œ ìŠ¤ë§ˆíŠ¸ ì¥ë¹„ ì¶”ì²œ"""
        if not available_items:
            available_items = []  # ì‹¤ì œë¡œëŠ” ì¸ë²¤í† ë¦¬ë‚˜ ìƒì  ì•„ì´í…œ
        
        # í˜„ì¬ ìºë¦­í„° ìƒíƒœ ë¶„ì„
        current_stats = self._analyze_character_stats(character)
        weak_points = self._identify_weak_points(character, current_stats)
        
        # ì¶”ì²œ ìš°ì„ ìˆœìœ„ ê³„ì‚°
        recommendations = []
        
        for item in available_items:
            if not self._is_equippable(character, item):
                continue
                
            score = self._calculate_item_score(character, item, weak_points)
            recommendations.append({
                'item': item,
                'score': score,
                'reasons': self._get_recommendation_reasons(character, item, weak_points)
            })
        
        # ì ìˆ˜ìˆœ ì •ë ¬
        recommendations.sort(key=lambda x: x['score'], reverse=True)
        
        # AIê°€ ì¶”ì²œ ì œì‹œ
        if recommendations and self.ai_companions:
            personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
            top_rec = recommendations[0]
            
            recommendation_dialogues = {
                CharacterPersonality.CHEERFUL: [
                    f"{top_rec['item'].name} ì–´ë•Œ? ì™„ì „ ì¢‹ì„ ê²ƒ ê°™ì•„!",
                    f"ì´ê±° ì°©ìš©í•˜ë©´ ë” ê°•í•´ì§ˆ ê±°ì•¼!",
                    f"ì™„ì „ ì¶”ì²œ ì•„ì´í…œì´ì•¼!"
                ],
                CharacterPersonality.SERIOUS: [
                    f"{top_rec['item'].name}ì´ ì „ëµì ìœ¼ë¡œ ìµœì ì´ë‹¤.",
                    f"ë¶„ì„ ê²°ê³¼ ì´ ì¥ë¹„ê°€ ê°€ì¥ íš¨ìœ¨ì ì´ë‹¤.",
                    f"ê³„ì‚°í•´ë³´ë‹ˆ ì´ê²Œ ìµœì„ ì´ë‹¤."
                ],
                CharacterPersonality.GENTLE: [
                    f"{top_rec['item'].name} ì–´ë– ì„¸ìš”?",
                    f"ì´ ì¥ë¹„ê°€ ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”.",
                    f"ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ì¶”ì²œë“œë ¤ìš”."
                ],
                CharacterPersonality.COLD: [
                    f"{top_rec['item'].name}... ìµœì .",
                    f"ì´ê±¸ë¡œ í•˜ì.",
                    f"íš¨ìœ¨ì ì´ë‹¤."
                ],
                CharacterPersonality.PLAYFUL: [
                    f"{top_rec['item'].name} ì™„ì „ ì¿¨í•´!",
                    f"ì´ê±° ì°©ìš©í•˜ë©´ ê²Œì„ ë!",
                    f"ì™„ì „ ë ˆì–´í…œ ëŠë‚Œ!"
                ],
                CharacterPersonality.MYSTERIOUS: [
                    f"ìš´ëª…ì´ {top_rec['item'].name}ì„ ì„ íƒí–ˆë‹¤.",
                    f"ë³„ë“¤ì´ ì´ ì¥ë¹„ë¥¼ ê°€ë¦¬í‚¤ê³  ìˆë‹¤.",
                    f"ì‹ ë¹„ë¡œìš´ í˜ì´ ëŠê»´ì§„ë‹¤."
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    f"{top_rec['item'].name} ì´ê±°ë‹¤!",
                    f"ë¹¨ë¦¬ ì°©ìš©í•˜ì!",
                    f"ì™„ì „ ëŒ€ë°• ì•„ì´í…œ!"
                ],
                CharacterPersonality.WISE: [
                    f"{top_rec['item'].name}ì´ í˜„ëª…í•œ ì„ íƒì´ë‹¤.",
                    f"ê²½í—˜ìƒ ì´ ì¥ë¹„ê°€ ìµœê³ ë‹¤.",
                    f"ì§€í˜œë¡œìš´ íŒë‹¨ì´ í•„ìš”í•œ ìˆœê°„ì´ë‹¤."
                ],
                CharacterPersonality.BALANCED: [
                    f"{top_rec['item'].name} ê´œì°®ì€ ì„ íƒì´ì—ìš”.",
                    f"ê· í˜•ì¡íŒ ìŠ¤íƒ¯ í–¥ìƒì´ ê¸°ëŒ€ë¼ìš”.",
                    f"ì ì ˆí•œ ì—…ê·¸ë ˆì´ë“œê°€ ë  ê²ƒ ê°™ì•„ìš”."
                ]
            }
            
            dialogue = random.choice(recommendation_dialogues.get(personality, 
                [f"{top_rec['item'].name} ì¶”ì²œë“œë ¤ìš”.", "ì´ ì¥ë¹„ ì–´ë– ì„¸ìš”?"]))
            print(f"\nğŸ¯ {character.name}: \"{dialogue}\"")
            
            # ì¶”ì²œ ì´ìœ  ì¶œë ¥
            for reason in top_rec['reasons'][:3]:  # ìƒìœ„ 3ê°œ ì´ìœ ë§Œ
                print(f"   ğŸ’¡ {reason}")
    
    def _analyze_character_stats(self, character: Character) -> Dict[str, float]:
        """ìºë¦­í„° í˜„ì¬ ìŠ¤íƒ¯ ë¶„ì„"""
        stats = {}
        
        # ê¸°ë³¸ ìŠ¤íƒ¯ë“¤
        basic_stats = ['attack_power', 'defense', 'magic_power', 'magic_defense', 
                      'accuracy', 'evasion', 'max_hp', 'max_mp']
        
        for stat in basic_stats:
            stats[stat] = getattr(character, stat, 0)
        
        # ì§ì—…ë³„ ê¸°ì¤€ì¹˜ ê³„ì‚°
        class_standards = self._get_class_stat_standards(character.character_class)
        
        # í˜„ì¬ ë ˆë²¨ ëŒ€ë¹„ ìƒëŒ€ì  ìŠ¤íƒ¯
        level = getattr(character, 'level', 1)
        for stat in stats:
            expected = class_standards.get(stat, 0) * level
            if expected > 0:
                stats[f"{stat}_ratio"] = stats[stat] / expected
            else:
                stats[f"{stat}_ratio"] = 1.0
        
        return stats
    
    def _identify_weak_points(self, character: Character, stats: Dict[str, float]) -> List[str]:
        """ì•½ì  ì‹ë³„"""
        weak_points = []
        
        # ë¹„ìœ¨ì´ 0.8 ì´í•˜ì¸ ìŠ¤íƒ¯ì„ ì•½ì ìœ¼ë¡œ ì‹ë³„
        for stat, value in stats.items():
            if stat.endswith('_ratio') and value < 0.8:
                base_stat = stat.replace('_ratio', '')
                weak_points.append(base_stat)
        
        # ì§ì—…ë³„ í•µì‹¬ ìŠ¤íƒ¯ ë¶€ì¡± í™•ì¸
        class_core_stats = {
            'ì „ì‚¬': ['attack_power', 'defense', 'max_hp'],
            'ì•„í¬ë©”ì´ì§€': ['magic_power', 'max_mp', 'magic_defense'],
            'ê¶ìˆ˜': ['attack_power', 'accuracy', 'evasion'],
            'ë„ì ': ['attack_power', 'evasion', 'accuracy'],
            'í´ë ˆë¦­': ['magic_power', 'max_mp', 'defense'],
            'ì„±ê¸°ì‚¬': ['attack_power', 'defense', 'magic_defense']
        }
        
        char_class = getattr(character, 'character_class', 'ì „ì‚¬')
        core_stats = class_core_stats.get(char_class, [])
        
        for stat in core_stats:
            if f"{stat}_ratio" in stats and stats[f"{stat}_ratio"] < 0.9:
                if stat not in weak_points:
                    weak_points.append(stat)
        
        return weak_points
    
    def _get_class_stat_standards(self, character_class: str) -> Dict[str, float]:
        """ì§ì—…ë³„ ìŠ¤íƒ¯ ê¸°ì¤€ì¹˜"""
        standards = {
            'ì „ì‚¬': {
                'attack_power': 10.0, 'defense': 8.0, 'max_hp': 20.0,
                'magic_power': 3.0, 'magic_defense': 5.0, 'max_mp': 8.0,
                'accuracy': 6.0, 'evasion': 4.0
            },
            'ì•„í¬ë©”ì´ì§€': {
                'attack_power': 4.0, 'defense': 4.0, 'max_hp': 12.0,
                'magic_power': 12.0, 'magic_defense': 8.0, 'max_mp': 25.0,
                'accuracy': 5.0, 'evasion': 6.0
            },
            'ê¶ìˆ˜': {
                'attack_power': 9.0, 'defense': 5.0, 'max_hp': 15.0,
                'magic_power': 4.0, 'magic_defense': 5.0, 'max_mp': 10.0,
                'accuracy': 10.0, 'evasion': 8.0
            },
            'ë„ì ': {
                'attack_power': 8.0, 'defense': 4.0, 'max_hp': 14.0,
                'magic_power': 3.0, 'magic_defense': 4.0, 'max_mp': 8.0,
                'accuracy': 9.0, 'evasion': 12.0
            },
            'í´ë ˆë¦­': {
                'attack_power': 5.0, 'defense': 6.0, 'max_hp': 16.0,
                'magic_power': 10.0, 'magic_defense': 7.0, 'max_mp': 22.0,
                'accuracy': 6.0, 'evasion': 5.0
            },
            'ì„±ê¸°ì‚¬': {
                'attack_power': 8.0, 'defense': 9.0, 'max_hp': 18.0,
                'magic_power': 6.0, 'magic_defense': 8.0, 'max_mp': 15.0,
                'accuracy': 7.0, 'evasion': 5.0
            }
        }
        
        return standards.get(character_class, standards['ì „ì‚¬'])
    
    def _is_equippable(self, character: Character, item) -> bool:
        """ì¥ë¹„ ì°©ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸"""
        # ë ˆë²¨ ì œí•œ
        if hasattr(item, 'required_level'):
            if getattr(character, 'level', 1) < item.required_level:
                return False
        
        # ì§ì—… ì œí•œ
        if hasattr(item, 'required_class'):
            char_class = getattr(character, 'character_class', 'ì „ì‚¬')
            if char_class not in item.required_class:
                return False
        
        return True
    
    def _calculate_item_score(self, character: Character, item, weak_points: List[str]) -> float:
        """ì•„ì´í…œ ì ìˆ˜ ê³„ì‚°"""
        score = 0.0
        
        # ê¸°ë³¸ ìŠ¤íƒ¯ í–¥ìƒ ì ìˆ˜
        item_stats = ['attack_power', 'defense', 'magic_power', 'magic_defense',
                     'accuracy', 'evasion', 'max_hp', 'max_mp']
        
        for stat in item_stats:
            if hasattr(item, stat):
                stat_value = getattr(item, stat, 0)
                if stat_value > 0:
                    # ì•½ì  ìŠ¤íƒ¯ì´ë©´ ê°€ì¤‘ì¹˜ 2ë°°
                    multiplier = 2.0 if stat in weak_points else 1.0
                    score += stat_value * multiplier
        
        # ì§ì—… ì í•©ì„± ë³´ë„ˆìŠ¤
        char_class = getattr(character, 'character_class', 'ì „ì‚¬')
        class_bonus = self._get_class_item_bonus(char_class, item)
        score *= (1.0 + class_bonus)
        
        # í˜„ì¬ ì¥ë¹„ì™€ ë¹„êµ
        current_item = self._get_current_item_in_slot(character, item)
        if current_item:
            improvement = self._calculate_improvement(current_item, item)
            score *= (1.0 + improvement)
        
        return score
    
    def _get_class_item_bonus(self, character_class: str, item) -> float:
        """ì§ì—…ë³„ ì•„ì´í…œ ë³´ë„ˆìŠ¤"""
        item_type = getattr(item, 'item_type', 'unknown')
        
        class_bonuses = {
            'ì „ì‚¬': {'weapon': 0.3, 'armor': 0.2, 'shield': 0.2},
            'ì•„í¬ë©”ì´ì§€': {'staff': 0.3, 'robe': 0.2, 'accessory': 0.2},
            'ê¶ìˆ˜': {'bow': 0.3, 'leather_armor': 0.2, 'boots': 0.1},
            'ë„ì ': {'dagger': 0.3, 'leather_armor': 0.2, 'boots': 0.2},
            'í´ë ˆë¦­': {'staff': 0.2, 'robe': 0.2, 'accessory': 0.3},
            'ì„±ê¸°ì‚¬': {'sword': 0.2, 'armor': 0.3, 'shield': 0.2}
        }
        
        return class_bonuses.get(character_class, {}).get(item_type, 0.0)
    
    def _get_current_item_in_slot(self, character: Character, new_item):
        """í•´ë‹¹ ìŠ¬ë¡¯ì˜ í˜„ì¬ ì•„ì´í…œ ë°˜í™˜"""
        if not hasattr(character, 'equipment'):
            return None
        
        item_slot = getattr(new_item, 'slot', 'unknown')
        return character.equipment.get(item_slot)
    
    def _calculate_improvement(self, current_item, new_item) -> float:
        """ì•„ì´í…œ ê°œì„ ë„ ê³„ì‚°"""
        if not current_item:
            return 1.0  # 100% ê°œì„  (ë¹ˆ ìŠ¬ë¡¯)
        
        improvement = 0.0
        stats = ['attack_power', 'defense', 'magic_power', 'magic_defense',
                'accuracy', 'evasion', 'max_hp', 'max_mp']
        
        for stat in stats:
            current_value = getattr(current_item, stat, 0)
            new_value = getattr(new_item, stat, 0)
            
            if current_value > 0:
                improvement += (new_value - current_value) / current_value
        
        return max(0.0, improvement / len(stats))
    
    def _get_recommendation_reasons(self, character: Character, item, weak_points: List[str]) -> List[str]:
        """ì¶”ì²œ ì´ìœ  ìƒì„±"""
        reasons = []
        
        # ì•½ì  ë³´ì™„
        item_stats = ['attack_power', 'defense', 'magic_power', 'magic_defense',
                     'accuracy', 'evasion', 'max_hp', 'max_mp']
        
        for stat in item_stats:
            if hasattr(item, stat) and getattr(item, stat, 0) > 0:
                if stat in weak_points:
                    reasons.append(f"{stat} ì•½ì  ë³´ì™„")
        
        # ì§ì—… ì í•©ì„±
        char_class = getattr(character, 'character_class', 'ì „ì‚¬')
        item_type = getattr(item, 'item_type', 'unknown')
        
        class_suitable_types = {
            'ì „ì‚¬': ['weapon', 'armor', 'shield'],
            'ì•„í¬ë©”ì´ì§€': ['staff', 'robe', 'accessory'],
            'ê¶ìˆ˜': ['bow', 'leather_armor', 'boots'],
            'ë„ì ': ['dagger', 'leather_armor', 'boots'],
            'í´ë ˆë¦­': ['staff', 'robe', 'accessory'],
            'ì„±ê¸°ì‚¬': ['sword', 'armor', 'shield']
        }
        
        if item_type in class_suitable_types.get(char_class, []):
            reasons.append(f"{char_class}ì—ê²Œ ìµœì í™”ëœ ì¥ë¹„")
        
        # íŠ¹ìˆ˜ íš¨ê³¼
        if hasattr(item, 'special_effects'):
            reasons.append("íŠ¹ìˆ˜ íš¨ê³¼ ë³´ìœ ")
        
        if not reasons:
            reasons.append("ì „ì²´ì ì¸ ëŠ¥ë ¥ì¹˜ í–¥ìƒ")
        
        return reasons

        return reasons

    def integrate_with_combat_system(self, combat_system):
        """ì „íˆ¬ ì‹œìŠ¤í…œê³¼ì˜ ì™„ì „ í†µí•©"""
        # ì „íˆ¬ ì‹œìŠ¤í…œì— AI ê²Œì„ëª¨ë“œ ì—°ê²°
        combat_system.ai_game_mode = self
        
        # ì „íˆ¬ ì „ ì¥ë¹„ ì ê²€
        self.pre_combat_check = True
        
        # ì „íˆ¬ í›„ ì‹œìŠ¤í…œë“¤ ì‹¤í–‰
        self.post_combat_analysis = True
        
        print("âœ… AI ê²Œì„ëª¨ë“œê°€ ì „íˆ¬ ì‹œìŠ¤í…œê³¼ ì™„ì „ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.")
    
    def pre_combat_equipment_check(self, party: List[Character]):
        """ì „íˆ¬ ì „ ì¥ë¹„ ìƒíƒœ ì ê²€"""
        print("\nğŸ” ì „íˆ¬ ì „ ì¥ë¹„ ì ê²€...")
        
        # ë‚´êµ¬ë„ ì ê²€
        durability_warnings = self.check_equipment_durability(party)
        
        # ì¹˜ëª…ì  ë‚´êµ¬ë„ ë¬¸ì œê°€ ìˆìœ¼ë©´ ê²½ê³ 
        critical_items = [w for w in durability_warnings if w['level'] == 'critical']
        if critical_items:
            print("ğŸ¤– ë¡œ-ë°”íŠ¸ ê¸´ê¸‰ ê²½ê³ : ì¹˜ëª…ì  ë‚´êµ¬ë„ ë¬¸ì œ ë°œê²¬!")
            for warning in critical_items:
                char = warning['character']
                item = warning['item']
                print(f"   âš ï¸ {char.name}ì˜ {item.name}: {warning['durability']:.1f}% (ë¡œ-ë°”íŠ¸ ì§„ë‹¨: ë§¤ìš° ìœ„í—˜!)")
            
            # AIê°€ ì „íˆ¬ ì „ ì¡°ì–¸
            if self.ai_companions and random.random() < 0.8:
                advisor = random.choice(self.ai_companions)
                personality = getattr(advisor, 'personality', CharacterPersonality.BALANCED)
                
                advice_dialogues = {
                    CharacterPersonality.SERIOUS: [
                        "ì „íˆ¬ ì „ì— ì¥ë¹„ë¥¼ ì ê²€í•˜ëŠ” ê²Œ ì¢‹ê² ë‹¤.",
                        "ìœ„í—˜í•œ ìƒíƒœì˜ ì¥ë¹„ê°€ ìˆë‹¤.",
                        "ì „ìˆ ì ìœ¼ë¡œ ë¶ˆë¦¬í•  ìˆ˜ ìˆë‹¤."
                    ],
                    CharacterPersonality.CHEERFUL: [
                        "ì–´? ì¥ë¹„ê°€ ì¢€ ìœ„í—˜í•´ ë³´ì—¬!",
                        "ì „íˆ¬ ì „ì— ì±™ê²¨ì•¼ í•  ê²ƒ ê°™ì•„!",
                        "ê´œì°®ì„ê¹Œ? ê±±ì •ë˜ë„¤!"
                    ],
                    CharacterPersonality.WISE: [
                        "í˜„ëª…í•œ ì „ì‚¬ëŠ” ì¥ë¹„ë¥¼ ë¨¼ì € ì ê²€í•œë‹¤.",
                        "ê²½í—˜ìƒ ì§€ê¸ˆ ìˆ˜ë¦¬í•˜ëŠ” ê²Œ ì¢‹ê² ë‹¤.",
                        "ì¤€ë¹„ê°€ ìŠ¹ë¦¬ì˜ ì ˆë°˜ì´ë‹¤."
                    ]
                }
                
                advice = random.choice(advice_dialogues.get(personality, 
                    ["ì¥ë¹„ ìƒíƒœë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.", "ì „íˆ¬ ì „ ì ê²€ì´ í•„ìš”í•´ìš”."]))
                print(f"ğŸ’¬ {advisor.character.name}: \"{advice}\"")
        
        # íŒŒí‹° ì‹œë„ˆì§€ ì ê²€
        self.check_party_equipment_synergy(party)
    
    def post_combat_analysis(self, party: List[Character], battle_result: str):
        """ì „íˆ¬ í›„ ë¶„ì„ ë° ì¶”ì²œ"""
        print(f"\nğŸ“Š ì „íˆ¬ í›„ ë¶„ì„ (ê²°ê³¼: {battle_result})")
        
        # ìŠ¹ë¦¬ ì‹œ ë¶„ì„
        if battle_result == "victory":
            # ì „íˆ¬ ìŠ¹ë¦¬ ëŒ€ì‚¬ íŠ¸ë¦¬ê±°
            self.trigger_situational_dialogue("combat_victory")
            
            # ì¥ë¹„ ë‚´êµ¬ë„ ê°ì†Œ ì²´í¬
            self._check_post_combat_durability(party)
            
            # ê°•í™” ì¶”ì²œ (30% í™•ë¥ )
            if random.random() < 0.3:
                for character in party:
                    if random.random() < 0.4:  # ê° ìºë¦­í„°ë‹¹ 40% í™•ë¥ 
                        self.suggest_equipment_enhancement(character)
        
        # íŒ¨ë°° ì‹œ ë¶„ì„
        elif battle_result == "defeat":
            self._analyze_defeat_reasons(party)
        
        # ì „íˆ¬ ì¤‘ í˜‘ë™ê³µê²© í†µê³„ (ë§Œì•½ ìˆë‹¤ë©´)
        self._show_coordination_stats()
    
    def _check_post_combat_durability(self, party: List[Character]):
        """ì „íˆ¬ í›„ ë‚´êµ¬ë„ ê°ì†Œ ì²´í¬"""
        for character in party:
            if not hasattr(character, 'equipment') or not character.equipment:
                continue
            
            for slot, item in character.equipment.items():
                if not item or not hasattr(item, 'durability'):
                    continue
                
                # ì „íˆ¬ë¡œ ì¸í•œ ë‚´êµ¬ë„ ê°ì†Œ ì‹œë®¬ë ˆì´ì…˜ (1-3 ê°ì†Œ)
                durability_loss = random.randint(1, 3)
                original_durability = getattr(item, 'durability', 100)
                item.durability = max(0, original_durability - durability_loss)
                
                # ë‚´êµ¬ë„ê°€ í¬ê²Œ ê°ì†Œí•œ ê²½ìš° ì•Œë¦¼
                durability_percent = (item.durability / getattr(item, 'max_durability', 100)) * 100
                if durability_percent <= 15 and random.random() < 0.5:
                    personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
                    
                    concern_dialogues = {
                        CharacterPersonality.CHEERFUL: [
                            f"ğŸ¤– ë¡œ-ë°”íŠ¸ ì•Œë¦¼: {item.name}ì´ ë§ì´ ë‹³ì•˜ë„¤!",
                            f"ì „íˆ¬ê°€ ê²©ë ¬í–ˆë‚˜ë´! ë¡œ-ë°”íŠ¸ë„ ë†€ëì–´!",
                            f"ê³§ ìˆ˜ë¦¬í•´ì•¼ê² ì–´! ë‚´ ì§„ë‹¨ì´ ë§ë‹¤ë‹ˆê¹Œ!"
                        ],
                        CharacterPersonality.SERIOUS: [
                            f"ğŸ” ë¡œ-ë°”íŠ¸ ë¶„ì„: {item.name}ì˜ ë‚´êµ¬ë„ ì €í•˜ë¥¼ í™•ì¸í–ˆë‹¤.",
                            f"ë¡œ-ë°”íŠ¸ ê¶Œê³ : ì •ë¹„ê°€ í•„ìš”í•œ ìƒíƒœë‹¤.",
                            f"âš ï¸ ë¡œ-ë°”íŠ¸ ê²½ê³ : ì „íˆ¬ íš¨ìœ¨ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆë‹¤."
                        ],
                        CharacterPersonality.COLD: [
                            f"ğŸ¤– {item.name}... ë¡œ-ë°”íŠ¸ ì§„ë‹¨ ê²°ê³¼ ì†ìƒë¨.",
                            f"ë¡œ-ë°”íŠ¸ ê¶Œê³ : ìˆ˜ë¦¬ í•„ìš”.",
                            f"ë¡œ-ë°”íŠ¸ ì œì•ˆ: êµì²´ ê³ ë ¤."
                        ]
                    }
                    
                    dialogue = random.choice(concern_dialogues.get(personality, 
                        [f"{item.name} ìƒíƒœê°€ ê±±ì •ë˜ë„¤ìš”.", "ì ê²€ì´ í•„ìš”í•´ìš”."]))
                    print(f"ğŸ”§ {character.name}: \"{dialogue}\"")
    
    def _analyze_defeat_reasons(self, party: List[Character]):
        """íŒ¨ë°° ì›ì¸ ë¶„ì„"""
        print("ğŸ’­ íŒ¨ë°° ì›ì¸ ë¶„ì„ ì¤‘...")
        
        # ì¥ë¹„ ë¶€ì¡± ë¶„ì„
        equipment_issues = []
        for character in party:
            weak_points = self._identify_weak_points(character, self._analyze_character_stats(character))
            if weak_points:
                equipment_issues.append((character, weak_points))
        
        if equipment_issues and self.ai_companions:
            analyst = random.choice(self.ai_companions)
            personality = getattr(analyst, 'personality', CharacterPersonality.BALANCED)
            
            analysis_dialogues = {
                CharacterPersonality.WISE: [
                    "íŒ¨ë°°ì—ì„œ ë°°ìš¸ ì ì´ ìˆë‹¤.",
                    "ì¥ë¹„ ë³´ì™„ì´ í•„ìš”í•´ ë³´ì¸ë‹¤.",
                    "ê²½í—˜ì„ í†µí•´ ë” ê°•í•´ì§ˆ ìˆ˜ ìˆë‹¤."
                ],
                CharacterPersonality.SERIOUS: [
                    "ì „ë ¥ ë¶„ì„ì´ í•„ìš”í•˜ë‹¤.",
                    "ì¥ë¹„ ê°œì„  ì‚¬í•­ì„ íŒŒì•…í–ˆë‹¤.",
                    "ë‹¤ìŒ ì „íˆ¬ë¥¼ ìœ„í•œ ì¤€ë¹„ê°€ í•„ìš”í•˜ë‹¤."
                ],
                CharacterPersonality.CHEERFUL: [
                    "ë‹¤ìŒì—” ë” ì˜í•  ìˆ˜ ìˆì„ ê±°ì•¼!",
                    "ì¥ë¹„ ì—…ê·¸ë ˆì´ë“œí•˜ë©´ ì´ê¸¸ ìˆ˜ ìˆì–´!",
                    "í¬ê¸°í•˜ì§€ ë§ê³  ì¤€ë¹„í•˜ì!"
                ]
            }
            
            analysis = random.choice(analysis_dialogues.get(personality, 
                ["ë‹¤ìŒì„ ìœ„í•´ ì¤€ë¹„í•´ë´ìš”.", "ê°œì„ ì ì„ ì°¾ì•„ë´…ì‹œë‹¤."]))
            print(f"ğŸ’¡ {analyst.character.name}: \"{analysis}\"")
            
            # êµ¬ì²´ì  ê°œì„ ì‚¬í•­ ì œì‹œ
            for character, weak_points in equipment_issues[:2]:  # ìƒìœ„ 2ëª…ë§Œ
                print(f"   ğŸ¯ {character.name}: {', '.join(weak_points)} ë³´ì™„ í•„ìš”")
    
    def _show_coordination_stats(self):
        """í˜‘ë™ê³µê²© í†µê³„ í‘œì‹œ"""
        # ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì „íˆ¬ ì¤‘ í˜‘ë™ê³µê²© ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•´ì•¼ í•¨
        if hasattr(self, 'coordination_count') and self.coordination_count > 0:
            print(f"âš¡ í˜‘ë™ê³µê²© ì‹¤í–‰: {self.coordination_count}íšŒ")
            
            if self.ai_companions and random.random() < 0.6:
                commentator = random.choice(self.ai_companions)
                personality = getattr(commentator, 'personality', CharacterPersonality.BALANCED)
                
                coord_comments = {
                    CharacterPersonality.CHEERFUL: [
                        "ìš°ë¦¬ íŒ€ì›Œí¬ ì™„ì „ ìµœê³ ì˜€ì–´!",
                        "í˜‘ë™ê³µê²©ì´ ì •ë§ ë©‹ì¡Œì–´!",
                        "ë‹¤ìŒì—ë„ ì´ë ‡ê²Œ í•˜ì!"
                    ],
                    CharacterPersonality.SERIOUS: [
                        "íš¨ê³¼ì ì¸ í˜‘ë™ ì „ìˆ ì´ì—ˆë‹¤.",
                        "íŒ€ì›Œí¬ê°€ ìŠ¹ë¦¬ì˜ ì—´ì‡ ì˜€ë‹¤.",
                        "ì „ëµì  í˜‘ë ¥ì´ ì„±ê³µí–ˆë‹¤."
                    ],
                    CharacterPersonality.WISE: [
                        "í˜‘ë ¥ì˜ ê°€ì¹˜ë¥¼ í™•ì¸í–ˆë‹¤.",
                        "í•¨ê»˜í•˜ëŠ” í˜ì´ ìœ„ëŒ€í•˜ë‹¤.",
                        "ì¡°í™”ë¡œìš´ ì „íˆ¬ì˜€ë‹¤."
                    ]
                }
                
                comment = random.choice(coord_comments.get(personality, 
                    ["ì¢‹ì€ í˜‘ë ¥ì´ì—ˆì–´ìš”.", "íŒ€ì›Œí¬ê°€ í›Œë¥­í–ˆì–´ìš”."]))
                print(f"ğŸ’¬ {commentator.character.name}: \"{comment}\"")
    
    def periodic_equipment_maintenance(self, party: List[Character]):
        """ì£¼ê¸°ì  ì¥ë¹„ ê´€ë¦¬ ì‹œìŠ¤í…œ"""
        # í•„ë“œì—ì„œ 5% í™•ë¥ ë¡œ ì¥ë¹„ ìƒíƒœ ì²´í¬
        if random.random() < 0.05:
            print("\nğŸ”§ ì¥ë¹„ ìƒíƒœ ì ê²€ ì‹œê°„...")
            
            # ë‚´êµ¬ë„ ì²´í¬
            warnings = self.check_equipment_durability(party)
            
            # ê°•í™” ì¶”ì²œ (ë‚®ì€ í™•ë¥ )
            if random.random() < 0.3:
                character = random.choice(party)
                self.suggest_equipment_enhancement(character)
            
            # íŒŒí‹° ì‹œë„ˆì§€ ì²´í¬ (ë‚®ì€ í™•ë¥ )
            if random.random() < 0.2:
                self.check_party_equipment_synergy(party)
    
    def emergency_equipment_alert(self, character: Character, item):
        """ê¸´ê¸‰ ì¥ë¹„ ê²½ê³ """
        if not item or not hasattr(item, 'durability'):
            return
        
        durability_percent = (item.durability / getattr(item, 'max_durability', 100)) * 100
        
        if durability_percent <= 5:  # 5% ì´í•˜ ì‹œ ê¸´ê¸‰ ê²½ê³ 
            personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
            
            emergency_dialogues = {
                CharacterPersonality.CHEERFUL: [
                    f"ì–´? {item.name}ì´ ê±°ì˜ ë¶€ì„œì ¸ê°€ê³  ìˆì–´!",
                    f"í°ì¼ì´ì•¼! ë¹¨ë¦¬ ë­”ê°€ í•´ì•¼ê² ì–´!"
                ],
                CharacterPersonality.SERIOUS: [
                    f"ê¸´ê¸‰ìƒí™©! {item.name} ì¦‰ì‹œ êµì²´ í•„ìš”!",
                    f"ì „íˆ¬ ë¶ˆê°€ ìƒíƒœì— ë„ë‹¬í–ˆë‹¤!"
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    f"ì  ì¥! {item.name}ì´ ì™„ì „íˆ ë§ê°€ì¡Œì–´!",
                    f"ì´ëŸ° ìƒíƒœë¡œëŠ” ëª» ì‹¸ì›Œ!"
                ],
                CharacterPersonality.COLD: [
                    f"{item.name}... í•œê³„ë‹¤.",
                    f"ì¦‰ì‹œ êµì²´."
                ]
            }
            
            dialogue = random.choice(emergency_dialogues.get(personality, 
                [f"{item.name} ê¸´ê¸‰ ìƒí™©!", "ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš”!"]))
            print(f"\nğŸš¨ {character.name}: \"{dialogue}\"")
            
            return True  # ê¸´ê¸‰ ìƒí™© í”Œë˜ê·¸
        
        return False

        return False

    def run_integrated_ai_systems(self, party: List[Character], context: str = "field"):
        """í†µí•© AI ì‹œìŠ¤í…œ ì‹¤í–‰ - ëª¨ë“  ì‹œìŠ¤í…œì„ ì¡°ìœ¨"""
        
        # 1. ì£¼ê¸°ì  ì¥ë¹„ ê´€ë¦¬
        if context == "field":
            self.periodic_equipment_maintenance(party)
        
        # 2. ì „íˆ¬ ì „ ì ê²€
        elif context == "pre_combat":
            self.pre_combat_equipment_check(party)
        
        # 3. ì „íˆ¬ í›„ ë¶„ì„
        elif context == "post_combat":
            battle_result = getattr(self, 'last_battle_result', 'victory')
            self.post_combat_analysis(party, battle_result)
        
        # 4. ë ˆë²¨ì—… ì‹œ ì¥ë¹„ ì¶”ì²œ
        elif context == "level_up":
            character = getattr(self, 'leveled_up_character', None)
            if character:
                print(f"\nğŸ¯ ë ˆë²¨ì—… ì¶•í•˜! {character.name}ì˜ ì¥ë¹„ë¥¼ ì ê²€í•´ë´…ì‹œë‹¤.")
                self.smart_equipment_recommendation(character, [])  # ì‹¤ì œë¡œëŠ” ì¸ë²¤í† ë¦¬ ì•„ì´í…œë“¤
                self.suggest_equipment_enhancement(character)
        
        # 5. ëœë¤ í•„ë“œ ëŒ€í™” (ê¸°ì¡´)
        elif context == "field_dialogue":
            return self.trigger_random_field_dialogue(party)
        
        # 6. ìƒí™©ë³„ ëŒ€í™”
        elif context.startswith("situational_"):
            situation = context.replace("situational_", "")
            self.trigger_situational_dialogue(situation)
        
        return True
    
    def get_ai_mode_status(self) -> Dict[str, any]:
        """í´ë˜ì‹ ëª¨ë“œ í˜„ì¬ ìƒíƒœ ë°˜í™˜"""
        status = {
            'mode': self.current_mode.value,
            'player_controlled': len(self.player_controlled_characters),
            'ai_controlled': len(self.ai_companions),
            'pending_requests': len(self.pending_ai_requests),
            'systems_active': {
                'durability_check': True,
                'equipment_enhancement': True,
                'smart_recommendations': True,
                'party_synergy': True,
                'combat_integration': True
            },
            'companions_info': []
        }
        
        # AI ë™ë£Œ ì •ë³´
        for companion in self.ai_companions:
            companion_info = {
                'name': companion.character.name,
                'class': getattr(companion.character, 'character_class', 'Unknown'),
                'personality': getattr(companion, 'personality', CharacterPersonality.BALANCED).value,
                'gender': getattr(companion.character, 'gender', CharacterGender.MALE).value,
                'coordination_ready': getattr(companion, 'coordinated_attack_ready', False)
            }
            status['companions_info'].append(companion_info)
        
        return status
    
    def save_ai_mode_state(self) -> Dict[str, any]:
        """í´ë˜ì‹ ëª¨ë“œ ìƒíƒœ ì €ì¥"""
        save_data = {
            'current_mode': self.current_mode.value,
            'player_character_names': [char.name for char in self.player_controlled_characters],
            'ai_companion_data': [],
            'settings': {
                'item_sharing_enabled': self.item_sharing_enabled,
                'coordination_opportunities': len(self.coordination_opportunities)
            }
        }
        
        # AI ë™ë£Œ ë°ì´í„° ì €ì¥
        for companion in self.ai_companions:
            companion_data = {
                'character_name': companion.character.name,
                'personality': getattr(companion, 'personality', CharacterPersonality.BALANCED).value,
                'coordinated_attack_ready': getattr(companion, 'coordinated_attack_ready', False)
            }
            save_data['ai_companion_data'].append(companion_data)
        
        return save_data
    
    def is_ai_controlled(self, character: Character) -> bool:
        """ìºë¦­í„°ê°€ AI ì¡°ì‘ì¸ì§€ í™•ì¸"""
        if not character:
            return False
        
        # í´ë˜ì‹ ëª¨ë“œê°€ ë¹„í™œì„±í™”ëœ ê²½ìš° ëª¨ë“  ìºë¦­í„°ëŠ” í”Œë ˆì´ì–´ ì¡°ì‘
        if not hasattr(self, 'ai_mode_active') or not getattr(self, 'ai_mode_active', False):
            return False
        
        # ì£¼ì¸ê³µ(í”Œë ˆì´ì–´)ì€ í•­ìƒ í”Œë ˆì´ì–´ê°€ ì œì–´
        if getattr(character, 'name', '') == 'í•€' or getattr(character, 'is_main_character', False):
            return False
        
        # AI ë™ë£Œ ë¦¬ìŠ¤íŠ¸ì—ì„œ í™•ì¸
        for ai_companion in self.ai_companions:
            if ai_companion.character == character:
                return True
        
        # í”Œë ˆì´ì–´ ì¡°ì‘ ìºë¦­í„°ê°€ ì•„ë‹ˆê³  í´ë˜ì‹ ëª¨ë“œê°€ í™œì„±í™”ëœ ê²½ìš°ì—ë§Œ AI ì¡°ì‘ìœ¼ë¡œ íŒë‹¨
        if character not in self.player_controlled_characters and len(self.ai_companions) > 0:
            return True
        
        return False
    
    def load_ai_mode_state(self, save_data: Dict[str, any], party: List[Character]):
        """í´ë˜ì‹ ëª¨ë“œ ìƒíƒœ ë¡œë“œ"""
        # ëª¨ë“œ ë³µì›
        mode_value = save_data.get('current_mode', AIGameMode.SINGLE_CONTROL.value)
        self.current_mode = AIGameMode(mode_value)
        
        # í”Œë ˆì´ì–´ ì¡°ì‘ ìºë¦­í„° ë³µì›
        player_names = save_data.get('player_character_names', [])
        self.player_controlled_characters = [
            char for char in party if char.name in player_names
        ]
        
        # AI ë™ë£Œ ë³µì›
        ai_data = save_data.get('ai_companion_data', [])
        self.ai_companions = []
        
        for data in ai_data:
            char_name = data.get('character_name')
            character = next((char for char in party if char.name == char_name), None)
            
            if character:
                personality_value = data.get('personality', CharacterPersonality.BALANCED.value)
                personality = CharacterPersonality(personality_value)
                
                companion = AICompanion(character, AIPersonality.AGGRESSIVE)  # ê¸°ë³¸ê°’
                companion.personality = personality
                companion.coordinated_attack_ready = data.get('coordinated_attack_ready', False)
                
                self.ai_companions.append(companion)
        
        # ì„¤ì • ë³µì›
        settings = save_data.get('settings', {})
        self.item_sharing_enabled = settings.get('item_sharing_enabled', True)
        
        print(f"âœ… í´ë˜ì‹ ëª¨ë“œ ìƒíƒœê°€ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.")
        print(f"   í”Œë ˆì´ì–´ ì¡°ì‘: {len(self.player_controlled_characters)}ëª…")
        print(f"   AI ì¡°ì‘: {len(self.ai_companions)}ëª…")

    def trigger_random_field_dialogue(self, party: List[Character]) -> bool:
        """í•„ë“œì—ì„œ ëœë¤ ëŒ€í™” ë°œìƒ (5% í™•ë¥ )"""
        if random.random() > 0.05:  # 5% í™•ë¥ 
            return False
        
        if not self.ai_companions:
            return False
        
        # AI ë™ë£Œ ì¤‘ ëœë¤ ì„ íƒ
        speaker = random.choice(self.ai_companions)
        personality = speaker.personality if hasattr(speaker, 'personality') else CharacterPersonality.BALANCED
        
        # í•„ë“œ ì‚¬ë‹´ ê°€ì ¸ì˜¤ê¸° (ì•ˆì „í•œ ê¸°ë³¸ê°’ í¬í•¨)
        casual_dialogues = CharacterTraits.FIELD_CASUAL_DIALOGUE.get(personality, 
            ["ì¢‹ì€ ë‚ ì”¨ë„¤ìš”.", "ëª¨í—˜ì„ ê³„ì†í•´ë´…ì‹œë‹¤.", "í•¨ê»˜ ê°€ìš”.", "ì¡°ì‹¬í•´ì„œ ê°€ìš”.", "ì ê¹ ì‰¬ì–´ê°ˆê¹Œìš”?"])
        dialogue = random.choice(casual_dialogues)
        
        print(f"\nğŸ’­ {speaker.character.name}: \"{dialogue}\"")
        
        # ë‹¤ë¥¸ AI ë™ë£Œê°€ ì‘ë‹µí•  í™•ë¥  (30%)
        if len(self.ai_companions) > 1 and random.random() < 0.3:
            responders = [ai for ai in self.ai_companions if ai != speaker]
            responder = random.choice(responders)
            responder_personality = responder.personality if hasattr(responder, 'personality') else CharacterPersonality.BALANCED
            
            # ì‘ë‹µ ëŒ€ì‚¬
            response_dialogues = {
                CharacterPersonality.CHEERFUL: ["ê·¸ëŸ¬ê²Œ!", "ë§ì•„!", "ë‚˜ë„ ê·¸ë ‡ê²Œ ìƒê°í•´!", "ì¢‹ì€ ë§ì´ì•¼!"],
                CharacterPersonality.SERIOUS: ["ê·¸ë ‡êµ°.", "ì´í•´í•œë‹¤.", "ë™ê°ì´ë‹¤.", "ë§ëŠ” ë§ì´ë‹¤."],
                CharacterPersonality.GENTLE: ["ê·¸ëŸ¬ì‹œë„¤ìš”.", "ì¢‹ì€ ë§ì”€ì´ì—ìš”.", "ê·¸ëŸ´ ìˆ˜ë„ ìˆê² ì–´ìš”.", "ë§ì•„ìš”."],
                CharacterPersonality.COLD: ["...", "ê·¸ë ‡ë‹¤.", "...ì•Œê² ë‹¤.", "...ê·¸ëŸ°ê°€."],
                CharacterPersonality.PLAYFUL: ["í—¤í—¤, ê·¸ëŸ¬ë„¤!", "ì¬ë°ŒëŠ” ë§ì´ì•¼!", "ì˜¤, ê·¸ëŸ´ê¹Œ?", "ì‹ ê¸°í•˜ë‹¤!"],
                CharacterPersonality.MYSTERIOUS: ["í¥ë¯¸ë¡­êµ°.", "ìš´ëª…ì ì¸ ë§ì´ë‹¤.", "ê·¸ë ‡ê²Œ ì •í•´ì§„ ê²ƒì¸ê°€.", "ë³„ë“¤ë„ ê·¸ë ‡ê²Œ ë§í•œë‹¤."],
                CharacterPersonality.HOT_TEMPERED: ["ê·¸ë ‡ì§€!", "ë‹¹ì—°í•˜ì§€!", "ë§ì•„!", "ê·¸ëŸ¼!"],
                CharacterPersonality.WISE: ["ì§€í˜œë¡œìš´ ë§ì´ë‹¤.", "ê¹Šì´ ìˆëŠ” ê´€ì°°ì´ë‹¤.", "í˜„ëª…í•œ ìƒê°ì´ë‹¤.", "ë°°ìš¸ ì ì´ ìˆë‹¤."]
            }
            
            response = random.choice(response_dialogues.get(responder_personality, ["ê·¸ë ‡êµ°."]))
            print(f"ğŸ’­ {responder.character.name}: \"{response}\"")
        
        time.sleep(2)  # ì½ì„ ì‹œê°„ ì œê³µ
        return True
    
    def trigger_party_encounter_dialogue(self, encounter_type: str, party: List[Character]):
        """íŒŒí‹°ì› ì „ìš© ì¸ì¹´ìš´í„° ëŒ€í™”"""
        if not self.ai_companions:
            return
        
        encounter_dialogues = CharacterTraits.PARTY_ENCOUNTER_DIALOGUE.get(encounter_type, {})
        if not encounter_dialogues:
            return
        
        print(f"\nğŸ­ íŒŒí‹°ì›ë“¤ì˜ ë°˜ì‘:")
        
        # ê° AI ë™ë£Œì˜ ë°˜ì‘
        for companion in self.ai_companions:
            personality = companion.personality if hasattr(companion, 'personality') else CharacterPersonality.BALANCED
            dialogues = encounter_dialogues.get(personality, ["..."])
            dialogue = random.choice(dialogues)
            
            print(f"ğŸ’¬ {companion.character.name}: \"{dialogue}\"")
            time.sleep(0.8)  # ìˆœì°¨ì ìœ¼ë¡œ ëŒ€í™” ì¶œë ¥
        
        # ê°€ë” í”Œë ˆì´ì–´ ìºë¦­í„°ë„ ì°¸ì—¬ (20% í™•ë¥ )
        if random.random() < 0.2 and self.player_controlled_characters:
            player_char = random.choice(self.player_controlled_characters)
            player_personality = getattr(player_char, 'personality', CharacterPersonality.BALANCED)
            player_dialogues = encounter_dialogues.get(player_personality, ["..."])
            player_dialogue = random.choice(player_dialogues)
            
            print(f"ğŸ’¬ {player_char.name} (ë‹¹ì‹ ): \"{player_dialogue}\"")
        
        time.sleep(2)
    
    def trigger_situational_dialogue(self, situation: str, character: Character = None, target: Character = None):
        """ìƒí™©ë³„ íŠ¹ìˆ˜ ëŒ€í™” íŠ¸ë¦¬ê±°"""
        
        # íŠ¹ìˆ˜ ìƒí™©ë³„ ëŒ€í™”
        situational_dialogues = {
            "level_up": {
                CharacterPersonality.CHEERFUL: [
                    "ì•¼í˜¸! ë ˆë²¨ì—…ì´ë‹¤!", "ê°•í•´ì§„ ê¸°ë¶„ì´ì•¼!", "ë” ì—´ì‹¬íˆ í•´ë³´ì!",
                    "ì™„ì „ ì‹ ë‚˜! ë” ê°•í•´ì¡Œì–´!", "ì™€! ì„±ì¥í–ˆë‹¤!", "ë ˆë²¨ì—…! ìµœê³ ì•¼!",
                    "ìƒˆë¡œìš´ í˜ì´ ëŠê»´ì ¸!", "ë” ë§ì€ ëª¨í—˜ì„ í•  ìˆ˜ ìˆê² ì–´!", "ì„±ì¥í•˜ëŠ” ê¸°ë¶„ ì¢‹ì•„!",
                    "ìš°ë¦¬ ë‹¤ê°™ì´ ê°•í•´ì§€ì!"
                ],
                CharacterPersonality.SERIOUS: [
                    "ì„±ì¥í–ˆë‹¤.", "ë”ìš± ì±…ì„ê°ì„ ëŠë‚€ë‹¤.", "ë‹¤ìŒ ëª©í‘œë¡œ ë‚˜ì•„ê°€ì.",
                    "ì‹¤ë ¥ì´ í–¥ìƒëë‹¤.", "ë” íš¨ìœ¨ì ìœ¼ë¡œ í–‰ë™í•  ìˆ˜ ìˆê² ë‹¤.", "ì „ëµì  ì„ íƒì§€ê°€ ëŠ˜ì—ˆë‹¤.",
                    "ëŠ¥ë ¥ì¹˜ ìƒìŠ¹ì„ í™•ì¸í–ˆë‹¤.", "í›ˆë ¨ì˜ ì„±ê³¼ë‹¤.", "ê³„íšì  ì„±ì¥ì´ë‹¤.",
                    "ë” ë†’ì€ ëª©í‘œë¥¼ ì„¸ì›Œì•¼ê² ë‹¤."
                ],
                CharacterPersonality.GENTLE: [
                    "ì¡°ê¸ˆ ë” ê°•í•´ì§„ ê²ƒ ê°™ì•„ìš”.", "ëª¨ë‘ ë•ë¶„ì´ì—ìš”.", "ê°ì‚¬í•´ìš”.",
                    "ë‹¤í–‰íˆ ì„±ì¥í•  ìˆ˜ ìˆì—ˆì–´ìš”.", "í•¨ê»˜í•´ì„œ ê°€ëŠ¥í–ˆë˜ ê²ƒ ê°™ì•„ìš”.", "ì†Œì¤‘í•œ ê²½í—˜ì´ì—ˆì–´ìš”.",
                    "ë” ë„ì›€ì´ ë  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”.", "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ì‚¬ìš©í•˜ê² ì–´ìš”.", "ëª¨ë‘ë¥¼ ìœ„í•´ ì‚¬ìš©í• ê²Œìš”.",
                    "ê²¸ì†í•˜ê²Œ ë°›ì•„ë“¤ì´ê² ì–´ìš”."
                ],
                CharacterPersonality.COLD: [
                    "ë ˆë²¨ì—….", "...ê°•í•´ì¡Œë‹¤.", "ê³„ì†í•˜ì.",
                    "ì„±ì¥.", "...ë‹¹ì—°í•œ ê²°ê³¼.", "ë‹¤ìŒ.",
                    "ëŠ¥ë ¥ í–¥ìƒ.", "...íš¨ê³¼ì .", "ì§„í–‰í•˜ì.",
                    "...ë§Œì¡±ìŠ¤ëŸ½ë‹¤."
                ],
                CharacterPersonality.PLAYFUL: [
                    "ë ˆë²¨ì—…! ìƒˆë¡œìš´ ê¸°ìˆ  ë°°ìš¸ ìˆ˜ ìˆë‚˜?", "ë” ì¬ë°Œì–´ì¡Œì–´!", "ì‹ ë‚œë‹¤!",
                    "ì™„ì „ ì¿¨í•´! ìƒˆë¡œìš´ ëŠ¥ë ¥!", "ê²Œì„ ê°™ì•„ì„œ ì¬ë°Œì–´!", "ë ˆë²¨ì—… íŒŒí‹°!",
                    "ì–´ë–¤ ìƒˆë¡œìš´ ëŠ¥ë ¥ì´ ìˆì„ê¹Œ?", "ì™„ì „ í¥ë¯¸ì§„ì§„í•´!", "ë” ì¬ë°ŒëŠ” ëª¨í—˜ ê°€ëŠ¥!",
                    "ë ˆë²¨ì—… ì¶•í•˜í•´ì¤˜!"
                ],
                CharacterPersonality.MYSTERIOUS: [
                    "ìš´ëª…ì˜ í˜ì´ ê°•í•´ì¡Œë‹¤.", "ë³„ë“¤ì´ ì¶•ë³µí•´ì£¼ì—ˆêµ°.", "ì˜ˆì •ëœ ì„±ì¥ì´ë‹¤.",
                    "ìš°ì£¼ì˜ í˜ì´ í˜ëŸ¬ë“¤ì–´ì˜¨ë‹¤.", "ì‹ ë¹„ë¡œìš´ ì„±ì¥ì´êµ°.", "ë³„ìë¦¬ê°€ ë³€í™”í–ˆë‹¤.",
                    "ìš´ëª…ì˜ ìƒˆë¡œìš´ ì¥ì´ ì—´ë ¸ë‹¤.", "ì‹œê³µì˜ í˜ì´ ì¦ê°€í–ˆë‹¤.", "ì˜ˆì–¸ëœ ì„±ì¥.",
                    "ìš°ì£¼ê°€ ì¸ì •í•œ ë°œì „."
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    "ë“œë””ì–´! ë” ê°•í•´ì¡Œì–´!", "ì´ì œ ë” ì‹œì›í•˜ê²Œ ì‹¸ìš¸ ìˆ˜ ìˆê² ì–´!", "ë ˆë²¨ì—…!",
                    "ë¶ˆíƒ€ëŠ” ì„±ì¥ì´ì•¼!", "ì—´ì •ì˜ ê²°ê³¼ë‹¤!", "ë” í™”ëˆí•˜ê²Œ ì‹¸ìš°ì!",
                    "ì‹œì›í•œ ë ˆë²¨ì—…!", "í­ë°œì ì¸ ì„±ì¥!", "ì—´ì •ì´ ê²°ì‹¤ì„ ë§ºì—ˆì–´!",
                    "ì´ì œ ë” ê°•ë ¥í•´ì¡Œë‹¤!"
                ],
                CharacterPersonality.WISE: [
                    "ê²½í—˜ì´ ì§€í˜œê°€ ë˜ì—ˆë‹¤.", "ì„±ì¥ì˜ ê¸°ì¨ì„ ëŠë‚€ë‹¤.", "ë°°ì›€ì˜ ê²°ì‹¤ì´ë‹¤.",
                    "ìˆ˜ë ¨ì˜ ì„±ê³¼ê°€ ë‚˜íƒ€ë‚¬ë‹¤.", "ì§€í˜œë¡œìš´ ë°œì „ì´ë‹¤.", "ê¹Šì´ ìˆëŠ” ì„±ì¥.",
                    "ê²½í—˜ì˜ ì¶•ì ì´ í˜ì´ ë˜ì—ˆë‹¤.", "í˜„ëª…í•œ ë°œì „ì˜ ê¸¸.", "ì§€ì‹ì´ í˜ì´ ë˜ì—ˆë‹¤.",
                    "ê¹¨ë‹¬ìŒì˜ ìˆœê°„ì´ë‹¤."
                ],
                CharacterPersonality.BALANCED: [
                    "ë ˆë²¨ì—…í–ˆë„¤ìš”.", "ì ì ˆí•œ ì„±ì¥ì´ì—ìš”.", "ê· í˜•ì¡íŒ ë°œì „ì´ë„¤ìš”.",
                    "ì¢‹ì€ ì„±ì¥ì´ì—ìš”.", "ì ë‹¹íˆ ê°•í•´ì§„ ê²ƒ ê°™ì•„ìš”.", "ê¾¸ì¤€í•œ ë°œì „ì´ë„¤ìš”.",
                    "ì•ˆì •ì ì¸ ì„±ì¥ì´ì—ìš”.", "í•¨ê»˜ ì„±ì¥í•´ë´ìš”."
                ]
            },
            "critical_hit": {
                CharacterPersonality.CHEERFUL: [
                    "ëŒ€ë°•! ì™„ë²½í•œ íƒ€ê²©!", "ì—„ì²­ ì˜ ë§ì•˜ì–´!", "ìš°ì™€! ì´ëŸ° ê²Œ í¬ë¦¬í‹°ì»¬ì´êµ¬ë‚˜!",
                    "ì™„ì „ ëŸ­í‚¤ íˆíŠ¸!", "ì‹ ë‚˜ëŠ” í¬ë¦¬í‹°ì»¬!", "ì•¼í˜¸! ì™„ë²½í•œ íƒ€ì´ë°!",
                    "ìµœê³ ì˜ í•œë°©!", "ê¸°ë¶„ ì¢‹ì€ í¬ë¦¬í‹°ì»¬!", "ì™€! ì´ëŸ° ë§›ì— ì‹¸ìš°ëŠ” ê±°ì•¼!",
                    "ì™„ì „ ëŒ€ë°• í¬ë¦¬í‹°ì»¬!"
                ],
                CharacterPersonality.SERIOUS: [
                    "ì •í™•í•œ íƒ€ê²©ì´ì—ˆë‹¤.", "ê³„ì‚°ëœ ê³µê²©.", "íš¨ê³¼ì ì´ì—ˆë‹¤.",
                    "ì „ëµì  ì„±ê³µ.", "ì˜ˆìƒí•œ ê²°ê³¼ë‹¤.", "ì •ë°€í•œ ê³µê²©ì´ì—ˆë‹¤.",
                    "í›ˆë ¨ì˜ ì„±ê³¼.", "ì™„ë²½í•œ ì‹¤í–‰.", "í”„ë¡œí˜ì…”ë„í•œ íƒ€ê²©.",
                    "ê³„íšëŒ€ë¡œ ì§„í–‰ëë‹¤."
                ],
                CharacterPersonality.GENTLE: [
                    "ìš´ì´ ì¢‹ì•˜ë‚˜ ë´ìš”.", "ë‹¤í–‰íˆ ì˜ ë§ì•˜ì–´ìš”.", "ë¯¸ì•ˆí•´ìš”.",
                    "ì‹¤ìˆ˜ë¡œ ì„¸ê²Œ ë§ì•˜ë„¤ìš”.", "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ í–ˆëŠ”ë°...", "ì˜ë„í•œ ê±´ ì•„ë‹ˆì—ìš”.",
                    "ë„ˆë¬´ ì•„í”„ê²Œ í–ˆë‚˜ìš”?", "ì£„ì†¡í•´ìš”.", "ì¡°ì‹¬í•´ì•¼ê² ì–´ìš”.",
                    "ë‹¤ì¹˜ì§€ ì•Šì•˜ìœ¼ë©´ ì¢‹ê² ì–´ìš”."
                ],
                CharacterPersonality.COLD: [
                    "í¬ë¦¬í‹°ì»¬.", "...ì˜ ë§ì•˜ë‹¤.", "íš¨ê³¼ì ì´ë‹¤.",
                    "ì¹˜ëª…íƒ€.", "...ì„±ê³µ.", "ì¢‹ë‹¤.",
                    "ì •í™•í•˜ë‹¤.", "...ë§Œì¡±.", "ë‹¤ìŒ.",
                    "...ì™„ë²½."
                ],
                CharacterPersonality.PLAYFUL: [
                    "ëŒ€ë°•! ìŠˆí¼ íˆíŠ¸!", "ì™„ì „ í¬ë¦¬í‹°ì»¬!", "ì´ëŸ° ë§›ì— ì‹¸ìš°ëŠ” ê±°ì§€!",
                    "ì™„ì „ ì¿¨í•œ í¬ë¦¬í‹°ì»¬!", "ê²Œì„ ê°™ì€ íƒ€ê²©!", "ì™„ì „ ëŒ€ë°•!",
                    "ìŠˆí¼ ëŸ­í‚¤!", "ë©‹ì§„ í¬ë¦¬í‹°ì»¬ ì‡¼!", "ì´ëŸ° ê²Œ ì§„ì§œ ì¬ë¯¸!",
                    "ì™„ì „ ìŠ¤í™í„°í´!"
                ],
                CharacterPersonality.MYSTERIOUS: [
                    "ìš´ëª…ì´ ì¸ë„í•œ ì¼ê²©.", "ë³„ë“¤ì´ ìŠ¹ì¸í•œ íƒ€ê²©.", "ì˜ˆì •ëœ ì¹˜ëª…íƒ€.",
                    "ìš°ì£¼ì˜ í˜ì´ ì§‘ì¤‘ëë‹¤.", "ì‹ ë¹„ë¡œìš´ ì¼ê²©ì´êµ°.", "ë³„ìë¦¬ê°€ ì •ë ¬í•œ ìˆœê°„.",
                    "ìš´ëª…ì ì¸ íƒ€ê²©.", "ì‹œê³µì´ ì¸ì •í•œ ì¼ê²©.", "ì˜ˆì–¸ëœ í¬ë¦¬í‹°ì»¬.",
                    "ìš°ì£¼ì˜ ëœ»ì´ ë‹´ê¸´ íƒ€ê²©."
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    "ì‹œì›í•˜ë‹¤! ì œëŒ€ë¡œ ë°•í˜”ì–´!", "ì´ëŸ° ë§›ì´ì•¼!", "í¬ë¦¬í‹°ì»¬!",
                    "í™”ëˆí•œ í•œë°©!", "ë¶ˆíƒ€ëŠ” í¬ë¦¬í‹°ì»¬!", "ì‹œì›í•œ íƒ€ê²©!",
                    "í­ë°œì ì¸ ì¼ê²©!", "ì—´ì •ì˜ í¬ë¦¬í‹°ì»¬!", "ë“œë””ì–´ ì œëŒ€ë¡œ!",
                    "ì‹œì›í•˜ê²Œ ë°•ì•˜ì–´!"
                ],
                CharacterPersonality.WISE: [
                    "ê²½í—˜ì´ ë¹›ì„ ë°œí–ˆë‹¤.", "ì •í™•í•œ íƒ€ì´ë°ì´ì—ˆë‹¤.", "ìˆ˜ë ¨ì˜ ê²°ê³¼ë‹¤.",
                    "ì§€í˜œë¡œìš´ ê³µê²©.", "í˜„ëª…í•œ íƒ€ì´ë°.", "ê²½í—˜ì˜ ê°€ì¹˜.",
                    "ê¹Šì´ ìˆëŠ” ê³µê²©ì´ì—ˆë‹¤.", "ì˜¤ëœ ìˆ˜ë ¨ì˜ ê²°ì‹¤.", "ì§€ì‹ì´ í˜ì´ ë˜ì—ˆë‹¤.",
                    "í˜„ëª…í•œ íŒë‹¨ì˜ ê²°ê³¼."
                ],
                CharacterPersonality.BALANCED: [
                    "ì¢‹ì€ íƒ€ê²©ì´ì—ˆì–´ìš”.", "ì ì ˆí•œ í¬ë¦¬í‹°ì»¬ì´ë„¤ìš”.", "ì˜ ë§ì•˜ì–´ìš”.",
                    "ê· í˜•ì¡íŒ ê³µê²©ì´ì—ˆì–´ìš”.", "ì ë‹¹íˆ ì˜ ëë„¤ìš”.", "ê´œì°®ì€ ê²°ê³¼ì˜ˆìš”.",
                    "ì ì ˆí•œ íƒ€ì´ë°ì´ì—ˆì–´ìš”.", "ì¢‹ì€ ì„±ê³¼ë„¤ìš”."
                ]
            },
            "near_death": {
                CharacterPersonality.CHEERFUL: [
                    "ì•„ì§... í¬ê¸°í•  ìˆœ ì—†ì–´!", "ì¡°ê¸ˆë§Œ ë” ë²„í…¨ë³´ì!", "í¬ë§ì„ ìƒì§€ ë§ì!",
                    "ìš°ë¦¬ í•¨ê»˜ ì´ê²¨ë‚´ì!", "ì•„ì§ ëë‚˜ì§€ ì•Šì•˜ì–´!", "ìµœì„ ì„ ë‹¤í•´ë³´ì!",
                    "í¬ê¸°í•˜ë©´ ì•ˆ ë¼!", "ëª¨ë‘ë¥¼ ìœ„í•´ ë²„í…¨ë³´ì!", "í¬ë§ì€ ìˆì–´!",
                    "ë§ˆì§€ë§‰ê¹Œì§€ ì›ƒìœ¼ë©° ê°€ì!"
                ],
                CharacterPersonality.SERIOUS: [
                    "ìœ„í—˜í•œ ìƒí™©ì´ë‹¤.", "ì‹ ì¤‘í•´ì•¼ê² ë‹¤.", "ì „ëµì  í›„í‡´ë¥¼ ê³ ë ¤í•˜ì.",
                    "ìƒí™©ì„ ì¬í‰ê°€í•´ì•¼ í•œë‹¤.", "ë³´ë‹¤ ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ í–‰ë™í•˜ì.", "ê³„íšì„ ìˆ˜ì •í•´ì•¼ê² ë‹¤.",
                    "ë¦¬ìŠ¤í¬ ê´€ë¦¬ê°€ í•„ìš”í•˜ë‹¤.", "ì•ˆì „ ìš°ì„ ìœ¼ë¡œ í–‰ë™í•˜ì.", "ì „ìˆ ì„ ë°”ê¿”ì•¼ê² ë‹¤.",
                    "ëƒ‰ì •í•œ íŒë‹¨ì´ í•„ìš”í•˜ë‹¤."
                ],
                CharacterPersonality.GENTLE: [
                    "ì£„ì†¡í•´ìš”... ì œê°€ ë¶€ì¡±í•´ì„œ...", "ê±±ì • ë¼ì³ë“œë ¤ì„œ ë¯¸ì•ˆí•´ìš”.", "ì¡°ì‹¬í•´ì•¼ê² ì–´ìš”.",
                    "ë‹¤ë¥¸ ë¶„ë“¤ì—ê²Œ í”¼í•´ë¥¼ ì£¼ê³  ìˆë„¤ìš”.", "ë” ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ í–‰ë™í• ê²Œìš”.", "ë¯¸ì•ˆí•´ìš”, ëª¨ë‘...",
                    "ì œê°€ ë” ì‹ ì¤‘í–ˆì–´ì•¼ í–ˆëŠ”ë°...", "ë‹¤ë“¤ ë¬´ì‚¬í•˜ì‹œê¸¸...", "ì € ë•Œë¬¸ì— ê±±ì • ë§ˆì„¸ìš”.",
                    "ë‹¤ìŒì—” ë” ì¡°ì‹¬í• ê²Œìš”."
                ],
                CharacterPersonality.COLD: [
                    "...ìœ„í—˜í•˜ë‹¤.", "í•œê³„ì— ì™”ë‹¤.", "...ì¡°ì‹¬í•˜ì.",
                    "...ìƒí™©ì´ ë‚˜ì˜ë‹¤.", "ìœ„ê¸°ë‹¤.", "...ì² ìˆ˜.",
                    "í•œê³„.", "...ì£¼ì˜.", "ìœ„í—˜.",
                    "...ì‹¬ê°í•˜ë‹¤."
                ],
                CharacterPersonality.PLAYFUL: [
                    "ì´ëŸ°! ìŠ¤ë¦´ ìˆê¸´ í•˜ì§€ë§Œ...", "ìœ„í—˜í•œ ê²Œì„ì´ ëë„¤!", "ì¡°ì‹¬í•´ì•¼ê² ì–´!",
                    "ê²Œì„ ì˜¤ë²„ëŠ” ì‹«ì–´!", "ì´ê±´ ë„ˆë¬´ ìœ„í—˜í•œ ë†€ì´ì•¼!", "ì‚´ì§ ë¬´ì„œì›Œì¡Œì–´!",
                    "ì¬ë°Œê¸´ í•˜ì§€ë§Œ ìœ„í—˜í•´!", "ì´ëŸ° ìŠ¤ë¦´ì€ ì‹«ì–´!", "ê²Œì„ ë‚œì´ë„ê°€ ë„ˆë¬´ ë†’ì•„!",
                    "ì¡°ê¸ˆ ë” ì•ˆì „í•˜ê²Œ ë†€ì!"
                ],
                CharacterPersonality.MYSTERIOUS: [
                    "ì£½ìŒì´ ì†ì§“í•˜ê³  ìˆë‹¤.", "ìš´ëª…ì˜ ê°ˆë¦¼ê¸¸ì— ì„°êµ°.", "ì•„ì§ ë•Œê°€ ì•„ë‹ˆë‹¤.",
                    "ë³„ë“¤ì´ ê²½ê³ í•˜ê³  ìˆë‹¤.", "ìš´ëª…ì˜ ì‹œí—˜ì¸ê°€.", "ì£½ìŒì˜ ê·¸ë¦¼ìê°€ ë“œë¦¬ì›Œì¡Œë‹¤.",
                    "ìš°ì£¼ê°€ ì‹œë ¨ì„ ì£¼ëŠ”êµ°.", "ë³„ìë¦¬ê°€ ì–´ë‘ì›Œì¡Œë‹¤.", "ìš´ëª…ì´ í”ë“¤ë¦¬ê³  ìˆë‹¤.",
                    "ì‹ ë¹„ë¡œìš´ í˜ì´ ì‹œí—˜í•˜ê³  ìˆë‹¤."
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    "ì  ì¥! ì´ëŸ° ìƒí™©ì´!", "í™”ë‚˜ì§€ë§Œ... ì¡°ì‹¬í•´ì•¼ê² ì–´!", "ì•„ì§ ëë‚˜ì§€ ì•Šì•˜ì–´!",
                    "ì´ëŸ° ì‹ìœ¼ë¡œëŠ” ì•ˆ ë¼!", "ë¶„í•˜ì§€ë§Œ ë¬¼ëŸ¬ì„œì•¼ê² ì–´!", "ì œëŒ€ë¡œ ì‹¸ìš°ì§€ë„ ëª»í•˜ê³ !",
                    "í™”ë‚˜ëŠ” ìƒí™©ì´ì•¼!", "ì´ëŸ° ê±´ ì‹«ì–´!", "ë” ê°•í•´ì ¸ì•¼ í•´!",
                    "ì´ëŸ° ìœ„í—˜ì€ ì§ˆìƒ‰ì´ì•¼!"
                ],
                CharacterPersonality.WISE: [
                    "ìœ„í—˜í•œ ìˆœê°„ì´ë‹¤.", "ì‹ ì¤‘í•œ íŒë‹¨ì´ í•„ìš”í•˜ë‹¤.", "ê²½í—˜ì„ ì‚´ë ¤ í–‰ë™í•˜ì.",
                    "ì§€í˜œë¡­ê²Œ ëŒ€ì²˜í•´ì•¼ í•œë‹¤.", "í˜„ëª…í•œ ì„ íƒì´ í•„ìš”í•˜ë‹¤.", "ê¹Šì´ ìƒê°í•´ë´ì•¼ê² ë‹¤.",
                    "ê²½í—˜ì´ ë§í•´ì£¼ëŠ” ìœ„í—˜ ì‹ í˜¸ë‹¤.", "ì§€í˜œë¡œìš´ í›„í‡´ê°€ ë•Œë¡œëŠ” ìŠ¹ë¦¬ë‹¤.", "í˜„ëª…í•œ ìëŠ” ìœ„í—˜ì„ ì•ˆë‹¤.",
                    "ì˜¤ëœ ê²½í—˜ì´ ê²½ê³ í•˜ê³  ìˆë‹¤."
                ],
                CharacterPersonality.BALANCED: [
                    "ìœ„í—˜í•œ ìƒí™©ì´ë„¤ìš”.", "ì¡°ì‹¬í•´ì•¼ê² ì–´ìš”.", "ì ì ˆí•œ ëŒ€ì‘ì´ í•„ìš”í•´ìš”.",
                    "ê· í˜•ì„ ìƒì§€ ë§ê³  ê°€ì•¼ê² ì–´ìš”.", "ì‹ ì¤‘í•˜ê²Œ í–‰ë™í•´ì•¼ê² ì–´ìš”.", "ì ë‹¹íˆ ì¡°ì‹¬í•´ì•¼ê² ë„¤ìš”.",
                    "ë¬´ë¦¬í•˜ì§€ ì•ŠëŠ” ê²Œ ì¢‹ê² ì–´ìš”.", "ì•ˆì „í•˜ê²Œ ê°€ë´ìš”."
                ]
            },
            "item_discovery": {
                CharacterPersonality.CHEERFUL: [
                    "ì˜¤! ë­”ê°€ ë°œê²¬í–ˆì–´!", "ì•„ì´í…œì´ë‹¤! ìš´ì´ ì¢‹ë„¤!", "ì‹ ë‚˜ëŠ” ë°œê²¬ì´ì•¼!",
                    "ì™€! ë³´ë¬¼ì´ë‹¤!", "ì™„ì „ ëŸ­í‚¤!", "ë©‹ì§„ ë°œê²¬ì´ë„¤!",
                    "ì˜¤ì˜ˆ! ì¢‹ì€ ê²Œ ë‚˜ì™”ì–´!", "ì­íŒŸì´ì•¼!", "ì´ëŸ° ê¸°ë¶„ ì¢‹ì€ ë°œê²¬!",
                    "ìš°ë¦¬ ìš´ì´ ì¢‹ë„¤!"
                ],
                CharacterPersonality.SERIOUS: [
                    "ì•„ì´í…œì„ ë°œê²¬í–ˆë‹¤.", "ìœ ìš©í•  ê²ƒ ê°™ë‹¤.", "í™•ì¸í•´ë³´ì.",
                    "ì „ëµì ìœ¼ë¡œ ë„ì›€ì´ ë  ê²ƒì´ë‹¤.", "íš¨ìœ¨ì ì¸ ë°œê²¬ì´ë‹¤.", "ë¶„ì„í•´ë³´ì.",
                    "ê³„íšì— ë„ì›€ì´ ë˜ê² ë‹¤.", "ì‹¤ìš©ì ì¸ ë°œê²¬ì´ë‹¤.", "ê²€í† ê°€ í•„ìš”í•˜ë‹¤.",
                    "ì „ìˆ ì  ê°€ì¹˜ê°€ ìˆë‹¤."
                ],
                CharacterPersonality.GENTLE: [
                    "ë­”ê°€ ìˆì–´ìš”.", "ë„ì›€ì´ ë ê¹Œìš”?", "í•¨ê»˜ í™•ì¸í•´ë´ìš”.",
                    "ì†Œì¤‘í•œ ë°œê²¬ì´ë„¤ìš”.", "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ í™•ì¸í•´ë´ìš”.", "ëª¨ë‘ì—ê²Œ ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”.",
                    "ë‹¤í–‰íˆ ì¢‹ì€ ê±¸ ì°¾ì•˜ë„¤ìš”.", "í•¨ê»˜ ë‚˜ëˆ ìš”.", "ì†Œì¤‘íˆ ì‚¬ìš©í•´ì•¼ê² ì–´ìš”.",
                    "ê°ì‚¬í•œ ë°œê²¬ì´ì—ìš”."
                ],
                CharacterPersonality.COLD: [
                    "ì•„ì´í…œ.", "...ë°œê²¬.", "í™•ì¸í•˜ì.",
                    "...ì“¸ë§Œí•˜ë‹¤.", "ê°€ì ¸ê°€ì.", "...ê´œì°®ë‹¤.",
                    "ìœ ìš©í•˜ë‹¤.", "...ë´ë‘ì.", "í•„ìš”í•˜ë‹¤.",
                    "...ê°€ì¹˜ìˆë‹¤."
                ],
                CharacterPersonality.PLAYFUL: [
                    "ì˜¤! ë³´ë¬¼ì°¾ê¸° ì„±ê³µ!", "ì¬ë°ŒëŠ” ë°œê²¬!", "ë­”ì§€ ê¶ê¸ˆí•´!",
                    "ì™„ì „ ì¿¨í•œ ì•„ì´í…œ!", "ì´ëŸ° ê±¸ ì°¾ëŠ” ì¬ë¯¸!", "ì‹ ë‚˜ëŠ” ì„œí”„ë¼ì´ì¦ˆ!",
                    "ì˜¤ì˜ˆ! ìˆ¨ê²¨ì§„ ë³´ë¬¼!", "ê²Œì„ ê°™ì•„ì„œ ì¬ë°Œì–´!", "ì™„ì „ ëŒ€ë°• ë°œê²¬!",
                    "ì´ëŸ° ê²Œ ëª¨í—˜ì˜ ì¬ë¯¸ì§€!"
                ],
                CharacterPersonality.MYSTERIOUS: [
                    "ìš´ëª…ì´ ì¤€ ì„ ë¬¼ì¸ê°€.", "ë³„ë“¤ì´ ì¸ë„í•œ ë°œê²¬.", "ì˜ˆì •ëœ ë³´ìƒ.",
                    "ìš°ì£¼ì˜ ëœ»ì´ ë‹´ê¸´ ë¬¼ê±´.", "ì‹ ë¹„ë¡œìš´ ë°œê²¬ì´êµ°.", "ìš´ëª…ì ì¸ ë§Œë‚¨.",
                    "ë³„ìë¦¬ê°€ ì•Œë ¤ì¤€ ë³´ë¬¼.", "ìˆ™ëª…ì ì¸ ë°œê²¬.", "ì‹œê³µì´ ë‚¨ê¸´ í”ì .",
                    "ì˜ˆì–¸ëœ ì•„ì´í…œì¸ê°€."
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    "ì˜¤! ë­”ê°€ ìˆì–´!", "ë°œê²¬í–ˆë‹¤!", "ì´ê±° ì“¸ë§Œí•˜ê² ëŠ”ë°!",
                    "ì¢‹ì€ ê±° ë‚˜ì™”ë„¤!", "ë“œë””ì–´ ì°¾ì•˜ì–´!", "ì‹œì›í•œ ë°œê²¬ì´ì•¼!",
                    "ì™„ì „ ëŒ€ë°•!", "ì´ëŸ° ê±¸ ì°¾ì•˜ë‹¤!", "ì—´ì •ì ì¸ ë°œê²¬!",
                    "ë¶ˆíƒ€ëŠ” ë³´ë¬¼ì°¾ê¸°!"
                ],
                CharacterPersonality.WISE: [
                    "ì§€í˜œë¡œìš´ ë°œê²¬ì´ë‹¤.", "ê²½í—˜ì´ ì•Œë ¤ì¤€ ë³´ë¬¼.", "í˜„ëª…í•œ íƒìƒ‰ì˜ ê²°ê³¼.",
                    "ê¹Šì´ ìˆëŠ” ë°œê²¬ì´êµ°.", "ì§€ì‹ì˜ ê°€ì¹˜ë¥¼ ì•„ëŠ” ì•„ì´í…œ.", "í˜„ëª…í•œ ì„ íƒì´ì—ˆë‹¤.",
                    "ê²½í—˜ì´ ìŒ“ì¸ ê²°ê³¼ë‹¤.", "ì§€í˜œë¡œìš´ ëˆˆì´ ì°¾ì•„ë‚¸ ë³´ë¬¼.", "ê¹¨ë‹¬ìŒì˜ ì„ ë¬¼.",
                    "ì˜¤ëœ ê²½í—˜ì´ ì•Œë ¤ì¤€ ê°€ì¹˜."
                ],
                CharacterPersonality.BALANCED: [
                    "ì¢‹ì€ ê±¸ ì°¾ì•˜ë„¤ìš”.", "ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”.", "ì ì ˆí•œ ë°œê²¬ì´ì—ìš”.",
                    "ìœ ìš©í•œ ì•„ì´í…œì´ë„¤ìš”.", "ë‹¤í–‰í•œ ë°œê²¬ì´ì—ìš”.", "ì ë‹¹íˆ ì“¸ë§Œí•´ìš”.",
                    "ê´œì°®ì€ ì•„ì´í…œì´ë„¤ìš”.", "í•¨ê»˜ ì‚¬ìš©í•´ë´ìš”."
                ]
            },
            "combat_victory": {
                CharacterPersonality.CHEERFUL: [
                    "ìš°ë¦¬ê°€ ì´ê²¼ì–´!", "ì•¼í˜¸! ìŠ¹ë¦¬ë‹¤!", "ì™„ì „ ëŒ€ë°•!",
                    "ìµœê³ ì˜ íŒ€ì›Œí¬ì˜€ì–´!", "ìš°ë¦¬ ì •ë§ ê°•í•˜ë„¤!", "ì‹ ë‚˜ëŠ” ìŠ¹ë¦¬!",
                    "í•¨ê»˜ ì´ê²¨ì„œ ë” ê¸°ë»!", "ì™„ì „ ìµœê³ ì•¼!", "ìŠ¹ë¦¬ì˜ ê¸°ì¨!",
                    "ìš°ë¦¬ê°€ í•´ëƒˆì–´!"
                ],
                CharacterPersonality.SERIOUS: [
                    "ì „íˆ¬ ì¢…ë£Œ.", "ìŠ¹ë¦¬ë¥¼ í™•ì¸í–ˆë‹¤.", "íš¨ê³¼ì ì¸ ì „ìˆ ì´ì—ˆë‹¤.",
                    "ê³„íšëŒ€ë¡œ ì§„í–‰ëë‹¤.", "ì„±ê³µì ì¸ ì‘ì „ì´ì—ˆë‹¤.", "ë‹¤ìŒ ëª©í‘œë¡œ ì´ë™í•˜ì.",
                    "ì „ëµì´ ì„±ê³µí–ˆë‹¤.", "ì„ë¬´ ì™„ìˆ˜.", "ì •í™•í•œ ì‹¤í–‰ì´ì—ˆë‹¤.",
                    "í”„ë¡œí˜ì…”ë„í•œ ìŠ¹ë¦¬."
                ],
                CharacterPersonality.GENTLE: [
                    "ë‹¤í–‰íˆ ëª¨ë‘ ë¬´ì‚¬í•´ìš”.", "í•¨ê»˜í•´ì„œ ì´ê¸¸ ìˆ˜ ìˆì—ˆì–´ìš”.", "ëª¨ë‘ ê³ ìƒí•˜ì…¨ì–´ìš”.",
                    "ë¬´ì‚¬íˆ ëë‚˜ì„œ ë‹¤í–‰ì´ì—ìš”.", "ì„œë¡œ ë„ì™€ì„œ ì´ê²¼ë„¤ìš”.", "ì•ˆì „í•˜ê²Œ ì´ê²¨ì„œ ì¢‹ì•„ìš”.",
                    "ë‹¤ì¹˜ì‹  ë¶„ì€ ì—†ìœ¼ì‹œì£ ?", "ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ì´ê²¼ì–´ìš”.", "ëª¨ë‘ ë•ë¶„ì´ì—ìš”.",
                    "í•¨ê»˜ë¼ì„œ ê°€ëŠ¥í–ˆì–´ìš”."
                ],
                CharacterPersonality.COLD: [
                    "ìŠ¹ë¦¬.", "...ëë‚¬ë‹¤.", "ë‹¤ìŒ.",
                    "ì™„ë£Œ.", "...ì„±ê³µ.", "ê³„ì†í•˜ì.",
                    "ì •ë¦¬ëë‹¤.", "...ë§Œì¡±.", "ê²°ê³¼ í™•ì¸.",
                    "...ì¢‹ë‹¤."
                ],
                CharacterPersonality.PLAYFUL: [
                    "ê²Œì„ í´ë¦¬ì–´!", "ì™„ì „ ì¬ë°Œì—ˆì–´!", "ìš°ë¦¬ê°€ ì£¼ì¸ê³µì´ì•¼!",
                    "ë©‹ì§„ ìŠ¹ë¦¬ ì‡¼!", "ì™„ì „ ì¿¨í•´!", "ë‹¤ìŒ ìŠ¤í…Œì´ì§€!",
                    "ì™„ì „ ëŒ€ë°• ìŠ¹ë¦¬!", "ì¬ë°ŒëŠ” ì „íˆ¬ì˜€ì–´!", "ìŠ¹ë¦¬ íŒŒí‹°!",
                    "ìµœê³ ì˜ ì—”í„°í…Œì¸ë¨¼íŠ¸!"
                ],
                CharacterPersonality.MYSTERIOUS: [
                    "ìš´ëª…ì´ ìš°ë¦¬ í¸ì´ì—ˆë‹¤.", "ë³„ë“¤ì´ ìŠ¹ë¦¬ë¥¼ ì˜ˆê³ í–ˆë‹¤.", "ì˜ˆì •ëœ ê²°ê³¼.",
                    "ìš°ì£¼ì˜ ëœ»ì´ì—ˆë‹¤.", "ìˆ™ëª…ì ì¸ ìŠ¹ë¦¬.", "ë³„ìë¦¬ê°€ ì¶•ë³µí–ˆë‹¤.",
                    "ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´ê°€ ëŒì•˜ë‹¤.", "ì˜ˆì–¸ì´ ì„±ì·¨ëë‹¤.", "ì‹ ë¹„ë¡œìš´ ìŠ¹ë¦¬.",
                    "ìš°ì£¼ê°€ ì¸ì •í•œ ê²°ê³¼."
                ],
                CharacterPersonality.HOT_TEMPERED: [
                    "ì‹œì›í•œ ìŠ¹ë¦¬ì•¼!", "ë“œë””ì–´ ì´ê²¼ì–´!", "ë¶ˆíƒ€ëŠ” ìŠ¹ë¦¬!",
                    "ì—´ì •ì˜ ê²°ê³¼ë‹¤!", "í™”ëˆí•œ ì „íˆ¬ì˜€ì–´!", "ì™„ì „ ì§œë¦¿í•´!",
                    "ì‹œì›í•˜ê²Œ ì´ê²¼ì–´!", "í­ë°œì ì¸ ìŠ¹ë¦¬!", "ë¶ˆíƒ€ëŠ” ì—´ì •ì˜ ê²°ê³¼!",
                    "ë“œë””ì–´ ì œëŒ€ë¡œ!"
                ],
                CharacterPersonality.WISE: [
                    "ì§€í˜œë¡œìš´ ìŠ¹ë¦¬ì˜€ë‹¤.", "ê²½í—˜ì´ ìŠ¹ë¦¬ë¥¼ ì´ëŒì—ˆë‹¤.", "í˜„ëª…í•œ ì „ëµì˜ ê²°ê³¼.",
                    "ê¹Šì´ ìˆëŠ” ì „íˆ¬ì˜€ë‹¤.", "ì§€ì‹ì˜ í˜ì„ ëŠê¼ˆë‹¤.", "ë°°ì›€ì˜ ê°€ì¹˜ë¥¼ í™•ì¸í–ˆë‹¤.",
                    "í˜„ëª…í•œ íŒë‹¨ì´ ìŠ¹ë¦¬ë¥¼ ë§Œë“¤ì—ˆë‹¤.", "ì˜¤ëœ ê²½í—˜ì˜ ê²°ì‹¤.", "ì§€í˜œë¡œìš´ ì „ìˆ .",
                    "ê¹¨ë‹¬ìŒì˜ ìŠ¹ë¦¬."
                ],
                CharacterPersonality.BALANCED: [
                    "ì¢‹ì€ ìŠ¹ë¦¬ì˜€ì–´ìš”.", "ì ì ˆí•œ ì „íˆ¬ì˜€ë„¤ìš”.", "ê· í˜•ì¡íŒ ìŠ¹ë¦¬ì˜ˆìš”.",
                    "í•¨ê»˜ ì´ê²¨ì„œ ì¢‹ì•„ìš”.", "ì ë‹¹íˆ ì˜ ëë‚¬ë„¤ìš”.", "ì„œë¡œ ë„ì™€ì„œ ì´ê²¼ì–´ìš”.",
                    "ê´œì°®ì€ ê²°ê³¼ë„¤ìš”.", "ì•ˆì •ì ì¸ ìŠ¹ë¦¬ì˜€ì–´ìš”."
                ]
            }
        }
        
        if situation not in situational_dialogues:
            return
        
        # í•´ë‹¹ ìºë¦­í„°ë‚˜ AI ë™ë£Œ ì¤‘ í•˜ë‚˜ê°€ ë°˜ì‘
        if character and hasattr(character, 'personality'):
            personality = character.personality
            speaker = character
        elif self.ai_companions:
            companion = random.choice(self.ai_companions)
            personality = companion.personality if hasattr(companion, 'personality') else CharacterPersonality.BALANCED
            speaker = companion.character
        else:
            return
        
        # ì•ˆì „í•œ ê¸°ë³¸ ëŒ€ì‚¬ í’€
        default_dialogues = {
            "level_up": ["ë ˆë²¨ì—…í–ˆë„¤ìš”.", "ì¡°ê¸ˆ ë” ê°•í•´ì§„ ê²ƒ ê°™ì•„ìš”.", "ì„±ì¥í–ˆì–´ìš”.", "ì¢‹ì€ ê²°ê³¼ë„¤ìš”."],
            "critical_hit": ["ì¢‹ì€ íƒ€ê²©ì´ì—ˆì–´ìš”.", "ì˜ ë§ì•˜ë„¤ìš”.", "íš¨ê³¼ì ì´ì—ˆì–´ìš”.", "ì„±ê³µì ì´ì—ˆì–´ìš”."],
            "near_death": ["ì¡°ì‹¬í•´ì•¼ê² ì–´ìš”.", "ìœ„í—˜í•œ ìƒí™©ì´ë„¤ìš”.", "ì‹ ì¤‘í•˜ê²Œ í•´ì•¼ê² ì–´ìš”.", "ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”."],
            "item_discovery": ["ë­”ê°€ ë°œê²¬í–ˆì–´ìš”.", "ì•„ì´í…œì´ ìˆë„¤ìš”.", "ì¢‹ì€ ë°œê²¬ì´ì—ìš”.", "ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”."],
            "combat_victory": ["ìŠ¹ë¦¬í–ˆë„¤ìš”.", "ì˜ ëë‚¬ì–´ìš”.", "ì¢‹ì€ ê²°ê³¼ì˜ˆìš”.", "í•¨ê»˜ ì´ê²¨ì„œ ì¢‹ì•„ìš”."]
        }
        
        dialogues = situational_dialogues[situation].get(personality, 
                                                      default_dialogues.get(situation, ["..."]))
        dialogue = random.choice(dialogues)
        
        print(f"\nğŸ’¬ {speaker.name}: \"{dialogue}\"")
        time.sleep(1.5)
    
    def get_contextual_dialogue(self, character: Character, context: str, **kwargs) -> str:
        """ìƒí™©ì— ë§ëŠ” ëŒ€í™” ë°˜í™˜"""
        personality = getattr(character, 'personality', CharacterPersonality.BALANCED)
        
        # ê¸°ë³¸ ì„±ê²©ë³„ ëŒ€í™”
        if context in CharacterTraits.PERSONALITY_DIALOGUE.get(personality, {}):
            return CharacterTraits.get_dialogue(personality, context)
        
        # ì§ì—…ë³„ íŠ¹ìˆ˜ ëŒ€í™”
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        if character_class in CharacterTraits.CLASS_SPECIFIC_DIALOGUE:
            class_dialogues = CharacterTraits.CLASS_SPECIFIC_DIALOGUE[character_class]
            if context in class_dialogues:
                return random.choice(class_dialogues[context])
        
        # ê¸°ë³¸ ì‘ë‹µ
        return "..."
    
    def initialize_character_personalities(self, party: List[Character]):
        """íŒŒí‹°ì›ë“¤ì˜ ì„±ê²© ì´ˆê¸°í™” (ì´ë¦„ ê¸°ë°˜)"""
        for character in party:
            if not hasattr(character, 'personality'):
                # ì´ë¦„ìœ¼ë¡œ ì„±ë³„ í™•ì¸
                character.gender = CharacterTraits.get_gender_from_name(character.name)
                
                # ì§ì—… ê¸°ë°˜ ì„±ê²© í™•ë¥  ê³„ì‚°
                character_class = getattr(character, 'character_class', 'ì „ì‚¬')
                personality = self._get_personality_by_class_probability(character_class)
                character.personality = personality
                
                print(f"âœ¨ {character.name}ì˜ ì„±ê²©: {personality.value} (ì„±ë³„: {character.gender.value})")
    
    def _get_personality_by_class_probability(self, character_class: str) -> CharacterPersonality:
        """ì§ì—…ë³„ ì„±ê²© í™•ë¥ ì— ë”°ë¥¸ ì„±ê²© ê²°ì • (ì—…ë°ì´íŠ¸ëœ í™•ë¥ )"""
        
        # 28ê°œ ì§ì—…ë³„ ì„±ê²© í™•ë¥  ë¶„í¬ (ê° ì§ì—…ë§ˆë‹¤ 100% ì´í•©, ìµœì†Œ 1% ë³´ì¥)
        class_personality_weights = {
            # ë¬¼ë¦¬ ê·¼ì ‘ ê³„ì—´
            "ì „ì‚¬": {
                CharacterPersonality.HOT_TEMPERED: 25,
                CharacterPersonality.SERIOUS: 20,
                CharacterPersonality.BALANCED: 15,
                CharacterPersonality.CHEERFUL: 12,
                CharacterPersonality.WISE: 8,
                CharacterPersonality.COLD: 7,
                CharacterPersonality.GENTLE: 5,
                CharacterPersonality.MYSTERIOUS: 4,
                CharacterPersonality.PLAYFUL: 4
            },
            "ê¸°ì‚¬": {
                CharacterPersonality.SERIOUS: 30,
                CharacterPersonality.WISE: 20,
                CharacterPersonality.BALANCED: 15,
                CharacterPersonality.GENTLE: 10,
                CharacterPersonality.HOT_TEMPERED: 8,
                CharacterPersonality.CHEERFUL: 6,
                CharacterPersonality.COLD: 5,
                CharacterPersonality.MYSTERIOUS: 3,
                CharacterPersonality.PLAYFUL: 3
            },
            "ì„±ê¸°ì‚¬": {
                CharacterPersonality.WISE: 25,
                CharacterPersonality.SERIOUS: 20,
                CharacterPersonality.GENTLE: 18,
                CharacterPersonality.BALANCED: 12,
                CharacterPersonality.CHEERFUL: 8,
                CharacterPersonality.HOT_TEMPERED: 6,
                CharacterPersonality.MYSTERIOUS: 5,
                CharacterPersonality.COLD: 3,
                CharacterPersonality.PLAYFUL: 3
            },
            "ì•”í‘ê¸°ì‚¬": {
                CharacterPersonality.COLD: 25,
                CharacterPersonality.MYSTERIOUS: 20,
                CharacterPersonality.SERIOUS: 18,
                CharacterPersonality.HOT_TEMPERED: 12,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.WISE: 6,
                CharacterPersonality.CHEERFUL: 4,
                CharacterPersonality.GENTLE: 4,
                CharacterPersonality.PLAYFUL: 3
            },
            "ìš©ê¸°ì‚¬": {
                CharacterPersonality.HOT_TEMPERED: 30,
                CharacterPersonality.WISE: 15,
                CharacterPersonality.SERIOUS: 15,
                CharacterPersonality.MYSTERIOUS: 12,
                CharacterPersonality.BALANCED: 10,
                CharacterPersonality.CHEERFUL: 6,
                CharacterPersonality.COLD: 5,
                CharacterPersonality.GENTLE: 4,
                CharacterPersonality.PLAYFUL: 3
            },
            "ê²€ì„±": {
                CharacterPersonality.WISE: 30,
                CharacterPersonality.SERIOUS: 25,
                CharacterPersonality.COLD: 15,
                CharacterPersonality.MYSTERIOUS: 10,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.HOT_TEMPERED: 5,
                CharacterPersonality.GENTLE: 3,
                CharacterPersonality.CHEERFUL: 2,
                CharacterPersonality.PLAYFUL: 2
            },
            "ì‚¬ë¬´ë¼ì´": {
                CharacterPersonality.SERIOUS: 25,
                CharacterPersonality.WISE: 20,
                CharacterPersonality.HOT_TEMPERED: 15,
                CharacterPersonality.COLD: 12,
                CharacterPersonality.BALANCED: 10,
                CharacterPersonality.MYSTERIOUS: 8,
                CharacterPersonality.GENTLE: 5,
                CharacterPersonality.CHEERFUL: 3,
                CharacterPersonality.PLAYFUL: 2
            },
            "ê²€íˆ¬ì‚¬": {
                CharacterPersonality.HOT_TEMPERED: 35,
                CharacterPersonality.PLAYFUL: 20,
                CharacterPersonality.CHEERFUL: 15,
                CharacterPersonality.SERIOUS: 10,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.COLD: 5,
                CharacterPersonality.WISE: 3,
                CharacterPersonality.MYSTERIOUS: 2,
                CharacterPersonality.GENTLE: 2
            },
            "ê´‘ì „ì‚¬": {
                CharacterPersonality.HOT_TEMPERED: 40,
                CharacterPersonality.COLD: 15,
                CharacterPersonality.PLAYFUL: 12,
                CharacterPersonality.SERIOUS: 10,
                CharacterPersonality.MYSTERIOUS: 8,
                CharacterPersonality.BALANCED: 6,
                CharacterPersonality.CHEERFUL: 4,
                CharacterPersonality.WISE: 3,
                CharacterPersonality.GENTLE: 2
            },
            "ëª½í¬": {
                CharacterPersonality.WISE: 30,
                CharacterPersonality.BALANCED: 20,
                CharacterPersonality.GENTLE: 15,
                CharacterPersonality.SERIOUS: 12,
                CharacterPersonality.MYSTERIOUS: 10,
                CharacterPersonality.COLD: 5,
                CharacterPersonality.CHEERFUL: 4,
                CharacterPersonality.HOT_TEMPERED: 2,
                CharacterPersonality.PLAYFUL: 2
            },
            
            # ì›ê±°ë¦¬ ë¬¼ë¦¬ ê³„ì—´
            "ê¶ìˆ˜": {
                CharacterPersonality.COLD: 25,
                CharacterPersonality.SERIOUS: 20,
                CharacterPersonality.BALANCED: 15,
                CharacterPersonality.WISE: 12,
                CharacterPersonality.CHEERFUL: 10,
                CharacterPersonality.GENTLE: 8,
                CharacterPersonality.MYSTERIOUS: 5,
                CharacterPersonality.PLAYFUL: 3,
                CharacterPersonality.HOT_TEMPERED: 2
            },
            "ë„ì ": {
                CharacterPersonality.COLD: 25,
                CharacterPersonality.MYSTERIOUS: 20,
                CharacterPersonality.PLAYFUL: 15,
                CharacterPersonality.SERIOUS: 12,
                CharacterPersonality.BALANCED: 10,
                CharacterPersonality.HOT_TEMPERED: 8,
                CharacterPersonality.WISE: 5,
                CharacterPersonality.CHEERFUL: 3,
                CharacterPersonality.GENTLE: 2
            },
            "ì•”ì‚´ì": {
                CharacterPersonality.COLD: 35,
                CharacterPersonality.MYSTERIOUS: 25,
                CharacterPersonality.SERIOUS: 15,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.WISE: 6,
                CharacterPersonality.HOT_TEMPERED: 4,
                CharacterPersonality.PLAYFUL: 3,
                CharacterPersonality.GENTLE: 2,
                CharacterPersonality.CHEERFUL: 2
            },
            "í•´ì ": {
                CharacterPersonality.PLAYFUL: 30,
                CharacterPersonality.HOT_TEMPERED: 25,
                CharacterPersonality.CHEERFUL: 15,
                CharacterPersonality.COLD: 10,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.SERIOUS: 5,
                CharacterPersonality.MYSTERIOUS: 3,
                CharacterPersonality.WISE: 2,
                CharacterPersonality.GENTLE: 2
            },
            
            # ë§ˆë²• ê³„ì—´
            "ì•„í¬ë©”ì´ì§€": {
                CharacterPersonality.WISE: 30,
                CharacterPersonality.SERIOUS: 20,
                CharacterPersonality.COLD: 15,
                CharacterPersonality.MYSTERIOUS: 12,
                CharacterPersonality.BALANCED: 10,
                CharacterPersonality.GENTLE: 5,
                CharacterPersonality.CHEERFUL: 4,
                CharacterPersonality.HOT_TEMPERED: 2,
                CharacterPersonality.PLAYFUL: 2
            },
            "ë„¤í¬ë¡œë§¨ì„œ": {
                CharacterPersonality.COLD: 30,
                CharacterPersonality.MYSTERIOUS: 25,
                CharacterPersonality.SERIOUS: 15,
                CharacterPersonality.WISE: 10,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.HOT_TEMPERED: 5,
                CharacterPersonality.GENTLE: 3,
                CharacterPersonality.PLAYFUL: 2,
                CharacterPersonality.CHEERFUL: 2
            },
            "ì •ë ¹ìˆ ì‚¬": {
                CharacterPersonality.MYSTERIOUS: 25,
                CharacterPersonality.GENTLE: 20,
                CharacterPersonality.WISE: 15,
                CharacterPersonality.CHEERFUL: 12,
                CharacterPersonality.BALANCED: 10,
                CharacterPersonality.SERIOUS: 8,
                CharacterPersonality.PLAYFUL: 5,
                CharacterPersonality.COLD: 3,
                CharacterPersonality.HOT_TEMPERED: 2
            },
            "ì‹œê°„ìˆ ì‚¬": {
                CharacterPersonality.MYSTERIOUS: 35,
                CharacterPersonality.WISE: 20,
                CharacterPersonality.COLD: 15,
                CharacterPersonality.SERIOUS: 12,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.GENTLE: 4,
                CharacterPersonality.CHEERFUL: 3,
                CharacterPersonality.PLAYFUL: 2,
                CharacterPersonality.HOT_TEMPERED: 1
            },
            "ì°¨ì›ìˆ ì‚¬": {
                CharacterPersonality.MYSTERIOUS: 40,
                CharacterPersonality.COLD: 20,
                CharacterPersonality.WISE: 15,
                CharacterPersonality.SERIOUS: 10,
                CharacterPersonality.BALANCED: 6,
                CharacterPersonality.HOT_TEMPERED: 4,
                CharacterPersonality.PLAYFUL: 2,
                CharacterPersonality.GENTLE: 2,
                CharacterPersonality.CHEERFUL: 1
            },
            "ì—°ê¸ˆìˆ ì‚¬": {
                CharacterPersonality.WISE: 25,
                CharacterPersonality.SERIOUS: 20,
                CharacterPersonality.CHEERFUL: 15,
                CharacterPersonality.BALANCED: 12,
                CharacterPersonality.PLAYFUL: 10,
                CharacterPersonality.GENTLE: 8,
                CharacterPersonality.MYSTERIOUS: 5,
                CharacterPersonality.COLD: 3,
                CharacterPersonality.HOT_TEMPERED: 2
            },
            "ë§ˆê²€ì‚¬": {
                CharacterPersonality.SERIOUS: 25,
                CharacterPersonality.COLD: 20,
                CharacterPersonality.WISE: 15,
                CharacterPersonality.HOT_TEMPERED: 12,
                CharacterPersonality.MYSTERIOUS: 10,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.CHEERFUL: 5,
                CharacterPersonality.GENTLE: 3,
                CharacterPersonality.PLAYFUL: 2
            },
            "ê¸°ê³„ê³µí•™ì": {
                CharacterPersonality.SERIOUS: 30,
                CharacterPersonality.WISE: 20,
                CharacterPersonality.COLD: 15,
                CharacterPersonality.BALANCED: 12,
                CharacterPersonality.PLAYFUL: 8,
                CharacterPersonality.CHEERFUL: 6,
                CharacterPersonality.MYSTERIOUS: 4,
                CharacterPersonality.GENTLE: 3,
                CharacterPersonality.HOT_TEMPERED: 2
            },
            
            # ì§€ì› ê³„ì—´
            "ë°”ë“œ": {
                CharacterPersonality.CHEERFUL: 30,
                CharacterPersonality.PLAYFUL: 20,
                CharacterPersonality.GENTLE: 15,
                CharacterPersonality.BALANCED: 12,
                CharacterPersonality.WISE: 8,
                CharacterPersonality.SERIOUS: 6,
                CharacterPersonality.MYSTERIOUS: 4,
                CharacterPersonality.HOT_TEMPERED: 3,
                CharacterPersonality.COLD: 2
            },
            "ì‹ ê´€": {
                CharacterPersonality.GENTLE: 30,
                CharacterPersonality.WISE: 25,
                CharacterPersonality.SERIOUS: 15,
                CharacterPersonality.BALANCED: 10,
                CharacterPersonality.MYSTERIOUS: 8,
                CharacterPersonality.CHEERFUL: 5,
                CharacterPersonality.COLD: 3,
                CharacterPersonality.PLAYFUL: 2,
                CharacterPersonality.HOT_TEMPERED: 2
            },
            "ë“œë£¨ì´ë“œ": {
                CharacterPersonality.WISE: 25,
                CharacterPersonality.GENTLE: 20,
                CharacterPersonality.MYSTERIOUS: 15,
                CharacterPersonality.BALANCED: 12,
                CharacterPersonality.CHEERFUL: 10,
                CharacterPersonality.SERIOUS: 8,
                CharacterPersonality.COLD: 5,
                CharacterPersonality.PLAYFUL: 3,
                CharacterPersonality.HOT_TEMPERED: 2
            },
            "ë¬´ë‹¹": {
                CharacterPersonality.MYSTERIOUS: 30,
                CharacterPersonality.WISE: 20,
                CharacterPersonality.GENTLE: 15,
                CharacterPersonality.SERIOUS: 10,
                CharacterPersonality.BALANCED: 8,
                CharacterPersonality.CHEERFUL: 7,
                CharacterPersonality.COLD: 5,
                CharacterPersonality.PLAYFUL: 3,
                CharacterPersonality.HOT_TEMPERED: 2
            },
            
            # íŠ¹ìˆ˜ ê³„ì—´
            "ì² í•™ì": {
                CharacterPersonality.WISE: 40,
                CharacterPersonality.SERIOUS: 20,
                CharacterPersonality.BALANCED: 12,
                CharacterPersonality.MYSTERIOUS: 10,
                CharacterPersonality.GENTLE: 8,
                CharacterPersonality.COLD: 5,
                CharacterPersonality.CHEERFUL: 3,
                CharacterPersonality.PLAYFUL: 1,
                CharacterPersonality.HOT_TEMPERED: 1
            }
        }
        
        # ê¸°ë³¸ ê°€ì¤‘ì¹˜ (ë§Œì•½ ì§ì—…ì´ ì—†ëŠ” ê²½ìš°)
        default_weights = {
            CharacterPersonality.BALANCED: 30,
            CharacterPersonality.CHEERFUL: 15,
            CharacterPersonality.SERIOUS: 15,
            CharacterPersonality.GENTLE: 10,
            CharacterPersonality.WISE: 10,
            CharacterPersonality.COLD: 8,
            CharacterPersonality.PLAYFUL: 5,
            CharacterPersonality.MYSTERIOUS: 4,
            CharacterPersonality.HOT_TEMPERED: 3
        }
        
        weights = class_personality_weights.get(character_class, default_weights)
        
        # ê°€ì¤‘ì¹˜ ê¸°ë°˜ ëœë¤ ì„ íƒ
        personalities = list(weights.keys())
        weight_values = [weights[p] for p in personalities]
        
        return random.choices(personalities, weights=weight_values, k=1)[0]
    
    def _handle_ai_requests(self):
        """AI ìš”ì²­ ì²˜ë¦¬"""
        if not self.pending_ai_requests:
            print("âŒ ì²˜ë¦¬í•  AI ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
        
        print(f"\nğŸ’¬ AI ìš”ì²­ ëª©ë¡ ({len(self.pending_ai_requests)}ê°œ):")
        for i, request in enumerate(self.pending_ai_requests, 1):
            print(f"{i}. {request['message']}")
        
        try:
            choice = int(input("ì²˜ë¦¬í•  ìš”ì²­ ì„ íƒ (0: ëª¨ë‘ ê±°ì ˆ): "))
            if choice == 0:
                print("ëª¨ë“  AI ìš”ì²­ì„ ê±°ì ˆí–ˆìŠµë‹ˆë‹¤.")
                self.pending_ai_requests.clear()
                return "defend", {}
            elif 1 <= choice <= len(self.pending_ai_requests):
                selected_request = self.pending_ai_requests[choice - 1]
                self.pending_ai_requests.remove(selected_request)
                
                # ìš”ì²­ ì²˜ë¦¬
                return self._process_ai_request(selected_request)
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return "defend", {}
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return "defend", {}
    
    def _process_ai_request(self, request: Dict) -> Tuple[str, Dict]:
        """AI ìš”ì²­ ì²˜ë¦¬ ì‹¤í–‰"""
        request_type = request["type"]
        companion = request["companion"]
        
        if request_type == "item_request":
            # ì•„ì´í…œ ê³µìœ  ìš”ì²­
            print(f"âœ… {companion.character.name}ì—ê²Œ ì•„ì´í…œì„ ê³µìœ í•©ë‹ˆë‹¤.")
            return "share_item", {"target": companion.character}
        
        elif request_type == "coordination_request":
            # í˜‘ë™ ê³µê²© ìš”ì²­
            print(f"âœ… {companion.character.name}ê³¼(ì™€) í˜‘ë™ ê³µê²©ì„ ì¤€ë¹„í•©ë‹ˆë‹¤.")
            companion.coordinated_attack_ready = True
            return "prepare_coordination", {"partner": companion.character}
        
        elif request_type == "retreat_suggestion":
            # í›„í‡´ ì œì•ˆ
            print(f"âœ… {companion.character.name}ì˜ ì œì•ˆì— ë”°ë¼ ì „ëµì  í›„í‡´ë¥¼ ê³ ë ¤í•©ë‹ˆë‹¤.")
            return "retreat", {}
        
        elif request_type == "skill_suggestion":
            # ìŠ¤í‚¬ ì‚¬ìš© ì œì•ˆ
            print(f"âœ… {companion.character.name}ì˜ ì œì•ˆì„ ë°›ì•„ë“¤ì…ë‹ˆë‹¤.")
            return "skill", {"suggested_by": companion.character}
        
        return "defend", {}
    
    def _get_action_description(self, action_type: str, action_data: Dict) -> str:
        """AI í–‰ë™ ì„¤ëª… ë°˜í™˜"""
        descriptions = {
            "attack": "ì ì„ ê³µê²©í•œë‹¤",
            "skill": "ìŠ¤í‚¬ì„ ì‚¬ìš©í•œë‹¤",
            "heal": "íšŒë³µ ë§ˆë²•ì„ ì‚¬ìš©í•œë‹¤",
            "defend": "ë°©ì–´ ìì„¸ë¥¼ ì·¨í•œë‹¤",
            "item": "ì•„ì´í…œì„ ì‚¬ìš©í•œë‹¤",
            "coordinated_attack": "í˜‘ë™ ê³µê²©ì„ ì‹œë„í•œë‹¤",
            "retreat": "ì „ëµì ìœ¼ë¡œ í›„í‡´í•œë‹¤"
        }
        
        base_description = descriptions.get(action_type, "í–‰ë™ì„ ì·¨í•œë‹¤")
        
        # ëŒ€ìƒì´ ìˆëŠ” ê²½ìš° ì¶”ê°€ ì •ë³´
        if "target" in action_data:
            target = action_data["target"]
            base_description += f" (ëŒ€ìƒ: {target.name})"
        
        return base_description
    
    def _show_party_status(self, party: List[Character]):
        """íŒŒí‹° ìƒíƒœ í‘œì‹œ"""
        print(f"\nğŸ“Š íŒŒí‹° ìƒíƒœ:")
        print("=" * 50)
        
        for i, character in enumerate(party, 1):
            status_icon = "ğŸ®" if character in self.player_controlled_characters else "ğŸ¤–"
            personality_text = ""
            
            if hasattr(character, 'personality'):
                personality_text = f" ({character.personality.value})"
            
            print(f"{i}. {status_icon} {character.name}{personality_text}")
            print(f"   Lv.{character.level} {character.character_class}")
            print(f"   HP: {character.current_hp}/{character.max_hp}")
            print(f"   MP: {character.current_mp}/{character.max_mp}")
            
            # ìƒíƒœ ì´ìƒì´ ìˆë‹¤ë©´ í‘œì‹œ
            if hasattr(character, 'status_effects') and character.status_effects:
                effects = ", ".join(character.status_effects.keys())
                print(f"   ìƒíƒœ: {effects}")
            
            print()
        
        print("=" * 50)
        print(f"ì¡°ì‘ ë°©ì‹: {self.current_mode.value}")
        print(f"í”Œë ˆì´ì–´ ì¡°ì‘: {len(self.player_controlled_characters)}ëª…")
        print(f"AI ì¡°ì‘: {len(self.ai_companions)}ëª…")
        
        if self.pending_ai_requests:
            print(f"ëŒ€ê¸° ì¤‘ì¸ AI ìš”ì²­: {len(self.pending_ai_requests)}ê°œ")

# í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
def test_ai_personality_system():
    """AI ì„±ê²© ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸"""
    print("ğŸ§ª AI ì„±ê²© ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œì‘...")
    
    # ëª¨ë“  ì§ì—…ì— ëŒ€í•´ ì„±ê²© ë¶„í¬ í…ŒìŠ¤íŠ¸
    classes_to_test = [
        "ì „ì‚¬", "ê¸°ì‚¬", "ì„±ê¸°ì‚¬", "ì•”í‘ê¸°ì‚¬", "ìš©ê¸°ì‚¬", "ê²€ì„±", "ì‚¬ë¬´ë¼ì´", "ê²€íˆ¬ì‚¬", "ê´‘ì „ì‚¬", "ëª½í¬",
        "ê¶ìˆ˜", "ë„ì ", "ì•”ì‚´ì", "í•´ì ", "ì•„í¬ë©”ì´ì§€", "ë„¤í¬ë¡œë§¨ì„œ", "ì •ë ¹ìˆ ì‚¬", "ì‹œê°„ìˆ ì‚¬", 
        "ì°¨ì›ìˆ ì‚¬", "ì—°ê¸ˆìˆ ì‚¬", "ë§ˆê²€ì‚¬", "ê¸°ê³„ê³µí•™ì", "ë°”ë“œ", "ì‹ ê´€", "ë“œë£¨ì´ë“œ", "ë¬´ë‹¹", "ì² í•™ì"
    ]
    
    for character_class in classes_to_test:
        print(f"\nğŸ“Š {character_class} ì„±ê²© ë¶„í¬ í…ŒìŠ¤íŠ¸ (1000íšŒ ìƒ˜í”Œë§):")
        
        personality_counts = {}
        for _ in range(1000):
            personality = ai_game_mode_manager._get_personality_by_class_probability(character_class)
            personality_counts[personality] = personality_counts.get(personality, 0) + 1
        
        # ê²°ê³¼ ì¶œë ¥ (í™•ë¥  ìˆœ ì •ë ¬)
        sorted_results = sorted(personality_counts.items(), key=lambda x: x[1], reverse=True)
        for personality, count in sorted_results:
            percentage = (count / 1000) * 100
            print(f"   {personality.value}: {percentage:.1f}%")
    
    print("\nâœ… AI ì„±ê²© ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!")


def test_dialogue_system():
    """AI ëŒ€í™” ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸"""
    print("ğŸ­ AI ëŒ€í™” ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œì‘...")
    
    # ê° ì„±ê²©ë³„ ëŒ€í™” í…ŒìŠ¤íŠ¸
    for personality in CharacterPersonality:
        print(f"\nğŸª {personality.value} ì„±ê²© ëŒ€í™” í…ŒìŠ¤íŠ¸:")
        
        # ë‹¤ì–‘í•œ ìƒí™©ë³„ ëŒ€í™” í…ŒìŠ¤íŠ¸
        situations = ["greeting", "battle_start", "victory", "low_hp", "praise", "thanks"]
        
        for situation in situations[:3]:  # ì²˜ìŒ 3ê°œë§Œ í…ŒìŠ¤íŠ¸
            try:
                dialogue = CharacterTraits.get_dialogue(personality, situation)
                print(f"   {situation}: \"{dialogue}\"")
            except:
                print(f"   {situation}: ëŒ€í™” ì—†ìŒ")
    
    print("\nâœ… AI ëŒ€í™” ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!")


if __name__ == "__main__":
    # ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    test_ai_personality_system()
    test_dialogue_system()
    
    print("\n" + "="*60)
    print("ğŸ® AI ê²Œì„ëª¨ë“œ ì‹œìŠ¤í…œ ì™„ë£Œ!")
    print("   âœ… 9ê°€ì§€ ì„±ê²© ì‹œìŠ¤í…œ")
    print("   âœ… 28ê°œ ì§ì—…ë³„ ì„±ê²© í™•ë¥  ë¶„í¬")
    print("   âœ… 1500+ ê°œì˜ ëŒ€í™” ë¼ì¸")
    print("   âœ… ì„±ë³„ ê¸°ë°˜ ì´ë¦„ ì‹œìŠ¤í…œ")
    print("   âœ… í˜‘ë™ ê³µê²© ì‹œìŠ¤í…œ")
    print("   âœ… í•„ë“œ ëŒ€í™” ì‹œìŠ¤í…œ")
    print("   âœ… íŒŒí‹° ì¸ì¹´ìš´í„° ì‹œìŠ¤í…œ")
    print("   âœ… ì¥ë¹„ ë‚´êµ¬ë„ ì‹œìŠ¤í…œ")
    print("   âœ… ì¥ë¹„ ê°•í™” ì¶”ì²œ")
    print("   âœ… ìŠ¤ë§ˆíŠ¸ ì¥ë¹„ ì¶”ì²œ")
    print("   âœ… ì „íˆ¬ ì‹œìŠ¤í…œ í†µí•©")
    print("="*60)

# ê¸°ë³¸ ê²Œì„ëª¨ë“œìš© ì¥ë¹„ ìë™ ì¥ì°© ì‹œìŠ¤í…œ
class BasicEquipmentManager:
    """ê¸°ë³¸ ê²Œì„ëª¨ë“œìš© ì¥ë¹„ ìë™ ì¥ì°© ë° ì¶”ì²œ ì‹œìŠ¤í…œ"""
    
    def __init__(self):
        # ëª¨ë“  ì§ì—…ë³„ ì¥ë¹„ ìš°ì„ ìˆœìœ„ (28ê°œ ì§ì—… í¬í•¨)
        self.class_equipment_priority = {
            # ê·¼ì ‘ ì „íˆ¬ ì§ì—…
            'ì „ì‚¬': {'weapon': 1.2, 'armor': 1.1, 'shield': 1.0, 'boots': 0.9, 'gloves': 0.8, 'accessory': 0.7},
            'ê¸°ì‚¬': {'weapon': 1.1, 'armor': 1.2, 'shield': 1.1, 'helmet': 1.0, 'boots': 0.9, 'accessory': 0.8},
            'ì„±ê¸°ì‚¬': {'weapon': 1.0, 'armor': 1.2, 'shield': 1.1, 'helmet': 1.0, 'accessory': 0.9, 'boots': 0.8},
            'ì•”í‘ê¸°ì‚¬': {'weapon': 1.1, 'armor': 1.1, 'helmet': 1.0, 'gloves': 0.9, 'boots': 0.8, 'accessory': 1.0},
            'ìš©ê¸°ì‚¬': {'weapon': 1.2, 'armor': 1.1, 'helmet': 1.0, 'boots': 0.9, 'gloves': 0.8, 'accessory': 0.9},
            'ê²€ì„±': {'weapon': 1.3, 'armor': 1.0, 'gloves': 1.0, 'boots': 0.9, 'accessory': 0.8, 'helmet': 0.7},
            'ì‚¬ë¬´ë¼ì´': {'weapon': 1.2, 'armor': 1.0, 'gloves': 1.1, 'boots': 1.0, 'helmet': 0.9, 'accessory': 0.8},
            'ê²€íˆ¬ì‚¬': {'weapon': 1.2, 'armor': 0.9, 'gloves': 1.1, 'boots': 1.0, 'helmet': 0.8, 'accessory': 0.8},
            'ê´‘ì „ì‚¬': {'weapon': 1.3, 'armor': 0.8, 'gloves': 1.0, 'boots': 0.9, 'helmet': 0.7, 'accessory': 0.7},
            'ëª½í¬': {'weapon': 0.8, 'gloves': 1.3, 'boots': 1.1, 'armor': 0.9, 'accessory': 1.0, 'helmet': 0.7},
            
            # ì›ê±°ë¦¬ ì „íˆ¬ ì§ì—…
            'ê¶ìˆ˜': {'weapon': 1.3, 'boots': 1.1, 'gloves': 1.0, 'armor': 0.8, 'helmet': 0.8, 'accessory': 0.9},
            'ë„ì ': {'weapon': 1.2, 'boots': 1.2, 'gloves': 1.1, 'armor': 0.7, 'helmet': 0.7, 'accessory': 1.0},
            'ì•”ì‚´ì': {'weapon': 1.3, 'boots': 1.2, 'gloves': 1.1, 'armor': 0.6, 'accessory': 1.1, 'helmet': 0.6},
            'í•´ì ': {'weapon': 1.2, 'boots': 1.0, 'gloves': 1.0, 'armor': 0.8, 'accessory': 1.1, 'helmet': 0.7},
            
            # ë§ˆë²• ì§ì—…
            'ì•„í¬ë©”ì´ì§€': {'weapon': 1.2, 'accessory': 1.2, 'armor': 0.8, 'helmet': 0.9, 'boots': 0.8, 'gloves': 0.9},
            'ë„¤í¬ë¡œë§¨ì„œ': {'weapon': 1.1, 'accessory': 1.3, 'armor': 0.8, 'helmet': 0.9, 'boots': 0.8, 'gloves': 0.9},
            'ì •ë ¹ìˆ ì‚¬': {'weapon': 1.1, 'accessory': 1.2, 'armor': 0.9, 'helmet': 0.9, 'boots': 0.9, 'gloves': 0.8},
            'ì‹œê°„ìˆ ì‚¬': {'weapon': 1.0, 'accessory': 1.3, 'armor': 0.8, 'helmet': 0.9, 'boots': 0.9, 'gloves': 0.9},
            'ì°¨ì›ìˆ ì‚¬': {'weapon': 1.1, 'accessory': 1.3, 'armor': 0.7, 'helmet': 0.8, 'boots': 1.0, 'gloves': 0.9},
            'ì—°ê¸ˆìˆ ì‚¬': {'weapon': 1.0, 'accessory': 1.1, 'armor': 0.9, 'helmet': 0.9, 'gloves': 1.1, 'boots': 0.8},
            
            # í•˜ì´ë¸Œë¦¬ë“œ ì§ì—…
            'ë§ˆê²€ì‚¬': {'weapon': 1.2, 'armor': 1.0, 'accessory': 1.1, 'gloves': 1.0, 'boots': 0.9, 'helmet': 0.8},
            'ê¸°ê³„ê³µí•™ì': {'weapon': 1.1, 'gloves': 1.2, 'armor': 1.0, 'accessory': 1.0, 'helmet': 0.9, 'boots': 0.8},
            
            # ì§€ì› ì§ì—…
            'ë°”ë“œ': {'weapon': 1.0, 'accessory': 1.2, 'armor': 0.9, 'boots': 1.0, 'gloves': 0.9, 'helmet': 0.8},
            'ì‹ ê´€': {'weapon': 0.8, 'armor': 1.1, 'accessory': 1.2, 'helmet': 1.0, 'boots': 0.9, 'gloves': 0.8},
            'í´ë ˆë¦­': {'weapon': 0.9, 'armor': 1.2, 'accessory': 1.1, 'helmet': 1.0, 'boots': 0.9, 'gloves': 0.8},
            'ë“œë£¨ì´ë“œ': {'weapon': 1.0, 'armor': 1.0, 'accessory': 1.1, 'boots': 1.0, 'gloves': 0.9, 'helmet': 0.8},
            'ë¬´ë‹¹': {'weapon': 0.9, 'accessory': 1.3, 'armor': 0.8, 'helmet': 0.9, 'boots': 0.9, 'gloves': 1.0},
            'ì² í•™ì': {'weapon': 0.7, 'accessory': 1.3, 'armor': 0.9, 'helmet': 1.0, 'boots': 0.9, 'gloves': 0.9}
        }
        
        # ìŠ¤íƒ¯ ìš°ì„ ìˆœìœ„ (ì§ì—…ë³„)
        self.class_stat_priority = {
            # ë¬¼ë¦¬ ê³µê²© ì§ì—…
            'ì „ì‚¬': {'attack_power': 1.2, 'physical_defense': 1.1, 'hp': 1.0, 'accuracy': 0.9},
            'ê¸°ì‚¬': {'physical_defense': 1.2, 'attack_power': 1.1, 'hp': 1.1, 'accuracy': 0.9},
            'ì„±ê¸°ì‚¬': {'physical_defense': 1.2, 'hp': 1.1, 'attack_power': 1.0, 'magic_defense': 1.0},
            'ì•”í‘ê¸°ì‚¬': {'attack_power': 1.1, 'magic_power': 1.0, 'physical_defense': 1.0, 'hp': 1.0},
            'ìš©ê¸°ì‚¬': {'attack_power': 1.2, 'physical_defense': 1.0, 'hp': 1.1, 'speed': 0.9},
            'ê²€ì„±': {'attack_power': 1.3, 'accuracy': 1.1, 'speed': 1.0, 'physical_defense': 0.9},
            'ì‚¬ë¬´ë¼ì´': {'attack_power': 1.2, 'accuracy': 1.1, 'speed': 1.0, 'physical_defense': 1.0},
            'ê²€íˆ¬ì‚¬': {'attack_power': 1.2, 'speed': 1.1, 'accuracy': 1.0, 'physical_defense': 0.9},
            'ê´‘ì „ì‚¬': {'attack_power': 1.3, 'speed': 1.0, 'accuracy': 0.9, 'physical_defense': 0.8},
            'ëª½í¬': {'attack_power': 1.1, 'speed': 1.2, 'accuracy': 1.1, 'physical_defense': 1.0},
            
            # ì›ê±°ë¦¬ ê³µê²© ì§ì—…  
            'ê¶ìˆ˜': {'attack_power': 1.2, 'accuracy': 1.2, 'speed': 1.1, 'physical_defense': 0.8},
            'ë„ì ': {'attack_power': 1.1, 'speed': 1.2, 'accuracy': 1.1, 'evasion': 1.1},
            'ì•”ì‚´ì': {'attack_power': 1.2, 'speed': 1.2, 'accuracy': 1.2, 'evasion': 1.1},
            'í•´ì ': {'attack_power': 1.1, 'speed': 1.0, 'accuracy': 1.0, 'physical_defense': 0.9},
            
            # ë§ˆë²• ì§ì—…
            'ì•„í¬ë©”ì´ì§€': {'magic_power': 1.3, 'mp': 1.2, 'magic_defense': 1.0, 'accuracy': 1.0},
            'ë„¤í¬ë¡œë§¨ì„œ': {'magic_power': 1.2, 'mp': 1.1, 'magic_defense': 1.0, 'speed': 0.9},
            'ì •ë ¹ìˆ ì‚¬': {'magic_power': 1.2, 'mp': 1.1, 'magic_defense': 1.1, 'speed': 1.0},
            'ì‹œê°„ìˆ ì‚¬': {'magic_power': 1.1, 'mp': 1.2, 'speed': 1.1, 'magic_defense': 1.0},
            'ì°¨ì›ìˆ ì‚¬': {'magic_power': 1.2, 'mp': 1.1, 'speed': 1.1, 'evasion': 1.0},
            'ì—°ê¸ˆìˆ ì‚¬': {'magic_power': 1.1, 'mp': 1.0, 'accuracy': 1.1, 'magic_defense': 1.0},
            
            # í•˜ì´ë¸Œë¦¬ë“œ ì§ì—…
            'ë§ˆê²€ì‚¬': {'attack_power': 1.1, 'magic_power': 1.1, 'mp': 1.0, 'physical_defense': 1.0},
            'ê¸°ê³„ê³µí•™ì': {'attack_power': 1.0, 'accuracy': 1.2, 'magic_power': 1.0, 'physical_defense': 1.0},
            
            # ì§€ì› ì§ì—…
            'ë°”ë“œ': {'mp': 1.2, 'magic_power': 1.0, 'speed': 1.1, 'magic_defense': 1.0},
            'ì‹ ê´€': {'mp': 1.2, 'magic_power': 1.1, 'magic_defense': 1.1, 'hp': 1.0},
            'í´ë ˆë¦­': {'mp': 1.1, 'magic_power': 1.1, 'magic_defense': 1.1, 'hp': 1.0},
            'ë“œë£¨ì´ë“œ': {'mp': 1.1, 'magic_power': 1.0, 'magic_defense': 1.0, 'hp': 1.0},
            'ë¬´ë‹¹': {'magic_power': 1.2, 'mp': 1.1, 'magic_defense': 1.1, 'speed': 1.0},
            'ì² í•™ì': {'mp': 1.3, 'magic_power': 1.1, 'magic_defense': 1.2, 'speed': 0.9}
        }
    
    def auto_equip_best_items(self, character: Character, inventory_items: List = None) -> List[str]:
        """ìºë¦­í„°ì—ê²Œ ìµœì ì˜ ì¥ë¹„ë¥¼ ìë™ìœ¼ë¡œ ì¥ì°© - ê°„ì†Œí™”ëœ ë²„ì „"""
        if not inventory_items:
            print(f"ğŸ¤– {character.name}: ì¥ì°©í•  ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤.")
            return []
        
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        equipped_items = []
        
        try:
            # ItemDatabase ê°€ì ¸ì˜¤ê¸° ì‹œë„
            try:
                from game.items import ItemDatabase, ItemType
                item_db = ItemDatabase()
            except ImportError:
                print("âŒ ItemDatabaseë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ì–´ ê¸°ë³¸ ì¥ì°© ì‹œìŠ¤í…œì„ ì‚¬ìš©í•©ë‹ˆë‹¤.")
                return self._basic_equip_items(character, inventory_items)
            
            # ë‹¨ìˆœí™”ëœ ì¥ë¹„ ì¥ì°© ë¡œì§
            equipment_found = False
            
            # ì¸ë²¤í† ë¦¬ì—ì„œ ì‹¤ì œ ì¥ë¹„ ì•„ì´í…œ ì°¾ê¸°
            for item_name in inventory_items:
                try:
                    # ì•„ì´í…œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    if isinstance(item_name, str):
                        item = item_db.get_item(item_name)
                    else:
                        item = item_name
                        item_name = getattr(item, 'name', str(item))
                    
                    # ì¥ë¹„ ì•„ì´í…œì¸ì§€ í™•ì¸
                    if item and hasattr(item, 'item_type'):
                        item_type = item.item_type
                        if item_type in [ItemType.WEAPON, ItemType.ARMOR, ItemType.ACCESSORY]:
                            # ì‹¤ì œë¡œ ì¥ì°© ì‹œë„
                            success = self._simple_equip_item(character, item)
                            if success:
                                equipped_items.append(f"{item_type.value}: {item_name}")
                                equipment_found = True
                                print(f"   âœ… {character.name}ì—ê²Œ {item_name} ì¥ì°© ì™„ë£Œ")
                            
                            # ìµœëŒ€ 3ê°œ ì¥ë¹„ê¹Œì§€ë§Œ ì¥ì°©
                            if len(equipped_items) >= 3:
                                break
                                
                except Exception as e:
                    print(f"   âš ï¸ {item_name} ì¥ì°© ì‹œë„ ì¤‘ ì˜¤ë¥˜: {e}")
                    continue
            
            if not equipment_found:
                print(f"ğŸ¤– {character.name}: ì¥ì°© ê°€ëŠ¥í•œ ì¥ë¹„ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.")
            
            return equipped_items
            
        except Exception as e:
            print(f"âŒ AI ìë™ì¥ì°© ì‹œìŠ¤í…œ ì˜¤ë¥˜: {e}")
            return []
    
    def _simple_equip_item(self, character: Character, item) -> bool:
        """ê°„ë‹¨í•œ ì¥ë¹„ ì¥ì°© ë©”ì„œë“œ"""
        try:
            # ìºë¦­í„°ê°€ ì¥ë¹„ ì‹œìŠ¤í…œì„ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸
            if not hasattr(character, 'equip_item'):
                return False
                
            # ì¥ë¹„ ì¥ì°© ì‹œë„
            result = character.equip_item(item)
            return result is not False  # Noneì´ë‚˜ Trueë©´ ì„±ê³µìœ¼ë¡œ ê°„ì£¼
            
        except Exception as e:
            return False
    
    def _basic_equip_items(self, character: Character, inventory_items: List) -> List[str]:
        """ê¸°ë³¸ ì¥ì°© ì‹œìŠ¤í…œ (í´ë°±ìš©) - íŒŒí‹° ê· ë“± ë¶„ë°°"""
        equipped_items = []
        print(f"ğŸ”§ {character.name}ì— ëŒ€í•´ ê¸°ë³¸ ì¥ì°© ì‹œìŠ¤í…œì„ ì‚¬ìš©í•©ë‹ˆë‹¤...")
        
        # ìºë¦­í„°ë³„ ì í•©ë„ ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ì—¬ ê°€ì¥ ì í•©í•œ ì•„ì´í…œë§Œ ì„ íƒ
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        class_priorities = {
            'ì „ì‚¬': ['weapon', 'armor', 'shield'],
            'ì•„í¬ë©”ì´ì§€': ['weapon', 'accessory'],
            'ê¶ìˆ˜': ['weapon', 'boots'],
            'ë„ì ': ['weapon', 'boots', 'gloves'],
            'ì„±ê¸°ì‚¬': ['armor', 'shield', 'helmet'],
            'ì•”ì‚´ì': ['weapon', 'boots']
        }
        
        preferred_slots = class_priorities.get(character_class, ['weapon', 'armor'])
        
        # ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ìŠ¬ë¡¯ì˜ ì•„ì´í…œë§Œ ì„ íƒ
        for i, item_name in enumerate(inventory_items[:2]):  # ìµœëŒ€ 2ê°œê¹Œì§€ë§Œ
            try:
                slot = preferred_slots[i % len(preferred_slots)]
                equipped_items.append(f"{slot}: {item_name}")
                if len(equipped_items) >= 2:  # ìºë¦­í„°ë‹¹ ìµœëŒ€ 2ê°œ
                    break
            except Exception as e:
                continue
        
        if equipped_items:
            print(f"âœ… {character.name} ê¸°ë³¸ ì¥ì°© ì™„ë£Œ: {len(equipped_items)}ê°œ ì•„ì´í…œ")
        
        return equipped_items
    
    def _find_best_item_for_type(self, character: Character, item_type_value: str, available_items: List, item_db):
        """íŠ¹ì • ì•„ì´í…œ íƒ€ì…ì— ìµœì ì¸ ì•„ì´í…œ ì°¾ê¸°"""
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        
        # í•´ë‹¹ íƒ€ì…ì— ì¥ì°© ê°€ëŠ¥í•œ ì•„ì´í…œë“¤ í•„í„°ë§
        suitable_items = []
        for item_name in available_items:
            # ë¨¼ì € ì¸ë²¤í† ë¦¬ì—ì„œ ì‹¤ì œ ì•„ì´í…œì´ ìˆëŠ”ì§€ í™•ì¸
            has_in_inventory = False
            if hasattr(character, 'inventory') and hasattr(character.inventory, 'has_item'):
                has_in_inventory = character.inventory.has_item(item_name)
            elif hasattr(character, 'inventory') and hasattr(character.inventory, 'items'):
                has_in_inventory = item_name in character.inventory.items and character.inventory.items[item_name] > 0
            
            if not has_in_inventory:
                continue  # ì¸ë²¤í† ë¦¬ì— ì—†ëŠ” ì•„ì´í…œì€ ìŠ¤í‚µ
            
            item = item_db.get_item(item_name)
            if item and hasattr(item, 'item_type') and item.item_type.value == item_type_value:
                suitable_items.append(item)
        
        if not suitable_items:
            return None
        
        # ê° ì•„ì´í…œì˜ ì ìˆ˜ ê³„ì‚°
        best_item = None
        best_score = -1
        
        for item in suitable_items:
            score = self._calculate_item_score(character, item, character_class)
            if score > best_score:
                best_score = score
                best_item = item
        
        return best_item
    
    def _find_best_item_for_slot(self, character: Character, slot: str, available_items: List, item_db):
        """íŠ¹ì • ìŠ¬ë¡¯ì— ìµœì ì¸ ì•„ì´í…œ ì°¾ê¸° (ë ˆê±°ì‹œ í•¨ìˆ˜)"""
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        
        # í•´ë‹¹ ìŠ¬ë¡¯ì— ì¥ì°© ê°€ëŠ¥í•œ ì•„ì´í…œë“¤ í•„í„°ë§
        suitable_items = []
        for item_name in available_items:
            # ë¨¼ì € ì¸ë²¤í† ë¦¬ì—ì„œ ì‹¤ì œ ì•„ì´í…œì´ ìˆëŠ”ì§€ í™•ì¸
            has_in_inventory = False
            if hasattr(character, 'inventory') and hasattr(character.inventory, 'has_item'):
                has_in_inventory = character.inventory.has_item(item_name)
            elif hasattr(character, 'inventory') and hasattr(character.inventory, 'items'):
                has_in_inventory = item_name in character.inventory.items and character.inventory.items[item_name] > 0
            
            if not has_in_inventory:
                continue  # ì¸ë²¤í† ë¦¬ì— ì—†ëŠ” ì•„ì´í…œì€ ìŠ¤í‚µ
            
            item = item_db.get_item(item_name)
            if item and hasattr(item, 'item_type') and item.item_type == 'equipment':
                item_slot = getattr(item, 'equipment_slot', None)
                if item_slot and item_slot.lower() == slot.lower():
                    suitable_items.append(item)
        
        if not suitable_items:
            return None
        
        # ê° ì•„ì´í…œì˜ ì ìˆ˜ ê³„ì‚°
        best_item = None
        best_score = -1
        
        for item in suitable_items:
            score = self._calculate_item_score(character, item, character_class)
            if score > best_score:
                best_score = score
                best_item = item
        
        return best_item
    
    def _calculate_item_score(self, character: Character, item, character_class: str) -> float:
        """ì•„ì´í…œì˜ ìºë¦­í„° ì í•©ë„ ì ìˆ˜ ê³„ì‚°"""
        score = 0.0
        
        # ì§ì—…ë³„ ì¥ë¹„ íƒ€ì… ìš°ì„ ìˆœìœ„ ì ìš©
        equipment_priorities = self.class_equipment_priority.get(character_class, {})
        item_slot = getattr(item, 'equipment_slot', 'weapon').lower()
        slot_priority = equipment_priorities.get(item_slot, 1.0)
        
        # ì§ì—…ë³„ ìŠ¤íƒ¯ ìš°ì„ ìˆœìœ„ ì ìš©
        stat_priorities = self.class_stat_priority.get(character_class, {})
        
        # ê° ìŠ¤íƒ¯ ë³´ë„ˆìŠ¤ ì ìˆ˜ ê³„ì‚°
        stat_bonuses = {
            'attack_power': getattr(item, 'physical_attack_bonus', 0),
            'magic_power': getattr(item, 'magic_attack_bonus', 0),
            'physical_defense': getattr(item, 'physical_defense_bonus', 0),
            'magic_defense': getattr(item, 'magic_defense_bonus', 0),
            'hp': getattr(item, 'hp_bonus', 0),
            'mp': getattr(item, 'mp_bonus', 0),
            'speed': getattr(item, 'speed_bonus', 0),
            'accuracy': getattr(item, 'accuracy_bonus', 0),
            'evasion': getattr(item, 'evasion_bonus', 0)
        }
        
        for stat, bonus in stat_bonuses.items():
            if bonus > 0:
                stat_priority = stat_priorities.get(stat, 0.5)
                score += bonus * stat_priority
        
        # ìŠ¬ë¡¯ ìš°ì„ ìˆœìœ„ ì ìš©
        score *= slot_priority
        
        # ì•„ì´í…œ ë ˆë²¨/í’ˆì§ˆ ê³ ë ¤
        item_level = getattr(item, 'level_requirement', 1)
        if item_level <= getattr(character, 'level', 1):
            score *= 1.0  # ì ì ˆí•œ ë ˆë²¨
        else:
            score *= 0.1  # ë ˆë²¨ì´ ì•ˆ ë§ìŒ
        
        # ë‚´êµ¬ë„ ê³ ë ¤
        durability = getattr(item, 'durability', 100)
        score *= (durability / 100.0)
        
        # ê°•í™” ìˆ˜ì¹˜ ê³ ë ¤
        enhancement = getattr(item, 'enhancement_level', 0)
        score *= (1.0 + enhancement * 0.1)
        
        return score
    
    def _equip_item_to_character(self, character: Character, item, slot: str) -> bool:
        """ìºë¦­í„°ì—ê²Œ ì•„ì´í…œ ì¥ì°© (ì¸ë²¤í† ë¦¬ ì—°ë™ í¬í•¨) - ì•„ì´í…œ ì†Œì‹¤ ë°©ì§€ ê°•í™”"""
        try:
            # ğŸ›¡ï¸ ì•ˆì „ ê²€ì¦: ì•„ì´í…œì´ ì´ë¯¸ ì¥ì°©ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            if hasattr(character, 'equipped_items'):
                current_equipped = character.equipped_items.get(slot)
                if current_equipped and current_equipped.name == item.name:
                    return True  # ì´ë¯¸ ì¥ì°©ëœ ì•„ì´í…œì´ë©´ ì„±ê³µìœ¼ë¡œ ì²˜ë¦¬
            
            # ğŸ’ ì¸ë²¤í† ë¦¬ ê²€ì¦: ì•„ì´í…œì´ ì‹¤ì œë¡œ ë³´ìœ í•˜ê³  ìˆëŠ”ì§€ í™•ì¸
            if hasattr(character, 'inventory'):
                current_count = character.inventory.items.get(item.name, 0)
                if current_count <= 0:
                    return False
            
            # ìºë¦­í„°ì˜ ê¸°ë³¸ ì¥ì°© ì‹œìŠ¤í…œ ì‚¬ìš© (ìš°ì„  ì‹œë„)
            if hasattr(character, 'equip_item'):
                # Character í´ë˜ìŠ¤ì˜ ê¸°ë³¸ ì¥ì°© í•¨ìˆ˜ ì‚¬ìš© (ì¸ë²¤í† ë¦¬ ì²˜ë¦¬ í¬í•¨)
                success = character.equip_item(item)
                return success
            
            # ğŸ”’ í´ë°± ì‹œìŠ¤í…œ: Character.equip_item()ì´ ì—†ëŠ” ê²½ìš°ë§Œ ì‚¬ìš©
            if not hasattr(character, 'equipped_items'):
                character.equipped_items = {}
            
            # ê¸°ì¡´ ì•„ì´í…œì´ ìˆë‹¤ë©´ ì•ˆì „í•˜ê²Œ í•´ì œ
            old_item = character.equipped_items.get(slot)
            if old_item:
                # ê¸°ì¡´ ì•„ì´í…œì„ ì¸ë²¤í† ë¦¬ë¡œ ë°˜í™˜ (ì¤‘ë³µ ë°©ì§€)
                if hasattr(character, 'inventory') and hasattr(character.inventory, 'add_item'):
                    if not character.inventory.has_item(old_item.name):
                        character.inventory.add_item(old_item, 1)
                
                # ê¸°ì¡´ ì•„ì´í…œ ë³´ë„ˆìŠ¤ ì œê±°
                self._remove_equipment_bonuses(character, old_item)
            
            # ìƒˆ ì•„ì´í…œ ì¥ì°©
            character.equipped_items[slot] = item
            self._apply_equipment_bonuses(character, item)
            
            # ğŸ”¥ ì¤‘ìš”: ì¸ë²¤í† ë¦¬ì—ì„œ ì•„ì´í…œ 1ê°œë§Œ ì œê±° (ì•„ì´í…œ ì†Œì‹¤ ë°©ì§€ ì¬ê²€ì¦)
            if hasattr(character, 'inventory') and hasattr(character.inventory, 'remove_item'):
                before_count = character.inventory.items.get(item.name, 0)
                if before_count > 0:
                    success = character.inventory.remove_item(item.name, 1)
                    after_count = character.inventory.items.get(item.name, 0)
                    print(f"ğŸ“¦ {item.name} ì¸ë²¤í† ë¦¬ì—ì„œ ì œê±°: {before_count}ê°œ â†’ {after_count}ê°œ")
                    if not success:
                        print(f"âš ï¸ {item.name} ì œê±° ì‹¤íŒ¨ - í´ë°± ì¥ì°© ì·¨ì†Œ")
                        return False
                else:
                    print(f"âš ï¸ {item.name} ì¸ë²¤í† ë¦¬ì— ì—†ìŒ - ì œê±° ê±´ë„ˆëœ€")
            
            print(f"âœ… {character.name}: {item.name} í´ë°± ì¥ì°© ì™„ë£Œ")
            return True
            
        except Exception as e:
            print(f"âŒ ì¥ë¹„ ì¥ì°© ì‹¤íŒ¨: {e}")
            # ì˜¤ë¥˜ ë°œìƒ ì‹œ ì•„ì´í…œ ìƒíƒœ ë³µêµ¬ ì‹œë„
            if hasattr(character, 'inventory') and hasattr(character.inventory, 'has_item'):
                if not character.inventory.has_item(item.name):
                    # ì•„ì´í…œì´ ì†Œì‹¤ëœ ê²½ìš° ë³µêµ¬
                    character.inventory.add_item(item, 1)
                    print(f"ğŸ”§ ì•„ì´í…œ ì†Œì‹¤ ë³µêµ¬: {item.name}")
            return False
    
    def _apply_equipment_bonuses(self, character: Character, item):
        """ì¥ë¹„ ë³´ë„ˆìŠ¤ ì ìš©"""
        bonuses = {
            'physical_attack_bonus': 'attack_power',
            'magic_attack_bonus': 'magic_power', 
            'physical_defense_bonus': 'physical_defense',
            'magic_defense_bonus': 'magic_defense',
            'hp_bonus': 'max_hp',
            'mp_bonus': 'max_mp',
            'speed_bonus': 'speed',
            'accuracy_bonus': 'accuracy',
            'evasion_bonus': 'evasion'
        }
        
        for item_attr, char_attr in bonuses.items():
            bonus = getattr(item, item_attr, 0)
            if bonus > 0:
                current_value = getattr(character, char_attr, 0)
                setattr(character, char_attr, current_value + bonus)
                
                # HP/MPì˜ ê²½ìš° í˜„ì¬ê°’ë„ ì¦ê°€
                if char_attr == 'max_hp':
                    character.current_hp = min(character.current_hp + bonus, character.max_hp)
                elif char_attr == 'max_mp':
                    character.current_mp = min(character.current_mp + bonus, character.max_mp)
    
    def _remove_equipment_bonuses(self, character: Character, item):
        """ì¥ë¹„ ë³´ë„ˆìŠ¤ ì œê±°"""
        bonuses = {
            'physical_attack_bonus': 'attack_power',
            'magic_attack_bonus': 'magic_power',
            'physical_defense_bonus': 'physical_defense', 
            'magic_defense_bonus': 'magic_defense',
            'hp_bonus': 'max_hp',
            'mp_bonus': 'max_mp',
            'speed_bonus': 'speed',
            'accuracy_bonus': 'accuracy',
            'evasion_bonus': 'evasion'
        }
        
        for item_attr, char_attr in bonuses.items():
            bonus = getattr(item, item_attr, 0)
            if bonus > 0:
                current_value = getattr(character, char_attr, 0)
                setattr(character, char_attr, max(0, current_value - bonus))
                
                # HP/MPì˜ ê²½ìš° í˜„ì¬ê°’ë„ ì¡°ì •
                if char_attr == 'max_hp':
                    character.current_hp = min(character.current_hp, character.max_hp)
                elif char_attr == 'max_mp':
                    character.current_mp = min(character.current_mp, character.max_mp)
    
    def get_equipment_recommendations(self, character: Character, available_items: List) -> List[Dict]:
        """ìºë¦­í„°ì—ê²Œ ì¶”ì²œ ì¥ë¹„ ëª©ë¡ ë°˜í™˜"""
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        recommendations = []
        
        try:
            from game.items import ItemDatabase
            item_db = ItemDatabase()
            
            # ê° ìŠ¬ë¡¯ë³„ ì¶”ì²œ ì•„ì´í…œ
            equipment_slots = ['weapon', 'armor', 'helmet', 'boots', 'gloves', 'shield', 'accessory']
            
            for slot in equipment_slots:
                best_items = []
                
                # í•´ë‹¹ ìŠ¬ë¡¯ ì•„ì´í…œë“¤ ì ìˆ˜ ê³„ì‚°
                for item_name in available_items:
                    item = item_db.get_item(item_name)
                    if item and hasattr(item, 'item_type') and item.item_type == 'equipment':
                        item_slot = getattr(item, 'equipment_slot', '').lower()
                        if item_slot == slot:
                            score = self._calculate_item_score(character, item, character_class)
                            best_items.append({
                                'item': item,
                                'score': score,
                                'slot': slot,
                                'reason': self._get_recommendation_reason(character, item, character_class)
                            })
                
                # ìƒìœ„ 3ê°œ ì¶”ì²œ
                best_items.sort(key=lambda x: x['score'], reverse=True)
                recommendations.extend(best_items[:3])
            
            return recommendations
            
        except ImportError:
            return []
    
    def _get_recommendation_reason(self, character: Character, item, character_class: str) -> str:
        """ì¶”ì²œ ì´ìœ  ìƒì„±"""
        reasons = []
        
        # ì§ì—… ì í•©ì„±
        if character_class in self.class_equipment_priority:
            item_slot = getattr(item, 'equipment_slot', '').lower()
            priority = self.class_equipment_priority[character_class].get(item_slot, 1.0)
            if priority > 1.0:
                reasons.append(f"{character_class}ì—ê²Œ ì¤‘ìš”í•œ ì¥ë¹„")
        
        # ìŠ¤íƒ¯ ë³´ë„ˆìŠ¤
        high_bonuses = []
        bonuses = {
            'physical_attack_bonus': 'ë¬¼ë¦¬ ê³µê²©ë ¥',
            'magic_attack_bonus': 'ë§ˆë²• ê³µê²©ë ¥',
            'physical_defense_bonus': 'ë¬¼ë¦¬ ë°©ì–´ë ¥', 
            'magic_defense_bonus': 'ë§ˆë²• ë°©ì–´ë ¥',
            'hp_bonus': 'HP',
            'mp_bonus': 'MP'
        }
        
        for attr, name in bonuses.items():
            bonus = getattr(item, attr, 0)
            if bonus >= 10:  # ë†’ì€ ë³´ë„ˆìŠ¤
                high_bonuses.append(f"{name} +{bonus}")
        
        if high_bonuses:
            reasons.append(f"ë†’ì€ ë³´ë„ˆìŠ¤: {', '.join(high_bonuses)}")
        
        # ê¸°ë³¸ ì´ìœ 
        if not reasons:
            reasons.append("ìŠ¤íƒ¯ í–¥ìƒì— ë„ì›€")
        
        return " | ".join(reasons)

# ì „ì—­ ì¥ë¹„ ê´€ë¦¬ì ì¸ìŠ¤í„´ìŠ¤
basic_equipment_manager = BasicEquipmentManager()

# AI ìš”ì²­ ì²˜ë¦¬ í•¨ìˆ˜ë“¤
def handle_ai_requests(pending_requests):
    """AI ìš”ì²­ ì²˜ë¦¬"""
    if not pending_requests:
        print("âŒ ì²˜ë¦¬í•  AI ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤.")
        return "defend", {}
    
    print("\nğŸ’¬ AI ìš”ì²­ ëª©ë¡:")
    for i, request in enumerate(pending_requests):
        elapsed = time.time() - request["timestamp"]
        print(f"{i+1}. {request['message']} ({elapsed:.1f}ì´ˆ ì „)")
    
    print(f"{len(pending_requests)+1}. ë¬´ì‹œí•˜ê³  ê³„ì†")
    
    try:
        choice = int(input("ì‘ë‹µí•  ìš”ì²­ ì„ íƒ: ")) - 1
        
        if choice == len(pending_requests):
            # ë¬´ì‹œ
            return "defend", {}
        elif 0 <= choice < len(pending_requests):
            request = pending_requests.pop(choice)
            return respond_to_ai_request(request)
        else:
            print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
            return "defend", {}
    except ValueError:
        print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        return "defend", {}

def respond_to_ai_request(request):
    """AI ìš”ì²­ì— ì‘ë‹µ"""
    request_type = request["type"]
    companion = request["companion"]
    
    print(f"\nğŸ’¬ {companion.character.name}ì˜ ìš”ì²­: {request['message']}")
    response = input("ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n): ").lower() == 'y'
    
    response_msg = companion.respond_to_player_action("help", response)
    print(f"ğŸ’­ {response_msg}")
    
    if response:
        if request["type"] == "REQUEST_COORDINATED_ATTACK":
            companion.coordinated_attack_ready = True
            return "prepare_coordination", {"partner": companion.character}
        elif request["type"] == "NEED_HEALING":
            return "use_item", {"target": companion.character, "item_type": "healing"}
        elif request["type"] == "NEED_MP_POTION":
            return "use_item", {"target": companion.character, "item_type": "mp_potion"}
    
    return "defend", {}
    
    def _show_party_status(self, party: List[Character]):
        """íŒŒí‹° ìƒíƒœ í‘œì‹œ"""
        print(f"\nğŸ“Š íŒŒí‹° ìƒíƒœ:")
        print("="*60)
        
        for char in party:
            if not char.is_alive:
                continue
            
            hp_bar = self._create_status_bar(char.current_hp, char.max_hp, 15)
            mp_bar = self._create_status_bar(char.current_mp, char.max_mp, 15)
            
            control_type = "ğŸ® í”Œë ˆì´ì–´" if char in self.player_controlled_characters else "ğŸ¤– AI"
            
            print(f"{char.name} ({control_type})")
            print(f"  HP: {hp_bar} {char.current_hp}/{char.max_hp}")
            print(f"  MP: {mp_bar} {char.current_mp}/{char.max_mp}")
            
            # AI ë™ë£Œì˜ ê²½ìš° ì¶”ê°€ ì •ë³´
            if char not in self.player_controlled_characters:
                ai_companion = next((ai for ai in self.ai_companions if ai.character == char), None)
                if ai_companion:
                    print(f"  ì‹ ë¢°ë„: {ai_companion.trust_level}/100")
                    print(f"  ì‚¬ê¸°: {ai_companion.morale}/100")
            print()
    
    def _create_status_bar(self, current: int, maximum: int, width: int) -> str:
        """ìƒíƒœ ë°” ìƒì„±"""
        if maximum <= 0:
            return "â–¡" * width
        
        filled = int((current / maximum) * width)
        empty = width - filled
        return "â– " * filled + "â–¡" * empty
    
    def _get_action_description(self, action_type: str, action_data: Dict) -> str:
        """í–‰ë™ ì„¤ëª… ìƒì„±"""
        descriptions = {
            "attack": "ì ì„ ê³µê²©í•©ë‹ˆë‹¤",
            "skill": "ìŠ¤í‚¬ì„ ì‚¬ìš©í•©ë‹ˆë‹¤",
            "defend": "ë°©ì–´ ìì„¸ë¥¼ ì·¨í•©ë‹ˆë‹¤",
            "heal": "ë™ë£Œë¥¼ ì¹˜ë£Œí•©ë‹ˆë‹¤",
            "use_item": "ì•„ì´í…œì„ ì‚¬ìš©í•©ë‹ˆë‹¤"
        }
        return descriptions.get(action_type, "í–‰ë™ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤")
    
    def handle_item_usage_by_ai(self, ai_companion: AICompanion, item_type: str) -> bool:
        """AIì˜ ì•„ì´í…œ ì‚¬ìš© ì²˜ë¦¬"""
        if not self.item_sharing_enabled:
            return False
        
        # íŒŒí‹° ê³µìš© ì•„ì´í…œì—ì„œ ì‚¬ìš©
        print(f"ğŸ¤– {ai_companion.character.name}ì´(ê°€) {item_type} ì•„ì´í…œì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤!")
        
        # í”Œë ˆì´ì–´ì—ê²Œ ì•Œë¦¼
        if random.random() < 0.3:  # 30% í™•ë¥ ë¡œ ì‚¬ê³¼
            print(f"ğŸ’¬ {ai_companion.character.name}: ì•„ì´í…œì„ ì¨ë²„ë ¸ì–´, ë¯¸ì•ˆ!")
        
        return True
    
    def get_ai_mode_status(self) -> str:
        """í´ë˜ì‹ ëª¨ë“œ ìƒíƒœ ì •ë³´"""
        status_lines = [
            f"ğŸ® í´ë˜ì‹ ê²Œì„ëª¨ë“œ: {self.current_mode.value}",
            f"ğŸ‘¤ í”Œë ˆì´ì–´ ì¡°ì‘: {len(self.player_controlled_characters)}ëª…",
            f"ğŸ¤– AI ì¡°ì‘: {len(self.ai_companions)}ëª…",
            f"ğŸ’¬ ëŒ€ê¸° ì¤‘ì¸ ìš”ì²­: {len(self.pending_ai_requests)}ê°œ"
        ]
        
        if self.ai_companions:
            status_lines.append("\nğŸ¤– AI ë™ë£Œ ìƒíƒœ:")
            for ai in self.ai_companions:
                status_lines.append(f"   {ai.character.name}: ì‹ ë¢°ë„ {ai.trust_level}/100, ì‚¬ê¸° {ai.morale}/100")
        
        return "\n".join(status_lines)
    
    def _execute_player_action(self, character: Character, action: str, party: List[Character], enemies: List[Character]):
        """í”Œë ˆì´ì–´ í–‰ë™ ì‹¤í–‰ - ì „ì²´ ì‹œìŠ¤í…œ í†µí•©"""
        if action == "ğŸ¤ í˜‘ë™ ê³µê²©":
            return self._execute_coordination_attack(character, party, enemies)
        elif action == "ğŸ’¬ AI ìš”ì²­ í™•ì¸":
            return self._handle_ai_requests()
        elif action == "âš”ï¸ ê³µê²©":
            return "attack", {}
        elif action == "âœ¨ ìŠ¤í‚¬ ì‚¬ìš©":
            # ì‹¤ì œ ìŠ¤í‚¬ ì‹œìŠ¤í…œ ì‚¬ìš©
            return self._select_and_use_skill(character, party, enemies)
        elif action == "ğŸ§ª ì•„ì´í…œ ì‚¬ìš©":
            # ì‹¤ì œ ì•„ì´í…œ ì‹œìŠ¤í…œ ì‚¬ìš©
            return self._select_and_use_item(character, party)
        elif action == "ğŸ›¡ï¸ ë°©ì–´":
            return "defend", {}
        elif action == "ğŸ’ ì¥ë¹„ ê´€ë¦¬":
            # ì¥ë¹„ ê´€ë¦¬ ì‹œìŠ¤í…œ
            return self._manage_equipment(character, party)
        elif action == "ğŸ³ ìš”ë¦¬ ì‚¬ìš©":
            # ìš”ë¦¬ ì‹œìŠ¤í…œ
            return self._use_cooking_system(character, party)
        elif action == "ğŸŒŸ í•„ë“œìŠ¤í‚¬ ì‚¬ìš©":
            # í•„ë“œìŠ¤í‚¬ ì‹œìŠ¤í…œ
            return self._use_field_skill(character, party, enemies)
        elif action == "ğŸ’¾ ì „íˆ¬ ì¤‘ ì €ì¥":
            # ì €ì¥ ì‹œìŠ¤í…œ
            return self._save_game_during_battle(character, party)
        elif action == "ğŸ“Š ìƒíƒœ í™•ì¸":
            self._show_party_status(party)
            return self._process_player_turn(character, party, enemies)
        else:
            return "defend", {}
    
    def _select_and_use_skill(self, character: Character, party: List[Character], enemies: List[Character]):
        """ìŠ¤í‚¬ ì„ íƒ ë° ì‚¬ìš© - ì‹¤ì œ ìŠ¤í‚¬ ì‹œìŠ¤í…œ í†µí•©"""
        try:
            from game.new_skill_system import get_class_skills
            
            # ìºë¦­í„°ì˜ ì§ì—…ë³„ ìŠ¤í‚¬ ê°€ì ¸ì˜¤ê¸°
            character_class = getattr(character, 'character_class', 'ì „ì‚¬')
            available_skills = get_class_skills(character_class)
            
            if not available_skills:
                print(f"âŒ {character.name}ì´(ê°€) ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤í‚¬ì´ ì—†ìŠµë‹ˆë‹¤.")
                return "defend", {}
            
            # ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¤í‚¬ë§Œ í•„í„°ë§ (MP í™•ì¸)
            usable_skills = []
            for skill in available_skills:
                mp_cost = getattr(skill, 'mp_cost', 0)
                if character.current_mp >= mp_cost:
                    usable_skills.append(skill)
            
            if not usable_skills:
                print(f"âŒ MPê°€ ë¶€ì¡±í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤í‚¬ì´ ì—†ìŠµë‹ˆë‹¤. (í˜„ì¬ MP: {character.current_mp})")
                return "defend", {}
            
            print(f"\nâœ¨ {character.name}ì˜ ìŠ¤í‚¬ ì„ íƒ (MP: {character.current_mp}/{character.max_mp})")
            print("-" * 50)
            
            for i, skill in enumerate(usable_skills, 1):
                mp_cost = getattr(skill, 'mp_cost', 0)
                skill_type = getattr(skill, 'type', 'UNKNOWN')
                description = getattr(skill, 'description', 'ì„¤ëª… ì—†ìŒ')
                print(f"{i}. {skill.name} (MP: {mp_cost}) [{skill_type}]")
                print(f"   {description}")
            
            print(f"{len(usable_skills) + 1}. ì·¨ì†Œ")
            
            try:
                choice = int(input("ìŠ¤í‚¬ ì„ íƒ: ")) - 1
                if choice == len(usable_skills):
                    return self._process_player_turn(character, party, enemies)
                elif 0 <= choice < len(usable_skills):
                    selected_skill = usable_skills[choice]
                    
                    # ëŒ€ìƒ ì„ íƒ
                    target = self._select_skill_target(selected_skill, character, party, enemies)
                    if target:
                        mp_cost = getattr(selected_skill, 'mp_cost', 0)
                        character.current_mp = max(0, character.current_mp - mp_cost)
                        print(f"âœ¨ {character.name}ì´(ê°€) {selected_skill.name}ì„(ë¥¼) ì‚¬ìš©í•©ë‹ˆë‹¤!")
                        return "skill", {"skill": selected_skill, "target": target}
                    else:
                        return self._process_player_turn(character, party, enemies)
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return self._select_and_use_skill(character, party, enemies)
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return self._select_and_use_skill(character, party, enemies)
                
        except ImportError:
            print("âŒ ìŠ¤í‚¬ ì‹œìŠ¤í…œì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
    
    def _select_skill_target(self, skill, caster: Character, party: List[Character], enemies: List[Character]):
        """ìŠ¤í‚¬ ëŒ€ìƒ ì„ íƒ"""
        skill_type = getattr(skill, 'type', 'UNKNOWN')
        target_type = getattr(skill, 'target_type', 'enemy')
        
        # ëŒ€ìƒ íƒ€ì…ì— ë”°ë¥¸ ì„ íƒì§€ êµ¬ì„±
        if target_type == 'enemy' or skill_type in ['HP_ATTACK', 'BRV_ATTACK', 'BRV_HP_ATTACK']:
            targets = [e for e in enemies if e.is_alive]
            target_name = "ì "
        elif target_type == 'ally' or skill_type in ['HEAL', 'BUFF']:
            targets = [p for p in party if p.is_alive]
            target_name = "ì•„êµ°"
        elif target_type == 'self':
            return caster
        else:
            # ê¸°ë³¸ê°’: ì  ëŒ€ìƒ
            targets = [e for e in enemies if e.is_alive]
            target_name = "ì "
        
        if not targets:
            print(f"âŒ ëŒ€ìƒìœ¼ë¡œ í•  ìˆ˜ ìˆëŠ” {target_name}ì´ ì—†ìŠµë‹ˆë‹¤.")
            return None
        
        print(f"\nğŸ¯ {target_name} ì„ íƒ:")
        for i, target in enumerate(targets, 1):
            hp_ratio = target.current_hp / target.max_hp if target.max_hp > 0 else 0
            status = "ê±´ê°•" if hp_ratio > 0.7 else "ë¶€ìƒ" if hp_ratio > 0.3 else "ìœ„í—˜"
            print(f"{i}. {target.name} (HP: {target.current_hp}/{target.max_hp} - {status})")
        
        print(f"{len(targets) + 1}. ì·¨ì†Œ")
        
        try:
            choice = int(input("ëŒ€ìƒ ì„ íƒ: ")) - 1
            if choice == len(targets):
                return None
            elif 0 <= choice < len(targets):
                return targets[choice]
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return self._select_skill_target(skill, caster, party, enemies)
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return self._select_skill_target(skill, caster, party, enemies)
    
    def _select_and_use_item(self, character: Character, party: List[Character]):
        """ì•„ì´í…œ ì„ íƒ ë° ì‚¬ìš© - ì‹¤ì œ ì•„ì´í…œ ì‹œìŠ¤í…œ í†µí•©"""
        try:
            from game.items import ItemDatabase, ItemType
            item_db = ItemDatabase()
            
            # ìºë¦­í„° ì¸ë²¤í† ë¦¬ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´í…œ í™•ì¸
            if not hasattr(character, 'inventory') or not character.inventory:
                print(f"âŒ {character.name}ì˜ ì¸ë²¤í† ë¦¬ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.")
                return "defend", {}
            
            # ì†Œëª¨í’ˆë§Œ í•„í„°ë§
            consumable_items = []
            for item_name, quantity in character.inventory.get_items_list():
                if quantity > 0:
                    item = item_db.get_item(item_name)
                    if item and item.item_type == ItemType.CONSUMABLE:
                        consumable_items.append((item, quantity))
            
            if not consumable_items:
                print(f"âŒ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì†Œëª¨í’ˆì´ ì—†ìŠµë‹ˆë‹¤.")
                return "defend", {}
            
            print(f"\nğŸ§ª {character.name}ì˜ ì•„ì´í…œ ì‚¬ìš©")
            print("-" * 50)
            
            for i, (item, quantity) in enumerate(consumable_items, 1):
                effect_desc = self._get_item_effect_description(item)
                print(f"{i}. {item.name} x{quantity}")
                print(f"   íš¨ê³¼: {effect_desc}")
            
            print(f"{len(consumable_items) + 1}. ì·¨ì†Œ")
            
            try:
                choice = int(input("ì•„ì´í…œ ì„ íƒ: ")) - 1
                if choice == len(consumable_items):
                    return self._process_player_turn(character, party, [])
                elif 0 <= choice < len(consumable_items):
                    selected_item, quantity = consumable_items[choice]
                    
                    # ëŒ€ìƒ ì„ íƒ
                    target = self._select_item_target(selected_item, character, party)
                    if target:
                        # ì•„ì´í…œ ì‚¬ìš©
                        character.inventory.remove_item(selected_item.name, 1)
                        print(f"ğŸ§ª {character.name}ì´(ê°€) {selected_item.name}ì„(ë¥¼) ì‚¬ìš©í•©ë‹ˆë‹¤!")
                        return "use_item", {"item": selected_item, "target": target}
                    else:
                        return self._process_player_turn(character, party, [])
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return self._select_and_use_item(character, party)
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return self._select_and_use_item(character, party)
                
        except ImportError:
            print("âŒ ì•„ì´í…œ ì‹œìŠ¤í…œì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
    
    def _get_item_effect_description(self, item) -> str:
        """ì•„ì´í…œ íš¨ê³¼ ì„¤ëª… ìƒì„±"""
        if not hasattr(item, 'effects') or not item.effects:
            return "íš¨ê³¼ ì—†ìŒ"
        
        descriptions = []
        for effect_type, value in item.effects.items():
            if effect_type == "heal":
                descriptions.append(f"HP {value} íšŒë³µ")
            elif effect_type == "restore_mp":
                descriptions.append(f"MP {value} íšŒë³µ")
            elif effect_type == "cure_poison":
                descriptions.append("ë… ì¹˜ë£Œ")
            elif effect_type == "cure_all":
                descriptions.append("ëª¨ë“  ìƒíƒœì´ìƒ ì¹˜ë£Œ")
            elif effect_type == "boost_attack":
                descriptions.append(f"ê³µê²©ë ¥ {value}% ì¦ê°€")
            elif effect_type == "boost_defense":
                descriptions.append(f"ë°©ì–´ë ¥ {value}% ì¦ê°€")
            else:
                descriptions.append(f"{effect_type}: {value}")
        
        return ", ".join(descriptions) if descriptions else "íš¨ê³¼ ì—†ìŒ"
    
    def _select_item_target(self, item, user: Character, party: List[Character]):
        """ì•„ì´í…œ ì‚¬ìš© ëŒ€ìƒ ì„ íƒ"""
        # ì•„ì´í…œ íš¨ê³¼ì— ë”°ë¼ ëŒ€ìƒ ê²°ì •
        if not hasattr(item, 'effects') or not item.effects:
            return user  # ê¸°ë³¸ê°’: ìì‹ 
        
        # íšŒë³µ/ì¹˜ë£Œ ì•„ì´í…œì€ ì•„êµ° ëŒ€ìƒ
        healing_effects = ['heal', 'restore_mp', 'cure_poison', 'cure_all']
        is_healing_item = any(effect in item.effects for effect in healing_effects)
        
        if is_healing_item:
            targets = [p for p in party if p.is_alive]
            target_name = "ì•„êµ°"
        else:
            # ê³µê²© ì•„ì´í…œì´ë‚˜ ê¸°íƒ€ëŠ” ìì‹ ì—ê²Œ ì‚¬ìš©
            return user
        
        if not targets:
            print("âŒ ëŒ€ìƒìœ¼ë¡œ í•  ìˆ˜ ìˆëŠ” ì•„êµ°ì´ ì—†ìŠµë‹ˆë‹¤.")
            return None
        
        print(f"\nğŸ¯ ëŒ€ìƒ ì„ íƒ:")
        for i, target in enumerate(targets, 1):
            hp_ratio = target.current_hp / target.max_hp if target.max_hp > 0 else 0
            mp_ratio = target.current_mp / target.max_mp if target.max_mp > 0 else 0
            status = "ê±´ê°•" if hp_ratio > 0.7 else "ë¶€ìƒ" if hp_ratio > 0.3 else "ìœ„í—˜"
            print(f"{i}. {target.name} (HP: {hp_ratio*100:.0f}%, MP: {mp_ratio*100:.0f}% - {status})")
        
        print(f"{len(targets) + 1}. ì·¨ì†Œ")
        
        try:
            choice = int(input("ëŒ€ìƒ ì„ íƒ: ")) - 1
            if choice == len(targets):
                return None
            elif 0 <= choice < len(targets):
                return targets[choice]
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return self._select_item_target(item, user, party)
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return self._select_item_target(item, user, party)
    
    # ==================== ì „ì²´ ì‹œìŠ¤í…œ í†µí•© ë©”ì„œë“œë“¤ ====================
    
    def _manage_equipment(self, character: Character, party: List[Character]):
        """ì¥ë¹„ ê´€ë¦¬ ì‹œìŠ¤í…œ"""
        try:
            from game.equipment_system import get_equipment_manager
            equipment_manager = get_equipment_manager()
            
            print(f"\nğŸ’ {character.name}ì˜ ì¥ë¹„ ê´€ë¦¬")
            print("-" * 50)
            
            # í˜„ì¬ ì¥ì°©í•œ ì¥ë¹„ í‘œì‹œ
            if hasattr(character, 'equipped_items'):
                print("í˜„ì¬ ì¥ì°© ì¥ë¹„:")
                for slot, item in character.equipped_items.items():
                    if item:
                        print(f"  {slot}: {item.name}")
                    else:
                        print(f"  {slot}: (ì—†ìŒ)")
            
            # ì¥ë¹„ ê´€ë¦¬ ì˜µì…˜
            options = [
                "ì¥ë¹„ ì°©ìš©/í•´ì œ",
                "ì¥ë¹„ ê°•í™”",
                "ì¥ë¹„ ìƒíƒœ í™•ì¸",
                "AIì—ê²Œ ì¥ë¹„ ì¶”ì²œ ìš”ì²­"
            ]
            
            print("\nì¥ë¹„ ê´€ë¦¬ ì˜µì…˜:")
            for i, option in enumerate(options, 1):
                print(f"{i}. {option}")
            print(f"{len(options) + 1}. ì·¨ì†Œ")
            
            try:
                choice = int(input("ì„ íƒ: ")) - 1
                if choice == len(options):
                    return self._process_player_turn(character, party, [])
                elif 0 <= choice < len(options):
                    if choice == 0:  # ì¥ë¹„ ì°©ìš©/í•´ì œ
                        return self._equip_unequip_items(character)
                    elif choice == 1:  # ì¥ë¹„ ê°•í™”
                        return self._enhance_equipment(character)
                    elif choice == 2:  # ì¥ë¹„ ìƒíƒœ í™•ì¸
                        return self._check_equipment_status(character)
                    elif choice == 3:  # AI ì¥ë¹„ ì¶”ì²œ
                        return self._get_ai_equipment_recommendation(character)
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return self._manage_equipment(character, party)
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return self._manage_equipment(character, party)
                
        except ImportError:
            print("âŒ ì¥ë¹„ ì‹œìŠ¤í…œì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
    
    def _use_cooking_system(self, character: Character, party: List[Character]):
        """ìš”ë¦¬ ì‹œìŠ¤í…œ ì‚¬ìš©"""
        try:
            from game.cooking_system import get_cooking_manager
            cooking_manager = get_cooking_manager()
            
            print(f"\nğŸ³ {character.name}ì˜ ìš”ë¦¬ ì‹œìŠ¤í…œ")
            print("-" * 50)
            
            # ìš”ë¦¬ ê°€ëŠ¥í•œ ì¬ë£Œ í™•ì¸
            available_recipes = []
            if hasattr(character, 'inventory'):
                available_recipes = cooking_manager.get_available_recipes(character.inventory)
            
            if not available_recipes:
                print("âŒ ìš”ë¦¬í•  ìˆ˜ ìˆëŠ” ì¬ë£Œê°€ ì—†ìŠµë‹ˆë‹¤.")
                return self._process_player_turn(character, party, [])
            
            print("ìš”ë¦¬ ê°€ëŠ¥í•œ ë ˆì‹œí”¼:")
            for i, recipe in enumerate(available_recipes, 1):
                print(f"{i}. {recipe.name} - {recipe.description}")
                print(f"   íš¨ê³¼: {recipe.effects}")
                print(f"   ì¬ë£Œ: {', '.join(recipe.ingredients)}")
            
            print(f"{len(available_recipes) + 1}. ì·¨ì†Œ")
            
            try:
                choice = int(input("ìš”ë¦¬ ì„ íƒ: ")) - 1
                if choice == len(available_recipes):
                    return self._process_player_turn(character, party, [])
                elif 0 <= choice < len(available_recipes):
                    selected_recipe = available_recipes[choice]
                    
                    # ìš”ë¦¬ ì‹¤í–‰
                    result = cooking_manager.cook_recipe(character, selected_recipe)
                    if result:
                        print(f"ğŸ³ {character.name}ì´(ê°€) {selected_recipe.name}ì„(ë¥¼) ìš”ë¦¬í–ˆìŠµë‹ˆë‹¤!")
                        return "cooking", {"recipe": selected_recipe.name, "result": result}
                    else:
                        print("âŒ ìš”ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
                        return self._process_player_turn(character, party, [])
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return self._use_cooking_system(character, party)
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return self._use_cooking_system(character, party)
                
        except ImportError:
            print("âŒ ìš”ë¦¬ ì‹œìŠ¤í…œì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
    
    def _use_field_skill(self, character: Character, party: List[Character], enemies: List[Character]):
        """í•„ë“œìŠ¤í‚¬ ì‹œìŠ¤í…œ ì‚¬ìš©"""
        try:
            from game.field_skill_system import get_field_skill_manager
            field_skill_manager = get_field_skill_manager()
            
            print(f"\nğŸŒŸ {character.name}ì˜ í•„ë“œìŠ¤í‚¬")
            print("-" * 50)
            
            # ì‚¬ìš© ê°€ëŠ¥í•œ í•„ë“œìŠ¤í‚¬ í™•ì¸
            character_class = getattr(character, 'character_class', 'ì „ì‚¬')
            available_skills = field_skill_manager.get_available_field_skills(character_class)
            
            if not available_skills:
                print("âŒ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í•„ë“œìŠ¤í‚¬ì´ ì—†ìŠµë‹ˆë‹¤.")
                return self._process_player_turn(character, party, enemies)
            
            print("ì‚¬ìš© ê°€ëŠ¥í•œ í•„ë“œìŠ¤í‚¬:")
            for i, skill in enumerate(available_skills, 1):
                cooldown_status = "ì‚¬ìš©ê°€ëŠ¥" if skill.is_ready() else f"ì¬ì‚¬ìš© ëŒ€ê¸° {skill.cooldown_remaining}í„´"
                print(f"{i}. {skill.name} - {skill.description} ({cooldown_status})")
                print(f"   íš¨ê³¼: {skill.field_effect}")
            
            print(f"{len(available_skills) + 1}. ì·¨ì†Œ")
            
            try:
                choice = int(input("í•„ë“œìŠ¤í‚¬ ì„ íƒ: ")) - 1
                if choice == len(available_skills):
                    return self._process_player_turn(character, party, enemies)
                elif 0 <= choice < len(available_skills):
                    selected_skill = available_skills[choice]
                    
                    if selected_skill.is_ready():
                        # í•„ë“œìŠ¤í‚¬ ì‚¬ìš©
                        result = field_skill_manager.use_field_skill(character, selected_skill, party, enemies)
                        print(f"ğŸŒŸ {character.name}ì´(ê°€) {selected_skill.name}ì„(ë¥¼) ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤!")
                        return "field_skill", {"skill": selected_skill.name, "result": result}
                    else:
                        print(f"âŒ {selected_skill.name}ì€(ëŠ”) ì•„ì§ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
                        return self._process_player_turn(character, party, enemies)
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return self._use_field_skill(character, party, enemies)
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return self._use_field_skill(character, party, enemies)
                
        except ImportError:
            print("âŒ í•„ë“œìŠ¤í‚¬ ì‹œìŠ¤í…œì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
    
    def _save_game_during_battle(self, character: Character, party: List[Character]):
        """ì „íˆ¬ ì¤‘ ì €ì¥"""
        try:
            from game.save_system import get_save_manager
            save_manager = get_save_manager()
            
            print(f"\nğŸ’¾ ì „íˆ¬ ì¤‘ ì €ì¥")
            print("-" * 50)
            print("âš ï¸ ì „íˆ¬ ì¤‘ ì €ì¥ì€ íŠ¹ë³„í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš©í•˜ì„¸ìš”.")
            print("ğŸ“ í˜„ì¬ ì „íˆ¬ ìƒí™©ê³¼ íŒŒí‹° ìƒíƒœê°€ ëª¨ë‘ ì €ì¥ë©ë‹ˆë‹¤.")
            
            confirm = input("ì •ë§ë¡œ ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n): ").lower()
            if confirm == 'y':
                # ì „íˆ¬ ìƒíƒœ í¬í•¨ ì €ì¥
                save_data = {
                    'party': party,
                    'battle_state': 'in_combat',
                    'current_character': character.name,
                    'timestamp': time.time()
                }
                
                result = save_manager.save_battle_state(save_data)
                if result:
                    print("âœ… ì „íˆ¬ ìƒíƒœê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!")
                    return "save_complete", {"save_result": result}
                else:
                    print("âŒ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
            else:
                print("âŒ ì €ì¥ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.")
            
            return self._process_player_turn(character, party, [])
                
        except ImportError:
            print("âŒ ì €ì¥ ì‹œìŠ¤í…œì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            return "defend", {}
    
    def _equip_unequip_items(self, character: Character):
        """ì¥ë¹„ ì°©ìš©/í•´ì œ - ëŒ€í­ ê°œì„ ëœ ì‹œìŠ¤í…œ"""
        try:
            from game.items import ItemDatabase, ItemType
            item_db = ItemDatabase()
            
            print(f"\nğŸ’ {character.name}ì˜ ì¥ë¹„ ê´€ë¦¬")
            print("=" * 60)
            
            # í˜„ì¬ ì¥ì°© ì¥ë¹„ í‘œì‹œ
            equipped_items = getattr(character, 'equipped_items', {})
            print("ğŸ“‹ í˜„ì¬ ì¥ì°© ì¤‘ì¸ ì¥ë¹„:")
            
            equipment_slots = ["ë¬´ê¸°", "ë°©íŒ¨", "ë¨¸ë¦¬", "ëª¸í†µ", "ë‹¤ë¦¬", "ë°œ", "ì¥ê°‘", "ëª©ê±¸ì´", "ë°˜ì§€"]
            for slot in equipment_slots:
                item = equipped_items.get(slot)
                if item:
                    durability = getattr(item, 'durability', 100)
                    durability_status = "ğŸŸ¢" if durability > 70 else "ğŸŸ¡" if durability > 30 else "ğŸ”´"
                    enhancement = getattr(item, 'enhancement_level', 0)
                    enhancement_text = f" +{enhancement}" if enhancement > 0 else ""
                    print(f"  {slot}: {item.name}{enhancement_text} {durability_status}({durability}%)")
                else:
                    print(f"  {slot}: (ì—†ìŒ)")
            
            # ì¸ë²¤í† ë¦¬ì˜ ì¥ë¹„ ì•„ì´í…œ í‘œì‹œ
            print(f"\nğŸ’ {character.name}ì˜ ì¥ë¹„ ì¸ë²¤í† ë¦¬:")
            if hasattr(character, 'inventory') and character.inventory:
                equipment_in_inventory = []
                for item_name, quantity in character.inventory.get_items_list():
                    item = item_db.get_item(item_name)
                    # ì¥ë¹„ íƒ€ì… í™•ì¸ (WEAPON, ARMOR, ACCESSORY)
                    if item and item.item_type in [ItemType.WEAPON, ItemType.ARMOR, ItemType.ACCESSORY]:
                        equipment_in_inventory.append((item, quantity))
                
                if equipment_in_inventory:
                    for i, (item, quantity) in enumerate(equipment_in_inventory, 1):
                        durability = getattr(item, 'durability', 100)
                        enhancement = getattr(item, 'enhancement_level', 0)
                        enhancement_text = f" +{enhancement}" if enhancement > 0 else ""
                        print(f"  {i}. {item.name}{enhancement_text} x{quantity} (ë‚´êµ¬ë„: {durability}%)")
                        print(f"     íš¨ê³¼: {self._get_equipment_stats_description(item)}")
                else:
                    print("  (ì¥ë¹„ ì•„ì´í…œ ì—†ìŒ)")
            else:
                print("  (ì¸ë²¤í† ë¦¬ ì—†ìŒ)")
            
            # ì¥ë¹„ ê´€ë¦¬ ì˜µì…˜
            print(f"\nâš™ï¸ ì¥ë¹„ ê´€ë¦¬ ì˜µì…˜:")
            print("1. ì¥ë¹„ ì°©ìš©")
            print("2. ì¥ë¹„ í•´ì œ")
            print("3. ì¥ë¹„ ìƒì„¸ ì •ë³´ í™•ì¸")
            print("4. ì¥ë¹„ ìˆ˜ë¦¬")
            print("5. ì·¨ì†Œ")
            
            try:
                choice = int(input("ì„ íƒ: "))
                if choice == 1:
                    return self._equip_item_advanced(character, equipment_in_inventory)
                elif choice == 2:
                    return self._unequip_item_advanced(character, equipped_items)
                elif choice == 3:
                    return self._show_equipment_details(character)
                elif choice == 4:
                    return self._repair_equipment(character)
                elif choice == 5:
                    return self._process_player_turn(character, [], [])
                else:
                    print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                    return self._equip_unequip_items(character)
            except ValueError:
                print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                return self._equip_unequip_items(character)
                
        except ImportError:
            print("âŒ ì•„ì´í…œ ì‹œìŠ¤í…œì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            return "equipment_manage", {"action": "basic_equip"}
    
    def _get_equipment_stats_description(self, item) -> str:
        """ì¥ë¹„ ìŠ¤íƒ¯ íš¨ê³¼ ì„¤ëª…"""
        effects = []
        if hasattr(item, 'physical_attack_bonus') and item.physical_attack_bonus > 0:
            effects.append(f"ë¬¼ê³µ +{item.physical_attack_bonus}")
        if hasattr(item, 'magic_attack_bonus') and item.magic_attack_bonus > 0:
            effects.append(f"ë§ˆê³µ +{item.magic_attack_bonus}")
        if hasattr(item, 'physical_defense_bonus') and item.physical_defense_bonus > 0:
            effects.append(f"ë¬¼ë°© +{item.physical_defense_bonus}")
        if hasattr(item, 'magic_defense_bonus') and item.magic_defense_bonus > 0:
            effects.append(f"ë§ˆë°© +{item.magic_defense_bonus}")
        if hasattr(item, 'speed_bonus') and item.speed_bonus > 0:
            effects.append(f"ì†ë„ +{item.speed_bonus}")
        if hasattr(item, 'hp_bonus') and item.hp_bonus > 0:
            effects.append(f"HP +{item.hp_bonus}")
        if hasattr(item, 'mp_bonus') and item.mp_bonus > 0:
            effects.append(f"MP +{item.mp_bonus}")
        
        return ", ".join(effects) if effects else "íŠ¹ë³„í•œ íš¨ê³¼ ì—†ìŒ"
    
    def _equip_item_advanced(self, character: Character, available_equipment: List):
        """ê³ ê¸‰ ì¥ë¹„ ì°©ìš© ì‹œìŠ¤í…œ"""
        if not available_equipment:
            print("âŒ ì°©ìš©í•  ìˆ˜ ìˆëŠ” ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤.")
            return self._equip_unequip_items(character)
        
        print("\nâš”ï¸ ì°©ìš©í•  ì¥ë¹„ ì„ íƒ:")
        for i, (item, quantity) in enumerate(available_equipment, 1):
            slot = getattr(item, 'equipment_slot', 'ì•Œ ìˆ˜ ì—†ìŒ')
            print(f"{i}. {item.name} ({slot} ìŠ¬ë¡¯)")
            print(f"   íš¨ê³¼: {self._get_equipment_stats_description(item)}")
        
        try:
            choice = int(input("ì¥ë¹„ ì„ íƒ (0: ì·¨ì†Œ): ")) - 1
            if choice == -1:
                return self._equip_unequip_items(character)
            elif 0 <= choice < len(available_equipment):
                selected_item, _ = available_equipment[choice]
                
                # ì¥ë¹„ ì°©ìš© ì²˜ë¦¬
                success = self._perform_equipment_change(character, selected_item, "equip")
                if success:
                    print(f"âœ… {selected_item.name}ì„(ë¥¼) ì°©ìš©í–ˆìŠµë‹ˆë‹¤!")
                    # ì„±ê²©ì— ë”°ë¥¸ ëŒ€í™”
                    personality = getattr(character, 'personality', CharacterPersonality.SERIOUS)
                    gender = getattr(character, 'gender', CharacterGender.MALE)
                    dialogue = CharacterTraits.get_dialogue(personality, "praise")
                    print(f"ğŸ’¬ {character.name}: \"{dialogue}\"")
                else:
                    print(f"âŒ {selected_item.name} ì°©ìš©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
                
                return "equipment_change", {"action": "equip", "item": selected_item.name}
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return self._equip_item_advanced(character, available_equipment)
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return self._equip_item_advanced(character, available_equipment)
    
    def _unequip_item_advanced(self, character: Character, equipped_items: Dict):
        """ê³ ê¸‰ ì¥ë¹„ í•´ì œ ì‹œìŠ¤í…œ"""
        equipped_list = [(slot, item) for slot, item in equipped_items.items() if item is not None]
        
        if not equipped_list:
            print("âŒ í•´ì œí•  ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤.")
            return self._equip_unequip_items(character)
        
        print("\nğŸ”“ í•´ì œí•  ì¥ë¹„ ì„ íƒ:")
        for i, (slot, item) in enumerate(equipped_list, 1):
            durability = getattr(item, 'durability', 100)
            print(f"{i}. {slot}: {item.name} (ë‚´êµ¬ë„: {durability}%)")
        
        try:
            choice = int(input("ì¥ë¹„ ì„ íƒ (0: ì·¨ì†Œ): ")) - 1
            if choice == -1:
                return self._equip_unequip_items(character)
            elif 0 <= choice < len(equipped_list):
                slot, selected_item = equipped_list[choice]
                
                # ì¥ë¹„ í•´ì œ ì²˜ë¦¬
                success = self._perform_equipment_change(character, selected_item, "unequip")
                if success:
                    print(f"âœ… {selected_item.name}ì„(ë¥¼) í•´ì œí–ˆìŠµë‹ˆë‹¤!")
                else:
                    print(f"âŒ {selected_item.name} í•´ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
                
                return "equipment_change", {"action": "unequip", "item": selected_item.name}
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return self._unequip_item_advanced(character, equipped_items)
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return self._unequip_item_advanced(character, equipped_items)
    
    def _perform_equipment_change(self, character: Character, item, action: str) -> bool:
        """ì‹¤ì œ ì¥ë¹„ ë³€ê²½ ìˆ˜í–‰"""
        try:
            if action == "equip":
                # ì¥ë¹„ ì°©ìš© ë¡œì§ (ì‹¤ì œ ê²Œì„ ì‹œìŠ¤í…œê³¼ ì—°ë™)
                slot = getattr(item, 'equipment_slot', None)
                if slot:
                    if not hasattr(character, 'equipped_items'):
                        character.equipped_items = {}
                    character.equipped_items[slot] = item
                    # ìŠ¤íƒ¯ ë³´ë„ˆìŠ¤ ì ìš©
                    self._apply_equipment_bonuses(character, item, True)
                    return True
            elif action == "unequip":
                # ì¥ë¹„ í•´ì œ ë¡œì§
                if hasattr(character, 'equipped_items'):
                    for slot, equipped_item in character.equipped_items.items():
                        if equipped_item == item:
                            character.equipped_items[slot] = None
                            # ìŠ¤íƒ¯ ë³´ë„ˆìŠ¤ ì œê±°
                            self._apply_equipment_bonuses(character, item, False)
                            return True
            return False
        except Exception as e:
            print(f"âŒ ì¥ë¹„ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
            return False
    
    def _apply_equipment_bonuses(self, character: Character, item, is_equipping: bool):
        """ì¥ë¹„ ë³´ë„ˆìŠ¤ ì ìš©/ì œê±°"""
        multiplier = 1 if is_equipping else -1
        
        if hasattr(item, 'physical_attack_bonus'):
            character.physical_attack += item.physical_attack_bonus * multiplier
        if hasattr(item, 'magic_attack_bonus'):
            character.magic_attack += item.magic_attack_bonus * multiplier
        if hasattr(item, 'physical_defense_bonus'):
            character.physical_defense += item.physical_defense_bonus * multiplier
        if hasattr(item, 'magic_defense_bonus'):
            character.magic_defense += item.magic_defense_bonus * multiplier
        if hasattr(item, 'speed_bonus'):
            character.speed += item.speed_bonus * multiplier
        if hasattr(item, 'hp_bonus'):
            character.max_hp += item.hp_bonus * multiplier
            if is_equipping:
                character.current_hp += item.hp_bonus
        if hasattr(item, 'mp_bonus'):
            character.max_mp += item.mp_bonus * multiplier
            if is_equipping:
                character.current_mp += item.mp_bonus
    
    def _show_equipment_details(self, character: Character):
        """ì¥ë¹„ ìƒì„¸ ì •ë³´ í‘œì‹œ"""
        print(f"\nğŸ“Š {character.name}ì˜ ì¥ë¹„ ìƒì„¸ ì •ë³´")
        print("=" * 60)
        
        equipped_items = getattr(character, 'equipped_items', {})
        total_bonuses = {
            "physical_attack": 0, "magic_attack": 0, "physical_defense": 0,
            "magic_defense": 0, "speed": 0, "hp": 0, "mp": 0
        }
        
        for slot, item in equipped_items.items():
            if item:
                print(f"\nğŸ”¸ {slot}: {item.name}")
                durability = getattr(item, 'durability', 100)
                enhancement = getattr(item, 'enhancement_level', 0)
                
                print(f"   ë‚´êµ¬ë„: {durability}% {'ï¿½' if durability > 70 else 'ğŸŸ¡' if durability > 30 else 'ğŸ”´'}")
                if enhancement > 0:
                    print(f"   ê°•í™” ìˆ˜ì¹˜: +{enhancement}")
                
                # ê°œë³„ ë³´ë„ˆìŠ¤ í‘œì‹œ
                bonuses = []
                for stat in total_bonuses.keys():
                    bonus_attr = f"{stat}_bonus"
                    if hasattr(item, bonus_attr):
                        bonus_value = getattr(item, bonus_attr)
                        if bonus_value > 0:
                            bonuses.append(f"{stat.replace('_', ' ').title()}: +{bonus_value}")
                            total_bonuses[stat] += bonus_value
                
                if bonuses:
                    print(f"   ë³´ë„ˆìŠ¤: {', '.join(bonuses)}")
                else:
                    print("   ë³´ë„ˆìŠ¤: ì—†ìŒ")
        
        # ì´ ë³´ë„ˆìŠ¤ ìš”ì•½
        print(f"\nğŸ“ˆ ì´ ì¥ë¹„ ë³´ë„ˆìŠ¤:")
        for stat, bonus in total_bonuses.items():
            if bonus > 0:
                stat_name = stat.replace('_', ' ').title()
                print(f"   {stat_name}: +{bonus}")
        
        input("\nê³„ì†í•˜ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”...")
        return self._equip_unequip_items(character)
    
    def _repair_equipment(self, character: Character):
        """ì¥ë¹„ ìˆ˜ë¦¬ ì‹œìŠ¤í…œ"""
        equipped_items = getattr(character, 'equipped_items', {})
        damaged_items = []
        
        for slot, item in equipped_items.items():
            if item and hasattr(item, 'durability') and item.durability < 100:
                damaged_items.append((slot, item))
        
        if not damaged_items:
            print("âŒ ìˆ˜ë¦¬ê°€ í•„ìš”í•œ ì¥ë¹„ê°€ ì—†ìŠµë‹ˆë‹¤.")
            return self._equip_unequip_items(character)
        
        print("\nğŸ”§ ìˆ˜ë¦¬í•  ì¥ë¹„ ì„ íƒ:")
        for i, (slot, item) in enumerate(damaged_items, 1):
            durability = item.durability
            repair_cost = self._calculate_repair_cost(item)
            print(f"{i}. {slot}: {item.name} (ë‚´êµ¬ë„: {durability}%) - ìˆ˜ë¦¬ë¹„: {repair_cost} ê³¨ë“œ")
        
        print(f"{len(damaged_items) + 1}. ëª¨ë“  ì¥ë¹„ ìˆ˜ë¦¬")
        print(f"{len(damaged_items) + 2}. ì·¨ì†Œ")
        
        try:
            choice = int(input("ì„ íƒ: ")) - 1
            if choice == len(damaged_items) + 1:  # ì·¨ì†Œ
                return self._equip_unequip_items(character)
            elif choice == len(damaged_items):  # ëª¨ë“  ì¥ë¹„ ìˆ˜ë¦¬
                total_cost = sum(self._calculate_repair_cost(item) for _, item in damaged_items)
                if self._can_afford_repair(character, total_cost):
                    for _, item in damaged_items:
                        item.durability = 100
                    self._pay_repair_cost(character, total_cost)
                    print(f"âœ… ëª¨ë“  ì¥ë¹„ë¥¼ ìˆ˜ë¦¬í–ˆìŠµë‹ˆë‹¤! (ì´ ë¹„ìš©: {total_cost} ê³¨ë“œ)")
                else:
                    print("âŒ ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.")
            elif 0 <= choice < len(damaged_items):
                slot, selected_item = damaged_items[choice]
                repair_cost = self._calculate_repair_cost(selected_item)
                
                if self._can_afford_repair(character, repair_cost):
                    selected_item.durability = 100
                    self._pay_repair_cost(character, repair_cost)
                    print(f"âœ… {selected_item.name}ì„(ë¥¼) ìˆ˜ë¦¬í–ˆìŠµë‹ˆë‹¤! (ë¹„ìš©: {repair_cost} ê³¨ë“œ)")
                else:
                    print("âŒ ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.")
            else:
                print("âŒ ì˜ëª»ëœ ì„ íƒì…ë‹ˆë‹¤.")
                return self._repair_equipment(character)
            
            return "equipment_repair", {"action": "repair_complete"}
        except ValueError:
            print("âŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            return self._repair_equipment(character)
    
    def _calculate_repair_cost(self, item) -> int:
        """ìˆ˜ë¦¬ ë¹„ìš© ê³„ì‚°"""
        base_cost = 100  # ê¸°ë³¸ ìˆ˜ë¦¬ë¹„
        durability_lost = 100 - getattr(item, 'durability', 100)
        enhancement_multiplier = 1 + (getattr(item, 'enhancement_level', 0) * 0.5)
        
        return int(base_cost * (durability_lost / 100) * enhancement_multiplier)
    
    def _can_afford_repair(self, character: Character, cost: int) -> bool:
        """ìˆ˜ë¦¬ ë¹„ìš© ì§€ë¶ˆ ê°€ëŠ¥ ì—¬ë¶€"""
        gold = getattr(character, 'gold', 0)
        return gold >= cost
    
    def _pay_repair_cost(self, character: Character, cost: int):
        """ìˆ˜ë¦¬ ë¹„ìš© ì§€ë¶ˆ"""
        if hasattr(character, 'gold'):
            character.gold -= cost
        else:
            character.gold = 0
    
    def _enhance_equipment(self, character: Character):
        """ì¥ë¹„ ê°•í™”"""
        print(f"âš¡ {character.name}ì˜ ì¥ë¹„ ê°•í™”")
        print("ğŸ’¡ ì¥ë¹„ ê°•í™” ì‹œìŠ¤í…œì´ ê³§ ì—…ê·¸ë ˆì´ë“œë©ë‹ˆë‹¤!")
        return "equipment_enhance", {"action": "enhance"}
    
    def _check_equipment_status(self, character: Character):
        """ì¥ë¹„ ìƒíƒœ í™•ì¸"""
        print(f"ğŸ“Š {character.name}ì˜ ì¥ë¹„ ìƒíƒœ")
        if hasattr(character, 'equipped_items'):
            for slot, item in character.equipped_items.items():
                if item:
                    durability = getattr(item, 'durability', 100)
                    print(f"  {slot}: {item.name} (ë‚´êµ¬ë„: {durability}%)")
                else:
                    print(f"  {slot}: (ì¥ë¹„ ì—†ìŒ)")
        return "equipment_status", {"action": "check_status"}
    
    def _get_ai_equipment_recommendation(self, character: Character):
        """AI ì¥ë¹„ ì¶”ì²œ"""
        character_class = getattr(character, 'character_class', 'ì „ì‚¬')
        
        recommendations = {
            'ì „ì‚¬': ['ê°•ì²  ê²€', 'ì² ê°‘ ë°©íŒ¨', 'íŒê¸ˆ ê°‘ì˜·'],
            'ì•„í¬ë©”ì´ì§€': ['ë§ˆë²•ì‚¬ ì§€íŒ¡ì´', 'ë§ˆë ¥ ë¡œë¸Œ', 'ì§€í˜œì˜ ë°˜ì§€'],
            'ê¶ìˆ˜': ['ì—˜ë¸ í™œ', 'ê°€ì£½ ê°‘ì˜·', 'ì‹ ì†ì˜ ë¶€ì¸ '],
            'ë„ì ': ['ì•”ì‚´ ë‹¨ê²€', 'ê·¸ë¦¼ì ë§í† ', 'ë¯¼ì²©ì˜ ì¥ê°‘']
        }
        
        class_recommendations = recommendations.get(character_class, ['ê¸°ë³¸ ì¥ë¹„'])
        
        print(f"ğŸ¤– AI ì¶”ì²œ ì¥ë¹„ ({character_class} ì „ìš©):")
        for i, item in enumerate(class_recommendations, 1):
            print(f"  {i}. {item}")
        
        return "ai_recommendation", {"recommendations": class_recommendations}

# ì „ì—­ AI ê²Œì„ëª¨ë“œ ë§¤ë‹ˆì € (ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤)
ai_game_mode_manager = AIGameModeManager()

def initialize_ai_game_mode(party_members: List[Character], controlled_count: int = 1):
    """AI ê²Œì„ëª¨ë“œ ì´ˆê¸°í™”"""
    return ai_game_mode_manager.initialize_ai_mode(party_members, controlled_count)

# ê¸°ë³¸ ê²Œì„ëª¨ë“œìš© ì¥ë¹„ ìë™ ì¥ì°© í•¨ìˆ˜
def auto_equip_for_basic_mode(character: Character, inventory_items: List = None) -> List[str]:
    """ê¸°ë³¸ ê²Œì„ëª¨ë“œì—ì„œ ìºë¦­í„°ì—ê²Œ ìµœì ì˜ ì¥ë¹„ë¥¼ ìë™ìœ¼ë¡œ ì¥ì°© - ê· ë“± ë¶„ë°°"""
    if not inventory_items:
        return []
    
    # íŒŒí‹°ì›ë³„ ì¥ì°© íšŸìˆ˜ë¥¼ ì¶”ì  (ì „ì—­ ë³€ìˆ˜ ì‚¬ìš©)
    if not hasattr(auto_equip_for_basic_mode, 'equipment_distribution'):
        auto_equip_for_basic_mode.equipment_distribution = {}
    
    char_id = f"{character.name}_{getattr(character, 'character_class', 'ì „ì‚¬')}"
    current_count = auto_equip_for_basic_mode.equipment_distribution.get(char_id, 0)
    
    # ì´ë¯¸ 2ê°œ ì´ìƒ ì¥ì°©í•œ ìºë¦­í„°ëŠ” ìŠ¤í‚µ
    if current_count >= 2:
        print(f"ğŸš« {character.name}ëŠ” ì´ë¯¸ {current_count}ê°œ ì¥ì°©í•˜ì—¬ ì¶”ê°€ ì¥ì°©ì„ ìŠ¤í‚µí•©ë‹ˆë‹¤.")
        return []
    
    # ìµœëŒ€ 2ê°œê¹Œì§€ë§Œ ì¥ì°©
    max_items = min(2 - current_count, len(inventory_items))
    result = basic_equipment_manager.auto_equip_best_items(character, inventory_items[:max_items])
    
    # ì¥ì°© íšŸìˆ˜ ì—…ë°ì´íŠ¸
    if result:
        auto_equip_for_basic_mode.equipment_distribution[char_id] = current_count + len(result)
        print(f"ğŸ’ {character.name} ì¥ì°© í˜„í™©: {auto_equip_for_basic_mode.equipment_distribution[char_id]}ê°œ")
    
    return result

def get_equipment_recommendations_for_basic_mode(character: Character, available_items: List) -> List[Dict]:
    """ê¸°ë³¸ ê²Œì„ëª¨ë“œì—ì„œ ìºë¦­í„°ìš© ì¥ë¹„ ì¶”ì²œ"""
    return basic_equipment_manager.get_equipment_recommendations(character, available_items)

def process_character_turn(character: Character, party: List[Character], enemies: List[Character]):
    """ìºë¦­í„° í„´ ì²˜ë¦¬ (AI/í”Œë ˆì´ì–´ ìë™ êµ¬ë¶„)"""
    return ai_game_mode_manager.process_combat_turn(character, party, enemies)
